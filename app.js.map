{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/events/events.js","webpack:///./src/audio/click.mp3","webpack:///./src/audio/launch.mp3","webpack:///./src/audio/place.mp3","webpack:///./src/img/toolset.png","webpack:///./src/img/unloaded.png","webpack:///./src/js sync ^\\.\\/.*$","webpack:///./src/js/Fx.js","webpack:///./src/js/Player.js","webpack:///./src/js/World.js","webpack:///./src/js/canvas_renderer.js","webpack:///./src/js/captcha.js","webpack:///./src/js/conf.js","webpack:///./src/js/context.js","webpack:///./src/js/global.js","webpack:///./src/js/local_player.js","webpack:///./src/js/main.js","webpack:///./src/js/networking.js","webpack:///./src/js/polyfill/canvas-toBlob.js","webpack:///./src/js/protocol/Protocol.js","webpack:///./src/js/protocol/all.js","webpack:///./src/js/protocol/old.js","webpack:///./src/js/protocol/proto_parse.js","webpack:///./src/js/protocol/v0x00.js","webpack:///./src/js/tool_renderer.js","webpack:///./src/js/tools.js","webpack:///./src/js/util/Bucket.js","webpack:///./src/js/util/Lerp.js","webpack:///./src/js/util/anchorme.js","webpack:///./src/js/util/color.js","webpack:///./src/js/util/misc.js","webpack:///./src/js/util/normalizeWheel.js","webpack:///./src/js/windowsys.js"],"names":["PLAYERFX","NONE","RECT_SELECT_ALIGNED","pixelSize","htmlColor","fx","ctx","time","x","extra","player","y","fxx","Math","floor","camera","zoom","fxy","globalAlpha","strokeStyle","htmlRgb","strokeRect","WORLDFX","RECT_FADE_ALIGNED","size","startTime","alpha","delete","s","options","enableIdView","rank","RANK","MODERATOR","tag","str","ts","measureText","width","fillStyle","strokeText","fillText","activeFx","Fx","renderFunc","visible","push","func","Object","defineProperty","get","bool","i","indexOf","splice","PublicAPI","world","class","eventSys","on","e","net","tilesUpdated","made","tiles","length","t","isVisible","color","toHTML","rgb","id","renderer","render","rendertype","FX","chunk","set","chunkX","chunkY","data","wX","protocol","chunkSize","wY","lock","state","local","Player","tool","toString","_x","Lerp","_y","tools","fxType","setVisible","misc","validMousePos","endX","endY","u24_888","clr","playerListEntry","document","createElement","innerHTML","playerList","playerListTable","appendChild","val","setRenderer","fxRenderer","childNodes","removeChild","end","lastPlace","Chunk","netdata","locked","needsRedraw","tmpChunkBuf","view","lockedNeighbors","cb","j","Number","isInteger","fill","fillFromBuf","emit","unload","dir","UP","RIGHT","DOWN","LEFT","World","worldName","name","chunks","protectedChunks","players","undoHistory","pathUpdaterTimeout","pathFx","retval","path","l","lineWidth","setTransform","placeTime","patterns","unloaded","stroke","loadCFunc","chunkLoaded","unloadCFunc","chunkUnloaded","setCFunc","chunkPasted","lockCFunc","newState","chunkLocked","disconnectedFunc","leave","updateTileFunc","updatePlayerFunc","playersMoved","p","destroyPlayerFunc","playersLeft","leaveWFunc","unloadAllChunks","keys","removeListener","load","disconnected","once","d","mainPath","Path2D","vpoints","hpoints","addPoint","fy","tx","ty","points","fkey","tkey","newTo","newFrom","k","ln","polys","pointobjs","a","split","moveTo","prev","next","lineTo","closePath","checkSide","to","from","sidec","getChunkAt","clearTimeout","setTimeout","update","makeLockedChunksPath","key","isConnected","requestChunk","allChunksLoaded","chunksUpdated","c","updateChunk","rendered","u","ids","disconnect","noUndo","Date","now","oldPixel","getPixel","updatePixel","colorUtils","sounds","play","place","bulkUndo","eq","b","changeTime","undo","px","shouldContinue","unchanged","setPixel","tileX","tileY","findNeighborLockedChunks","addChunk","rmChunk","remove","drawText","unloadFarClusters","centerCameraTo","moveCameraBy","moveCameraTo","cameraValues","z","min","zoomLimitMax","max","zoomLimitMin","center","getCenterPixel","rendererValues","updateRequired","animContext","gridShown","gridPattern","unloadedPattern","worldBackground","minGridZoom","updatedClusters","clusters","visibleClusters","currentFontSize","ALL","WORLD","requestRender","showGrid","setGridVisibility","updateCamera","onCameraMove","BufView","u32data","w","h","realw","chunkBugWorkaround","changes","offx","offy","realwidth","height","u32buf","ChunkCluster","removed","toUpdate","shown","canvas","clusterChunkAmount","getContext","createImageData","Uint32Array","buffer","currentColor","arr","current","fillRect","putImageData","visiblecl","centered","cx","cy","czoom","cw","window","innerWidth","ch","innerHeight","camx","camy","camw","camh","ctrx","ctry","dx","abs","dy","dist","unloadDistance","type","needsRender","uClusters","clusterCanvasSize","cwidth","cheight","background","clearRect","scale","cluster","gx","gy","clipx","clipy","clipw","cliph","drawImage","newscale","defaultZoom","oldscale","translate","globalCompositeOperation","fontsize","font","renderPlayer","targetPlayer","cnvs","toolwidth","cursor","toolheight","offset","idstr","textw","enabled","renderGrid","tmpcanvas","round","setLineDash","fadeMult","beginPath","createPattern","setGridZoom","updateVisible","onResize","elements","animCanvas","imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled","oImageSmoothingEnabled","alignCamera","alignedX","alignedY","requestMissingChunks","mx","my","loadChunk","moved","teleported","clusterX","clusterY","delChunk","worldInitialized","init","addEventListener","mkPatternFromUrl","url","patImg","Image","onload","pat","src","unloadedPatternUrl","backgroundUrl","frameLoop","requestAnimationFrame","toolsInitialized","loadAndRequestCaptcha","SITEKEY","loadCaptcha","grecaptcha","callback","bind","loadingCaptcha","requestVerification","windowSys","addWindow","GUIWindow","wdow","addObj","theme","sitekey","captchaToken","token","close","frame","style","cssText","container","localStorage","owopcaptcha","evtId","USER","ADMIN","EVENTS","loaded","tick","toolsRendered","logoMakeRoom","windowAdded","connecting","connected","playerCount","chat","devChat","join","joining","setId","allLoaded","sec","maxCount","events","userOptions","JSON","parse","getItem","console","error","shouldFool","getMonth","getDate","serverAddress","default","title","proto","fallbackFps","maxChatBuffer","tickSpeed","movementSpeed","defaultWorld","enableSounds","zoomStrength","toolSetUrl","toolSet","unloadedPat","noUi","fool","hexCoords","debug","server","createContextMenu","contextMenu","className","removeMenu","event","body","removeEventListener","buttons","button","textContent","offsetHeight","log","top","left","OWOP","WorldOfPixels","EventEmitter","shouldUpdate","getDefaultTool","updateClientFx","toolSelected","palette","paletteIndex","clientFx","isLocalPlayer","mouse","worldX","worldY","setVisibleFunc","insideViewport","validTile","networkRankVerification","somethingChanged","cachedHtmlRgb","updatePalette","selClr","selectedColor","addPaletteColor","selectTool","toolId","currentServer","changedColor","updatePaletteIndex","paletteColors","colorClick","index","colorDelete","element","backgroundColor","onmouseup","sel","del","oncontextmenu","transform","toolName","rankRequired","call","cancelMouseDown","validClick","newRank","ws","send","Uint8Array","paletteInput","onclick","value","onchange","exec","parseInt","paletteCreate","click","revealSecrets","showDevChat","showPlayerList","statusMsg","keysDown","lastX","lastY","mouseDownWorldX","mouseDownWorldY","touches","viewport","xyDisplay","chatInput","_world","lastXYDisplay","devRecvReader","chatPostFormatRecvModifier","msg","chatRecvModifier","chatSendModifier","exceptionTimeout","worldPasswords","urlWorldName","tickInterval","lastMessage","lastCleanup","getNewWorldApi","guiShown","cookiesEnabled","storageEnabled","showEUCookieNag","usingFirefox","navigator","userAgent","sound","currentTime","launch","Audio","launchSoundUrl","placeSoundUrl","clickSoundUrl","playerListWindow","closeable","tableHeader","move","obj","defProp","prop","receiveMessage","text","addContext","elem","nickname","clientX","clientY","muted","stopPropagation","message","realText","isAdmin","startsWith","nick","slice","cuttxt","includes","isNaN","charAt","idIndex","ntext","substr","replace","incCount","span","times","recvTimes","attributes","animation","scrollChatToBottom","chatMessages","childs","children","receiveDevMessage","devChatMessages","scrollTop","scrollHeight","dontScrollIfNotTop","shouldScroll","clientHeight","clearChat","tickNum","speed","offX","offY","updateMouse","eventName","mouseX","mouseY","cancelled","updateXYDisplay","openChat","closeChat","blur","display","delWindow","updatePlayerCount","countStr","final","playerCountDisplay","loadUl","showWorldUI","disabled","paletteBg","visibility","helpButton","showLoadScr","showOptions","loadOptions","loadScr","showSpinner","statusShown","status","spinner","inGameDisconnected","retryingConnect","serverGetter","tryConnect","tryN","maxRetries","ncs","connect","saveWorldPasswords","stringify","checkFunctionality","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","f","n","Infinity","trunc","toBlob","HTMLCanvasElement","prototype","msToBlob","require","chatinput","chatHistory","historyIndex","keyCode","which","shiftKey","preventDefault","unshift","adminlogin","modlogin","pass","ctrlKey","sendMessage","activeElement","tagName","isEventDefined","parseClr","tmp","nrgb","colr","input","prompt","focus","pageX","pageY","realBtn","cancelledButtons","remainingButtons","mousewheel","nevt","pixelY","delta","spinY","pIndex","wheelEventName","passive","touchEventNoUpdate","evtName","changedTouches","soundToggle","checked","hexToggle","netlify","location","href","onhashchange","reload","hash","decodeURIComponent","pathname","defaults","availableServers","serverList","shift","sv","reconnectBtn","setInterval","UtilDialog","count","autoNick","desiredRank","mightBeMod","onWrong","onCorrect","newrank","errmsg","stack","getElementById","logo","windows","clear","onDevMsg","fn","postFormatRecvModifier","recvModifier","sendModifier","poke","lastSentX","connection","WebSocket","binaryType","module","exports","__webpack_public_path__","Protocol","subClass","messageHandler","openHandler","closeHandler","readyState","OPEN","resolveProtocols","definedProtos","OldProtocol","captchaState","CA_WAITING","CA_VERIFYING","CA_VERIFIED","CA_OK","CA_INVALID","netUpdateSpeed","maxWorldNameLength","worldBorder","chatBucket","placeBucket","maxMessageLength","worldVerification","chatVerification","String","fromCharCode","tokenVerification","opCode","client","worldUpdate","chunkLoad","teleport","setRank","captcha","setPQuota","chunkProtected","stoi","string","ints","fstring","toLowerCase","charCode","charCodeAt","OldProtocolImpl","lastSentY","playercount","chunksLoading","waitingForChunks","params","Bucket","interval","clet","joinFunc","allowance","sendUpdates","rankChanged","infinite","maxLength","leaveFunc","clearInterval","dv","DataView","oc","getUint8","getUint32","shouldrender","updated","updates","pid","pmx","getInt32","pmy","pr","pg","pb","ptool","off","getUint16","bid","bpx","bpy","br","bg","bb","bbgr","decreased","dpid","u8data","byteLength","joinWorld","rate","per","nstr","array","ArrayBuffer","setUint8","setUint16","wb","setInt32","distx","disty","sqrt","canSpend","worldx","worldy","lastx","lasty","selrgb","buf","types","u8","isSetter","makeParser","ocList","makeBuilders","protobuf","global","toClient","toServer","itemType","sizeType","cursors","imgpos","hotspot","pipette","erase","brush","select","selectprotect","areadelete","copy","paste","cut","wand","shield","kick","ban","write","reduce","nw","nh","idat","getImageData","u32dat","xoff","yoff","shadow","img","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","popOut","shadowcolor","backgroundcolor","oncomplete","slotcanvas","original","shadowed","shadowblob","blob","URL","createObjectURL","slotset","updateToolWindow","updateToolbar","showToolsWindow","addTool","toolsWindow","windowShown","isSelected","backgroundImage","cursorblob","win","toolButtonClick","mask","backgroundPosition","setposition","Tool","rankNeeded","onInit","mouseup","mousedown","mousemove","touchstart","touchmove","touchend","touchcancel","deselect","keydown","keyup","scroll","apply","defaultTouchHandler","handlers","start","cancel","handler","addToolObject","allTools","setEvent","usedButtons","pixel","startX","startY","rawEvent","spinX","pxAmount","fillChunk","empty","firstLoop","clearChunk","lzoom","nzoom","maxTouches","setFxRenderer","oldlinew","rect","sin","oldfont","txt","clicking","txtx","txty","dlarea","onblob","pix","isInside","finish","cvs","centerOnce","props","reverse","r","shownSize","classList","add","image","tickAmount","queue","fillingColor","defaultFx","check","painted","pop","thisClr","bottom","right","line","x1","y1","x2","y2","plot","sx","sy","err","e2","pc","protectChunk","rw","rh","isSure","timeout","sure","rx","ry","isChunkSolid","lastClr","forEach","sendQueue","q","cs","paint","tmpBuffer","dat","totalChunksW","ceil","totalChunksH","getModifiedPixel","imgY","imgX","currentPixel","g","getModifiedChunk","modified","Error","setChunk","tw","newChunk","nbuf","accept","files","reader","FileReader","target","result","readAsDataURL","oldSelect","lastCheck","getTime","ms","amt","v","define","ips","emails","urls","truncate","defaultProtocol","list","defaultOptions","isPort","tlds","htmlAttrs","match","o","test","fixSeparators","separate","deSeparate","map","encodeURI","reason","raw","encoded","exclude","substring","validate","ip","email","__esModule","to888","R","G","B","to565","u16_565","u32_888","u16_565_to_888","arrFrom565","setCookie","getCookie","propertyDefaults","absMod","htmlToElement","escapeHTML","mkHTML","loadScript","eventOnce","setTooltip","waitFrames","decompress","util","cookie","idx","cookieEnabled","hasOwnProperty","n1","n2","html","content","firstChild","opts","elm","getElementsByTagName","ev","elementSpacing","intr","tip","tooltip","epos","getBoundingClientRect","tpos","mleave","menter","u8arr","originalLength","u8decompressedarr","numOfRepeats","uptr","cptr","currentRepeatLoc","repeatedNum","repeatedColorR","repeatedColorG","repeatedColorB","normalizeWheel","PIXEL_STEP","LINE_HEIGHT","PAGE_HEIGHT","sX","sY","pX","pY","detail","wheelDelta","wheelDeltaY","wheelDeltaX","axis","HORIZONTAL_AXIS","deltaY","deltaX","deltaMode","pixelX","UtilInput","OWOPDropDown","centerWindow","dialog","dropDown","closeAllWindows","inputType","inputField","placeholder","onkeyup","okButton","getWindow","resize","canClose","messageBox","immobile","hlpdiv","hidebtn","hlpcontainer","initfunc","wm","windowsys","opt","titlespan","offsetWidth","creationtime","currentaction","mdownfunc","mupfunc","mmovefunc","touchfuncbuilder","object","delObj","onclose","realWindow","realh"],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,cAAc;AACd;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA,iCAAiC,QAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA,sCAAsC,QAAQ;AAC9C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;;AAEA;AACA,QAAQ,yBAAyB;AACjC;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;;;;;;;;;;;;AC/bA,iBAAiB,qBAAuB,qB;;;;;;;;;;;ACAxC,iBAAiB,qBAAuB,sB;;;;;;;;;;;ACAxC,iBAAiB,qBAAuB,qB;;;;;;;;;;;ACAxC,iBAAiB,qBAAuB,qB;;;;;;;;;;;ACAxC,iBAAiB,qBAAuB,sB;;;;;;;;;;;ACAxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yD;;;;;;;;;;;;ACzEa;;;;;;;;;AACb;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEO,IAAMA,8BAAW;AACvBC,OAAM,IADiB;AAEvBC,sBAAqB,6BAACC,SAAD,EAAYC,SAAZ;AAAA,SAA0B,UAACC,EAAD,EAAKC,GAAL,EAAUC,IAAV,EAAmB;AACjE,OAAIC,IAAIH,GAAGI,KAAH,CAASC,MAAT,CAAgBF,CAAxB;AACA,OAAIG,IAAIN,GAAGI,KAAH,CAASC,MAAT,CAAgBC,CAAxB;AACA,OAAIC,MAAM,CAACC,KAAKC,KAAL,CAAWN,KAAK,KAAKL,SAAV,CAAX,IAAmCA,SAAnC,GAA+CY,wBAAOP,CAAvD,IAA4DO,wBAAOC,IA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","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/js/main.js\");\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = $getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  var args = [];\n  for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    ReflectApply(this.listener, this.target, args);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","module.exports = __webpack_public_path__ + \"audio/click.mp3\";","module.exports = __webpack_public_path__ + \"audio/launch.mp3\";","module.exports = __webpack_public_path__ + \"audio/place.mp3\";","module.exports = __webpack_public_path__ + \"img/toolset.png\";","module.exports = __webpack_public_path__ + \"img/unloaded.png\";","var map = {\n\t\"./Fx\": \"./src/js/Fx.js\",\n\t\"./Fx.js\": \"./src/js/Fx.js\",\n\t\"./Player\": \"./src/js/Player.js\",\n\t\"./Player.js\": \"./src/js/Player.js\",\n\t\"./World\": \"./src/js/World.js\",\n\t\"./World.js\": \"./src/js/World.js\",\n\t\"./canvas_renderer\": \"./src/js/canvas_renderer.js\",\n\t\"./canvas_renderer.js\": \"./src/js/canvas_renderer.js\",\n\t\"./captcha\": \"./src/js/captcha.js\",\n\t\"./captcha.js\": \"./src/js/captcha.js\",\n\t\"./conf\": \"./src/js/conf.js\",\n\t\"./conf.js\": \"./src/js/conf.js\",\n\t\"./context\": \"./src/js/context.js\",\n\t\"./context.js\": \"./src/js/context.js\",\n\t\"./global\": \"./src/js/global.js\",\n\t\"./global.js\": \"./src/js/global.js\",\n\t\"./local_player\": \"./src/js/local_player.js\",\n\t\"./local_player.js\": \"./src/js/local_player.js\",\n\t\"./main\": \"./src/js/main.js\",\n\t\"./main.js\": \"./src/js/main.js\",\n\t\"./networking\": \"./src/js/networking.js\",\n\t\"./networking.js\": \"./src/js/networking.js\",\n\t\"./polyfill/canvas-toBlob\": \"./src/js/polyfill/canvas-toBlob.js\",\n\t\"./polyfill/canvas-toBlob.js\": \"./src/js/polyfill/canvas-toBlob.js\",\n\t\"./protocol/Protocol\": \"./src/js/protocol/Protocol.js\",\n\t\"./protocol/Protocol.js\": \"./src/js/protocol/Protocol.js\",\n\t\"./protocol/all\": \"./src/js/protocol/all.js\",\n\t\"./protocol/all.js\": \"./src/js/protocol/all.js\",\n\t\"./protocol/old\": \"./src/js/protocol/old.js\",\n\t\"./protocol/old.js\": \"./src/js/protocol/old.js\",\n\t\"./protocol/proto_parse\": \"./src/js/protocol/proto_parse.js\",\n\t\"./protocol/proto_parse.js\": \"./src/js/protocol/proto_parse.js\",\n\t\"./protocol/v0x00\": \"./src/js/protocol/v0x00.js\",\n\t\"./protocol/v0x00.js\": \"./src/js/protocol/v0x00.js\",\n\t\"./tool_renderer\": \"./src/js/tool_renderer.js\",\n\t\"./tool_renderer.js\": \"./src/js/tool_renderer.js\",\n\t\"./tools\": \"./src/js/tools.js\",\n\t\"./tools.js\": \"./src/js/tools.js\",\n\t\"./util/Bucket\": \"./src/js/util/Bucket.js\",\n\t\"./util/Bucket.js\": \"./src/js/util/Bucket.js\",\n\t\"./util/Lerp\": \"./src/js/util/Lerp.js\",\n\t\"./util/Lerp.js\": \"./src/js/util/Lerp.js\",\n\t\"./util/anchorme\": \"./src/js/util/anchorme.js\",\n\t\"./util/anchorme.js\": \"./src/js/util/anchorme.js\",\n\t\"./util/color\": \"./src/js/util/color.js\",\n\t\"./util/color.js\": \"./src/js/util/color.js\",\n\t\"./util/misc\": \"./src/js/util/misc.js\",\n\t\"./util/misc.js\": \"./src/js/util/misc.js\",\n\t\"./util/normalizeWheel\": \"./src/js/util/normalizeWheel.js\",\n\t\"./util/normalizeWheel.js\": \"./src/js/util/normalizeWheel.js\",\n\t\"./windowsys\": \"./src/js/windowsys.js\",\n\t\"./windowsys.js\": \"./src/js/windowsys.js\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./src/js sync recursive ^\\\\.\\\\/.*$\";","\"use strict\";\r\nimport { colorUtils as color } from './util/color.js';\r\nimport { EVENTS as e, protocol, RANK, options } from './conf.js';\r\nimport { getTime } from './util/misc.js';\r\nimport { eventSys, PublicAPI } from './global.js';\r\nimport { camera, renderer, ghosts, Ghost } from './canvas_renderer.js';\r\nimport { player } from './local_player.js';\r\nimport { misc } from './main.js';\r\n\r\nexport const PLAYERFX = {\r\n\tNONE: null,\r\n\tRECT_SELECT_ALIGNED: (pixelSize, htmlColor) => (fx, ctx, time) => {\r\n\t\tvar x = fx.extra.player.x;\r\n\t\tvar y = fx.extra.player.y;\r\n\t\tvar fxx = (Math.floor(x / (16 * pixelSize)) * pixelSize - camera.x) * camera.zoom;\r\n\t\tvar fxy = (Math.floor(y / (16 * pixelSize)) * pixelSize - camera.y) * camera.zoom;\r\n\t\tctx.globalAlpha = 0.8;\r\n\t\tctx.strokeStyle = htmlColor || fx.extra.player.htmlRgb;\r\n\t\tctx.strokeRect(fxx, fxy, camera.zoom * pixelSize, camera.zoom * pixelSize);\r\n\t\treturn 1; /* Rendering finished (won't change on next frame) */\r\n\t}\r\n};\r\n\r\nexport const WORLDFX = {\r\n\tNONE: null,\r\n\tRECT_FADE_ALIGNED: (size, x, y, startTime = getTime()) => (fx, ctx, time) => {\r\n\t\tvar alpha = 1 - (time - startTime) / 1000;\r\n\t\tif (alpha <= 0) {\r\n\t\t\tfx.delete();\r\n\t\t\treturn 2; /* 2 = An FX object was deleted */\r\n\t\t}\r\n\t\tvar fxx = (x * size - camera.x) * camera.zoom;\r\n\t\tvar fxy = (y * size - camera.y) * camera.zoom;\r\n\t\tvar s = camera.zoom * size;\r\n\t\tctx.globalAlpha = alpha;\r\n\t\tctx.strokeStyle = fx.extra.htmlRgb || \"#000000\";\r\n\t\tctx.strokeRect(fxx, fxy, s, s);\r\n\t\tif (options.enableIdView && player.rank >= RANK.MODERATOR && camera.zoom >= 8 && fx.extra.tag) {\r\n\t\t\tfxx += s;\r\n\t\t\tvar str = fx.extra.tag;\r\n\t\t\tvar ts = ctx.measureText(str).width;\r\n\t\t\tctx.fillStyle = \"#FFFFFF\";\r\n\t\t\tctx.strokeStyle = \"#000000\";\r\n\t\t\tctx.strokeText(str, fxx, fxy);\r\n\t\t\tctx.fillText(str, fxx, fxy);\r\n\t\t}\r\n\r\n\t\treturn 0; /* 0 = Animation not finished */\r\n\t}\r\n};\r\n\r\nexport const activeFx = [];\r\n\r\n/*PublicAPI.activeFx = activeFx;*/\r\n\r\nexport class Fx {\r\n    constructor(renderFunc, extra) {\r\n\t\tthis.visible = true;\r\n\t\tthis.renderFunc = renderFunc;\r\n\t\tthis.extra = extra || {};\r\n\t\tactiveFx.push(this);\r\n\t}\r\n\r\n\trender(ctx, time) {\r\n\t\tif (this.renderFunc && this.visible) {\r\n\t\t\treturn this.renderFunc(this, ctx, time);\r\n\t\t}\r\n\t\treturn 1;\r\n\t}\r\n\r\n\tsetVisibleFunc(func) {\r\n\t\tObject.defineProperty(this, 'visible', {\r\n\t\t\tget: func\r\n\t\t});\r\n\t}\r\n\r\n\tsetVisible(bool) {\r\n\t\tthis.visible = bool;\r\n\t}\r\n\r\n\tsetRenderer(func) {\r\n\t\tthis.renderFunc = func;\r\n\t}\r\n\r\n\tupdate(extra) {\r\n\t\tthis.extra = extra;\r\n\t}\r\n\r\n\tdelete() {\r\n\t\tvar i = activeFx.indexOf(this);\r\n\t\tif(i !== -1) {\r\n\t\t\tactiveFx.splice(i, 1);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nPublicAPI.fx = {\r\n\tworld: WORLDFX,\r\n\tplayer: PLAYERFX,\r\n\tclass: Fx\r\n};\r\n\r\neventSys.on(e.net.world.tilesUpdated, tiles => {\r\n\tlet time = getTime(true);\r\n\tlet made = false;\r\n\r\n\tfor (var i = 0; i < tiles.length; i++) {\r\n\t\tvar t = tiles[i];\r\n\r\n\t\tif (camera.isVisible(t.x, t.y, 1, 1)) {\r\n\t\t\tnew Fx(WORLDFX.RECT_FADE_ALIGNED(1, t.x, t.y), { htmlRgb: color.toHTML(t.rgb ^ 0xFFFFFF) , tag: '' + t.id});\r\n\t\t\tmade = true;\r\n\t\t}\r\n\t}\r\n\tif (made) {\r\n\t\trenderer.render(renderer.rendertype.FX);\r\n\t}\r\n});\r\n\r\neventSys.on(e.net.chunk.set, (chunkX, chunkY, data) => {\r\n\tvar wX = chunkX * protocol.chunkSize;\r\n\tvar wY = chunkY * protocol.chunkSize;\r\n\tif (camera.isVisible(wX, wY, protocol.chunkSize, protocol.chunkSize)) {\r\n\t\tnew Fx(WORLDFX.RECT_FADE_ALIGNED(16, chunkX, chunkY));\r\n\t\trenderer.render(renderer.rendertype.FX);\r\n\t}\r\n});\r\n\r\neventSys.on(e.net.chunk.lock, (chunkX, chunkY, state, local) => {\r\n\tvar wX = chunkX * protocol.chunkSize;\r\n\tvar wY = chunkY * protocol.chunkSize;\r\n\tif (!local && camera.isVisible(wX, wY, protocol.chunkSize, protocol.chunkSize)) {\r\n\t\tnew Fx(WORLDFX.RECT_FADE_ALIGNED(16, chunkX, chunkY), {\r\n\t\t\thtmlRgb: state ? \"#00FF00\" : \"#FF0000\"\r\n\t\t});\r\n\t\trenderer.render(renderer.rendertype.FX);\r\n\t}\r\n});","'use strict';\nimport { Lerp } from './util/Lerp.js';\nimport { colorUtils as color } from './util/color.js';\nimport { misc, playerList, playerListTable } from './main.js';\nimport { Fx, PLAYERFX } from './Fx.js';\nimport { tools } from './tools.js';\n\nexport class Player {\n    constructor(x, y, rgb, tool, id) {\n        this.id = id.toString(); /* Prevents calling .toString every frame */\n        this._x = new Lerp(x, x, 65);\n        this._y = new Lerp(y, y, 65);\n\n        this.tool = tools[tool] || tools['cursor'];\n        this.fx = new Fx(tool ? tool.fxType : PLAYERFX.NONE, { player: this });\n        this.fx.setVisible(misc.world.validMousePos(\n            Math.floor(this.endX / 16), Math.floor(this.endY / 16)));\n\n        this.rgb = rgb;\n        this.htmlRgb = color.toHTML(color.u24_888(rgb[0], rgb[1], rgb[2]));\n\n        this.clr = (((id + 75387) * 67283 + 53143) % 256) << 16\n                 | (((id + 9283)  * 4673  + 7483)  % 256) << 8\n                 | (  id * 3000                    % 256);\n        this.clr = color.toHTML(this.clr);\n\n\t\tvar playerListEntry = document.createElement(\"tr\");\n\t\tplayerListEntry.innerHTML = \"<td>\" + this.id + \"</td><td>\" + Math.floor(x / 16) + \"</td><td>\" + Math.floor(y / 16) + \"</td>\";\n\t\tplayerList[this.id] = playerListEntry;\n\t\tplayerListTable.appendChild(playerListEntry);\n\t}\n\t\n\tget tileX() {\n\t\treturn Math.floor(this.x / 16);\n\t}\n\n\tget tileY() {\n\t\treturn Math.floor(this.y / 16);\n\t}\n\n    get endX() {\n        return this._x.end;\n    }\n\n    get endY() {\n        return this._y.end;\n    }\n\n    get x() {\n        return this._x.val;\n    }\n\n    get y() {\n        return this._y.val;\n    }\n\n    update(x, y, rgb, tool) {\n        this._x.val = x;\n        this._y.val = y;\n        /* TODO: fix weird bug (caused by connecting before tools initialized?) */\n        //console.log(tool)\n        this.tool = tools[tool] || tools['cursor'];\n        this.fx.setRenderer((this.tool || {}).fxRenderer ); // temp until fix: || {}\n        this.fx.setVisible(misc.world.validMousePos(\n            Math.floor(this.endX / 16), Math.floor(this.endY / 16)));\n        this.rgb = rgb;\n        this.htmlRgb = color.toHTML(color.u24_888(rgb[0], rgb[1], rgb[2]));\n\n\t\tplayerList[this.id].childNodes[1].innerHTML = Math.floor(x / 16);\n\t\tplayerList[this.id].childNodes[2].innerHTML = Math.floor(y / 16);\n    }\n\n    disconnect() {\n        this.fx.delete();\n\n\t\tplayerListTable.removeChild(playerList[this.id]);\n\t\tdelete playerList[this.id];\n    }\n}\n","\"use strict\";\nimport { protocol, EVENTS as e, options, RANK } from './conf.js';\nimport { eventSys } from './global.js';\nimport { colorUtils } from './util/color.js';\nimport { net } from './networking.js';\nimport { camera, isVisible, renderer } from './canvas_renderer.js';\nimport { mouse, sounds } from './main.js';\nimport { player } from './local_player.js';\nimport { Player } from './Player.js';\nimport { Fx } from './Fx.js';\n\nlet lastPlace = 0;\n\nexport class Chunk {\n\tconstructor(x, y, netdata, locked) { /* netdata = Uint32Array */\n\t\tthis.needsRedraw = false;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.tmpChunkBuf = netdata;\n\t\tthis.view = null;\n\t\tthis.locked = locked;\n\t\tthis.lockedNeighbors = 0b0000; /* Up, Right, Down, Left */\n\t}\n\n\tupdate(x, y, color) {\n\t\t/* WARNING: Should absMod if not power of two */\n\t\tx &= (protocol.chunkSize - 1);\n\t\ty &= (protocol.chunkSize - 1);\n\t\tthis.view.set(x, y, 0xFF000000 | color);\n\t\tthis.needsRedraw = true;\n\t}\n\n\tforEach(cb) {\n\t\tvar s = protocol.chunkSize;\n\t\tfor (var i = 0; i < s; i++) {\n\t\t\tfor (var j = 0; j < s; j++) {\n\t\t\t\tif (!cb(j, i, this.get(j, i))) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tget(x, y) {\n\t\tx &= (protocol.chunkSize - 1);\n\t\ty &= (protocol.chunkSize - 1);\n\t\treturn this.view.get(x, y);\n\t}\n\n\tset(data) {\n\t\tif (Number.isInteger(data)) {\n\t\t\tthis.view.fill(0xFF000000 | data);\n\t\t} else {\n\t\t\tthis.view.fillFromBuf(data);\n\t\t}\n\t\tthis.needsRedraw = true;\n\t}\n\n\tremove() { /* Can be called when manually unloading too */\n\t\teventSys.emit(e.net.chunk.unload, this);\n\t}\n}\nChunk.dir = {\n\tUP: 0b1000,\n\tRIGHT: 0b0100,\n\tDOWN: 0b0010,\n\tLEFT: 0b0001\n};\n\nexport class World {\n\tconstructor(worldName) {\n\t\tthis.name = worldName;\n\t\tthis.chunks = {};\n\t\tthis.protectedChunks = {};\n\t\tthis.players = {};\n\t\tthis.undoHistory = [];\n\t\tthis.pathUpdaterTimeout = -1;\n\t\tthis.pathFx = new Fx((fx, ctx, time) => {\n\t\t\tvar retval = 1;\n\t\t\tif (fx.extra.path) {\n\t\t\t\tctx.strokeStyle = \"#525252\";\n\t\t\t\tvar l = ctx.lineWidth;\n\t\t\t\tctx.lineWidth = 3 / camera.zoom;\n\t\t\t\tctx.setTransform(camera.zoom, 0, 0, camera.zoom, -camera.x * camera.zoom, -camera.y * camera.zoom);\n\t\t\t\tif (time - fx.extra.placeTime < 1500) {\n\t\t\t\t\tctx.globalAlpha = (1 - (time - fx.extra.placeTime) / 1500) * 0.5;\n\t\t\t\t\tctx.fillStyle = renderer.patterns.unloaded;\n\t\t\t\t\tctx.fill(fx.extra.path);\n\t\t\t\t\tretval = 0;\n\t\t\t\t}\n\t\t\t\tctx.globalAlpha = 0.75;\n\t\t\t\tctx.stroke(fx.extra.path);\n\t\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\t\t\t\tctx.lineWidth = l;\n\t\t\t}\n\t\t\treturn retval;\n\t\t});\n\n\t\tconst loadCFunc = chunk => this.chunkLoaded(chunk);\n\t\tconst unloadCFunc = chunk => this.chunkUnloaded(chunk);\n\t\tconst setCFunc = (x, y, data) => this.chunkPasted(x, y, data);\n\t\tconst lockCFunc = (x, y, newState) => this.chunkLocked(x, y, newState);\n\t\tconst disconnectedFunc = () => eventSys.emit(e.net.world.leave);\n\t\tconst updateTileFunc = t => this.tilesUpdated(t);\n\t\tconst updatePlayerFunc = p => this.playersMoved(p);\n\t\tconst destroyPlayerFunc = p => this.playersLeft(p);\n\t\tconst leaveWFunc = () => {\n\t\t\tthis.pathFx.delete();\n\t\t\tthis.unloadAllChunks();\n\t\t\tthis.playersLeft(Object.keys(this.players));\n\t\t\teventSys.removeListener(e.net.chunk.load, loadCFunc);\n\t\t\teventSys.removeListener(e.net.chunk.unload, unloadCFunc);\n\t\t\teventSys.removeListener(e.net.chunk.set, setCFunc);\n\t\t\teventSys.removeListener(e.net.chunk.lock, lockCFunc);\n\t\t\teventSys.removeListener(e.net.disconnected, disconnectedFunc);\n\t\t\teventSys.removeListener(e.net.world.tilesUpdated, updateTileFunc);\n\t\t\teventSys.removeListener(e.net.world.playersMoved, updatePlayerFunc);\n\t\t\teventSys.removeListener(e.net.world.playersLeft, destroyPlayerFunc);\n\t\t};\n\t\teventSys.on(e.net.chunk.load, loadCFunc);\n\t\teventSys.on(e.net.chunk.unload, unloadCFunc);\n\t\teventSys.on(e.net.chunk.set, setCFunc);\n\t\teventSys.on(e.net.chunk.lock, lockCFunc);\n\t\teventSys.on(e.net.world.tilesUpdated, updateTileFunc);\n\t\teventSys.on(e.net.world.playersMoved, updatePlayerFunc);\n\t\teventSys.on(e.net.world.playersLeft, destroyPlayerFunc);\n\t\teventSys.once(e.net.world.leave, leaveWFunc);\n\t\teventSys.once(e.net.disconnected, disconnectedFunc);\n\t}\n\t\n\tmakeLockedChunksPath() {\n\t\tconst d = Chunk.dir;\n\t\tvar mainPath = new Path2D();\n\t\t\n\t\tvar vpoints = {};\n\t\tvar hpoints = {};\n\t\t\n\t\tconst addPoint = (fx, fy, tx, ty, points) => {\n\t\t\tconst fkey = `${fx},${fy}`;\n\t\t\tconst tkey = `${tx},${ty}`;\n\t\t\tif (tkey in points && fkey in points) {\n\t\t\t\tpoints[points[fkey]] = points[tkey];\n\t\t\t\tpoints[points[tkey]] = points[fkey];\n\t\t\t\tdelete points[tkey];\n\t\t\t\tdelete points[fkey];\n\t\t\t} else if (tkey in points) {\n\t\t\t\tvar newTo = points[tkey];\n\t\t\t\tpoints[newTo] = fkey;\n\t\t\t\tdelete points[tkey];\n\t\t\t\tpoints[fkey] = newTo;\n\t\t\t} else if (fkey in points) {\n\t\t\t\tvar newFrom = points[fkey];\n\t\t\t\tpoints[newFrom] = tkey;\n\t\t\t\tdelete points[fkey];\n\t\t\t\tpoints[tkey] = newFrom;\n\t\t\t} else {\n\t\t\t\tpoints[fkey] = tkey;\n\t\t\t\tpoints[tkey] = fkey;\n\t\t\t}\n\t\t};\n\n\t\tfor (var k in this.protectedChunks) {\n\t\t\tconst chunk = this.protectedChunks[k];\n\t\t\tconst ln = chunk.lockedNeighbors;\n\t\t\tif (ln === (d.LEFT | d.DOWN | d.UP | d.RIGHT)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tif (!(ln & d.UP)) {\n\t\t\t\taddPoint(chunk.x + 1, chunk.y, chunk.x, chunk.y, hpoints);\n\t\t\t}\n\t\t\tif (!(ln & d.DOWN)) {\n\t\t\t\taddPoint(chunk.x, chunk.y + 1, chunk.x + 1, chunk.y + 1, hpoints);\n\t\t\t}\n\n\t\t\tif (!(ln & d.LEFT)) {\n\t\t\t\taddPoint(chunk.x, chunk.y + 1, chunk.x, chunk.y, vpoints);\n\t\t\t}\n\t\t\tif (!(ln & d.RIGHT)) {\n\t\t\t\taddPoint(chunk.x + 1, chunk.y + 1, chunk.x + 1, chunk.y, vpoints);\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar polys = 0;\n\t\tvar pointobjs = [vpoints, hpoints];\n\t\tfor (var p in vpoints) {\n\t\t\tvar a = p.split(',');\n\t\t\tmainPath.moveTo(a[0] * 16, a[1] * 16);\n\t\t\t\n\t\t\tdelete vpoints[vpoints[p]];\n\t\t\tdelete vpoints[p];\n\t\t\tp = hpoints[p];\n\t\t\tfor (var i = 0; p && (a = p.split(',')); i++) {\n\t\t\t\tvar prev = pointobjs[(i + 1) & 1];\n\t\t\t\tvar next = pointobjs[i & 1];\n\t\t\t\tmainPath.lineTo(a[0] * 16, a[1] * 16);\n\t\t\t\t\n\t\t\t\tdelete prev[prev[p]];\n\t\t\t\tdelete prev[p];\n\t\t\t\tp = next[p];\n\t\t\t}\n\t\t\tmainPath.closePath();\n\t\t\t++polys;\n\t\t}\n\n\t\treturn polys === 0 ? null : mainPath;\n\t}\n\t\n\tfindNeighborLockedChunks(chunk, newState) {\n\t\tconst d = Chunk.dir;\n\t\tconst checkSide = (x, y, to, from) => {\n\t\t\tvar sidec = this.getChunkAt(chunk.x + x, chunk.y + y);\n\t\t\tif (sidec && sidec.locked) {\n\t\t\t\tif (newState) {\n\t\t\t\t\tchunk.lockedNeighbors |= to;\n\t\t\t\t\tsidec.lockedNeighbors |= from;\n\t\t\t\t} else {\n\t\t\t\t\tchunk.lockedNeighbors &= ~to;\n\t\t\t\t\tsidec.lockedNeighbors &= ~from;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\tcheckSide(0, -1, d.UP, d.DOWN);\n\t\tcheckSide(1, 0, d.RIGHT, d.LEFT);\n\t\tcheckSide(-1, 0, d.LEFT, d.RIGHT);\n\t\tcheckSide(0, 1, d.DOWN, d.UP);\n\t\t\n\t\tclearTimeout(this.pathUpdaterTimeout);\n\t\tthis.pathUpdaterTimeout = setTimeout(() => {\n\t\t\tthis.pathFx.update({path: this.makeLockedChunksPath()});\n\t\t\trenderer.render(renderer.rendertype.FX);\n\t\t}, 100);\n\t}\n\n\tloadChunk(x, y) {\n\t\tvar key = `${x},${y}`;\n\t\tif (!this.chunks[key] && net.isConnected()) {\n\t\t\tnet.protocol.requestChunk(x, y);\n\t\t}\n\t}\n\n\tallChunksLoaded() {\n\t\treturn net.protocol.allChunksLoaded();\n\t}\n\n\ttilesUpdated(tiles) {\n\t\tvar chunksUpdated = {};\n\t\tvar chunkSize = protocol.chunkSize;\n\t\tfor (var i = 0; i < tiles.length; i++) {\n\t\t\tvar t = tiles[i];\n\t\t\tvar key = `${Math.floor(t.x / chunkSize)},${Math.floor(t.y / chunkSize)}`;\n\t\t\tvar chunk = this.chunks[key];\n\t\t\tif (chunk) {\n\t\t\t\tchunksUpdated[key] = chunk;\n\t\t\t\tchunk.update(t.x, t.y, t.rgb);\n\t\t\t}\n\t\t}\n\t\tfor (var c in chunksUpdated) {\n\t\t\teventSys.emit(e.renderer.updateChunk, chunksUpdated[c]);\n\t\t}\n\t}\n\n\tplayersMoved(players) {\n\t\tvar rendered = false;\n\t\tfor (const id in players) {\n\t\t\tvar player = this.players[id];\n\t\t\tvar u = players[id];\n\t\t\tif (player) {\n\t\t\t\tplayer.update(u.x, u.y, u.rgb, u.tool);\n\t\t\t} else {\n\t\t\t\tplayer = this.players[id] = new Player(u.x, u.y, u.rgb, u.tool, id);\n\t\t\t}\n\t\t\tif (!rendered && (isVisible(player.endX / 16, player.endY / 16, 4, 4)\n\t\t\t\t\t|| isVisible(player.x / 16, player.y / 16, 4, 4))) {\n\t\t\t\trendered = true;\n\t\t\t\trenderer.render(renderer.rendertype.FX);\n\t\t\t}\n\t\t}\n\t}\n\n\tplayersLeft(ids) {\n\t\tvar rendered = false;\n\t\tfor (var i = 0; i < ids.length; i++) {\n\t\t\tvar id = ids[i];\n\t\t\tvar player = this.players[id];\n\t\t\tif (player) {\n\t\t\t\tplayer.disconnect();\n\t\t\t\tif (!rendered && isVisible(player.x / 16, player.y / 16, 4, 4)) {\n\t\t\t\t\trendered = true;\n\t\t\t\t\trenderer.render(renderer.rendertype.FX);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdelete this.players[id];\n\t\t}\n\t}\n\n\tsetPixel(x, y, color, noUndo) {\n\t\tvar time = Date.now();\n\t\tvar chunkSize = protocol.chunkSize;\n\t\tvar chunk = this.chunks[`${Math.floor(x / chunkSize)},${Math.floor(y / chunkSize)}`];\n\t\tif (chunk && (!chunk.locked || player.rank >= RANK.MODERATOR)) {\n\t\t\tvar oldPixel = this.getPixel(x, y, chunk);\n\t\t\tif (!oldPixel || (oldPixel[0] === color[0] && oldPixel[1] === color[1] && oldPixel[2] === color[2])\n\t\t\t|| !net.protocol.updatePixel(x, y, color)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!noUndo) {\n\t\t\t\toldPixel.push(x, y, time);\n\t\t\t\tthis.undoHistory.push(oldPixel);\n\t\t\t}\n\t\t\tchunk.update(x, y, colorUtils.u24_888(color[0], color[1], color[2]));\n\t\t\teventSys.emit(e.renderer.updateChunk, chunk);\n\t\t\tif (time - lastPlace > 30) {\n\t\t\t\tsounds.play(sounds.place);\n\t\t\t\tlastPlace = time;\n\t\t\t}\n\t\t\treturn true;\n\t\t} else if (chunk && chunk.locked) {\n\t\t\tthis.pathFx.extra.placeTime = time;\n\t\t\trenderer.render(renderer.rendertype.FX);\n\t\t}\n\t\treturn false;\n\t}\n\n\tundo(bulkUndo) {\n\t\tconst eq = (a, b) => a[0] == b[0] && a[1] == b[1] && a[2] == b[2];\n\t\tif (this.undoHistory.length === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tvar changeTime = null;\n\t\tfor (var i = this.undoHistory.length; --i >= 0;) {\n\t\t\tvar undo = this.undoHistory[i];\n\t\t\tif (!changeTime) {\n\t\t\t\tchangeTime = undo[5];\n\t\t\t}\n\t\t\tvar px = this.getPixel(undo[3], undo[4]);\n\t\t\tif (px) {\n\t\t\t\tvar shouldContinue = !bulkUndo || changeTime - undo[5] < 500;\n\t\t\t\tvar unchanged = eq(px, undo);\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (unchanged || this.setPixel(undo[3], undo[4], undo, true)) {\n\t\t\t\t\tthis.undoHistory.splice(i, 1);\n\t\t\t\t\tif (!bulkUndo) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetChunkAt(x, y) {\n\t\treturn this.chunks[`${x},${y}`];\n\t}\n\n\tgetPixel(x, y, chunk) {\n\t\tif (!chunk) {\n\t\t\tvar chunkSize = protocol.chunkSize;\n\t\t\tchunk = this.chunks[`${Math.floor(x / chunkSize)},${Math.floor(y / chunkSize)}`];\n\t\t}\n\n\t\tif (chunk) {\n\t\t\tvar clr = chunk.get(x, y);\n\t\t\treturn [clr & 0xFF, clr >> 8 & 0xFF, clr >> 16 & 0xFF];\n\t\t}\n\t\treturn null;\n\t}\n\n\tvalidMousePos(tileX, tileY) {\n\t\treturn this.getPixel(tileX, tileY) !== null;\n\t}\n\n\tchunkLocked(x, y, newState) {\n\t\tconst key = `${x},${y}`;\n\t\tvar chunk = this.getChunkAt(x, y);\n\t\tif (chunk) {\n\t\t\tif (newState) {\n\t\t\t\tthis.protectedChunks[key] = chunk;\n\t\t\t\tchunk.locked = true;\n\t\t\t} else {\n\t\t\t\tdelete this.protectedChunks[key];\n\t\t\t\tchunk.locked = false;\n\t\t\t}\n\t\t\tthis.findNeighborLockedChunks(chunk, newState);\n\t\t}\n\t}\n\n\tchunkLoaded(chunk) {\n\t\tconst key = `${chunk.x},${chunk.y}`;\n\t\tthis.chunks[key] = chunk;\n\t\tif (chunk.locked) {\n\t\t\tthis.protectedChunks[key] = chunk;\n\t\t\tthis.findNeighborLockedChunks(chunk, chunk.locked);\n\t\t}\n\t\teventSys.emit(e.renderer.addChunk, chunk);\n\t}\n\n\tchunkUnloaded(chunk) {\n\t\tconst key = `${chunk.x},${chunk.y}`;\n\t\tdelete this.chunks[key];\n\t\tif (chunk.locked) {\n\t\t\tdelete this.protectedChunks[key];\n\t\t\tchunk.locked = false;\n\t\t\tthis.findNeighborLockedChunks(chunk, chunk.locked);\n\t\t}\n\t\teventSys.emit(e.renderer.rmChunk, chunk);\n\t}\n\n\tchunkPasted(x, y, data) {\n\t\tvar chunk = this.chunks[`${x},${y}`];\n\t\tif (chunk) {\n\t\t\tchunk.set(data);\n\t\t\teventSys.emit(e.renderer.updateChunk, chunk);\n\t\t}\n\t}\n\n\tunloadAllChunks() {\n\t\tfor (const c in this.chunks) {\n\t\t\tthis.chunks[c].remove();\n\t\t}\n\t}\n}\n","'use strict';\nimport { protocol, EVENTS as e, options } from './conf.js';\nimport { eventSys, PublicAPI } from './global.js';\nimport { elements, misc } from './main.js';\nimport { player } from './local_player.js';\nimport { activeFx } from './Fx.js';\nimport { getTime } from './util/misc.js';\nimport { colorUtils as color } from './util/color.js';\nimport { Lerp } from './util/Lerp.js';\nimport { tools } from './tools.js';\n\nexport { centerCameraTo, moveCameraBy, moveCameraTo, isVisible };\n\n/* oh boy, i'm going to get shit for making this private, aren't i?  */\nconst cameraValues = {\n\tx: 0,\n\ty: 0,\n\tzoom: -1/*,\n\tlerpZoom: new Lerp(options.defaultZoom, options.defaultZoom, 200)*/\n};\n\nexport const camera = {\n\tget x() { return cameraValues.x; },\n\tget y() { return cameraValues.y; },\n\tget zoom() { return cameraValues.zoom; },\n\t/*get lerpZoom() { return cameraValues.lerpZoom.val; },*/\n\tset zoom(z) {\n\t\tz = Math.min(options.zoomLimitMax, Math.max(options.zoomLimitMin, z));\n\t\tif (z !== cameraValues.zoom) {\n\t\t\tvar center = getCenterPixel();\n\t\t\tcameraValues.zoom = z;\n\t\t\tcenterCameraTo(center[0], center[1]);\n\t\t\teventSys.emit(e.camera.zoom, z);\n\t\t}\n\t},\n\tisVisible: isVisible\n};\n\nconst rendererValues = {\n\tupdateRequired: 3,\n\tanimContext: null,\n\tgridShown: true,\n\tgridPattern: null, /* Rendered each time the zoom changes */\n\tunloadedPattern: null,\n\tworldBackground: null,\n\tminGridZoom: options.minGridZoom,\n\tupdatedClusters: [], /* Clusters to render in the next frame */\n\tclusters: {},\n\tvisibleClusters: [],\n\tcurrentFontSize: -1\n};\n\n/*PublicAPI.rval = rendererValues;*/\n\nexport const renderer = {\n\trendertype: {\n\t\tALL:      0b11,\n\t\tFX:       0b01,\n\t\tWORLD:    0b10\n\t},\n\tpatterns: {\n\t\tget unloaded() { return rendererValues.unloadedPattern; }\n\t},\n\trender: requestRender,\n\tshowGrid: setGridVisibility,\n\tget gridShown() { return rendererValues.gridShown; },\n\tupdateCamera: onCameraMove,\n\tunloadFarClusters: unloadFarClusters\n};\n\nPublicAPI.camera = camera;\nPublicAPI.renderer = renderer;\n\nclass BufView {\n\tconstructor(u32data, x, y, w, h, realw) {\n\t\tthis.data = u32data;\n\t\tif (options.chunkBugWorkaround) {\n\t\t\tthis.changes = [];\n\t\t}\n\t\tthis.offx = x;\n\t\tthis.offy = y;\n\t\tthis.realwidth = realw;\n\t\tthis.width = w;\n\t\tthis.height = h;\n\t}\n\n\tget(x, y) {\n\t\treturn this.data[(this.offx + x) + (this.offy + y) * this.realwidth];\n\t}\n\n\tset(x, y, data) {\n\t\tthis.data[(this.offx + x) + (this.offy + y) * this.realwidth] = data;\n\t\tif (options.chunkBugWorkaround) {\n\t\t\tthis.changes.push([0, x, y, data]);\n\t\t}\n\t}\n\n\tfill(data) {\n\t\tfor (var i = 0; i < this.height; i++) {\n\t\t\tfor (var j = 0; j < this.width; j++) {\n\t\t\t\tthis.data[(this.offx + j) + (this.offy + i) * this.realwidth] = data;\n\t\t\t}\n\t\t}\n\t\tif (options.chunkBugWorkaround) {\n\t\t\tthis.changes.push([1, 0, 0, data]);\n\t\t}\n\t}\n\n\tfillFromBuf(u32buf) {\n\t\tfor (var i = 0; i < this.height; i++) {\n\t\t\tfor (var j = 0; j < this.width; j++) {\n\t\t\t\tthis.data[(this.offx + j) + (this.offy + i) * this.realwidth] = u32buf[j + i * this.width];\n\t\t\t\tif (options.chunkBugWorkaround) {\n\t\t\t\t\t/* Terrible */\n\t\t\t\t\tthis.changes.push([0, j, i, u32buf[j + i * this.width]]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass ChunkCluster {\n\tconstructor(x, y) {\n\t\tthis.removed = false;\n\t\tthis.toUpdate = false;\n\t\tthis.shown = false; /* is in document? */\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.canvas = document.createElement(\"canvas\");\n\t\tthis.canvas.width = protocol.chunkSize * protocol.clusterChunkAmount;\n\t\tthis.canvas.height = protocol.chunkSize * protocol.clusterChunkAmount;\n\t\tthis.ctx = this.canvas.getContext(\"2d\");\n\t\tthis.data = this.ctx.createImageData(this.canvas.width, this.canvas.height);\n\t\tthis.u32data = new Uint32Array(this.data.data.buffer);\n\t\tthis.chunks = [];\n\t\tif (options.chunkBugWorkaround) {\n\t\t\tthis.currentColor = 0;\n\t\t}\n\t}\n\n\trender() {\n\t\tthis.toUpdate = false;\n\t\tfor (var i = this.chunks.length; i--;) {\n\t\t\tvar c = this.chunks[i];\n\t\t\tif (c.needsRedraw) {\n\t\t\t\tc.needsRedraw = false;\n\t\t\t\tif (options.chunkBugWorkaround) {\n\t\t\t\t\tvar arr = c.view.changes;\n\t\t\t\t\tvar s = protocol.chunkSize;\n\t\t\t\t\tfor (var j = 0; j < arr.length; j++) {\n\t\t\t\t\t\tvar current = arr[j];\n\t\t\t\t\t\tif (this.currentColor !== current[3]) {\n\t\t\t\t\t\t\tthis.currentColor = current[3];\n\t\t\t\t\t\t\tthis.ctx.fillStyle = color.toHTML(current[3]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tswitch (current[0]) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\tthis.ctx.fillRect(c.view.offx + current[1], c.view.offy + current[2], 1, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\tthis.ctx.fillRect(c.view.offx, c.view.offy, s, s);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tc.view.changes = [];\n\t\t\t\t} else {\n\t\t\t\t\tthis.ctx.putImageData(this.data, 0, 0,\n\t\t\t\t\t\tc.view.offx, c.view.offy, c.view.width, c.view.height);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tremove() {\n\t\tthis.removed = true;\n\t\tif (this.shown) {\n\t\t\tvar visiblecl = rendererValues.visibleClusters;\n\t\t\tvisiblecl.splice(visiblecl.indexOf(this), 1);\n\t\t\tthis.shown = false;\n\t\t}\n\t\tthis.canvas.width = 0;\n\t\tthis.u32data = this.data = null;\n\t\tdelete rendererValues.clusters[`${this.x},${this.y}`];\n\t\tfor (var i = 0; i < this.chunks.length; i++) {\n\t\t\tthis.chunks[i].view = null;\n\t\t\tthis.chunks[i].remove();\n\t\t}\n\t\tthis.chunks = [];\n\t}\n\n\taddChunk(chunk) {\n\t\t/* WARNING: Should absMod if not power of two */\n\t\tvar x = chunk.x & (protocol.clusterChunkAmount - 1);\n\t\tvar y = chunk.y & (protocol.clusterChunkAmount - 1);\n\t\tvar s = protocol.chunkSize;\n\t\tvar view = new BufView(this.u32data, x * s, y * s, s, s, protocol.clusterChunkAmount * s);\n\t\tif (chunk.tmpChunkBuf) {\n\t\t\tview.fillFromBuf(chunk.tmpChunkBuf);\n\t\t\tchunk.tmpChunkBuf = null;\n\t\t}\n\t\tchunk.view = view;\n\t\tthis.chunks.push(chunk);\n\t\tchunk.needsRedraw = true;\n\t}\n\n\tdelChunk(chunk) {\n\t\tchunk.view = null;\n\t\t/* There is no real need to clearRect the chunk area */\n\t\tvar i = this.chunks.indexOf(chunk);\n\t\tif (i !== -1) {\n\t\t\tthis.chunks.splice(i, 1);\n\t\t}\n\t\tif (!this.chunks.length) {\n\t\t\tthis.remove();\n\t\t}\n\t}\n}\n\n/* Draws white text with a black border */\nexport function drawText(ctx, str, x, y, centered){\n\tctx.strokeStyle = \"#000000\",\n\tctx.fillStyle = \"#FFFFFF\",\n\tctx.lineWidth = 2.5,\n\tctx.globalAlpha = 0.5;\n\tif(centered) {\n\t\tx -= ctx.measureText(str).width >> 1;\n\t}\n\tctx.strokeText(str, x, y);\n\tctx.globalAlpha = 1;\n\tctx.fillText(str, x, y);\n}\n\nfunction isVisible(x, y, w, h) {\n\tvar cx    = camera.x;\n\tvar cy    = camera.y;\n\tvar czoom = camera.zoom;\n\tvar cw    = window.innerWidth;\n\tvar ch    = window.innerHeight;\n\treturn x + w > cx && y + h > cy &&\n\t       x <= cx + cw / czoom && y <= cy + ch / czoom;\n}\n\nexport function unloadFarClusters() { /* Slow? */\n\tvar camx = camera.x;\n\tvar camy = camera.y;\n\tvar zoom = camera.zoom;\n\tvar camw = window.innerWidth / zoom | 0;\n\tvar camh = window.innerHeight / zoom | 0;\n\tvar ctrx = camx + camw / 2;\n\tvar ctry = camy + camh / 2;\n\tvar s = protocol.clusterChunkAmount * protocol.chunkSize;\n\tfor (var c in rendererValues.clusters) {\n\t\tc = rendererValues.clusters[c];\n\t\tif (!isVisible(c.x * s, c.y * s, s, s)) {\n\t\t\tvar dx = Math.abs(ctrx / s - c.x) | 0;\n\t\t\tvar dy = Math.abs(ctry / s - c.y) | 0;\n\t\t\tvar dist = dx + dy; /* no sqrt please */\n\t\t\t//console.log(dist);\n\t\t\tif (dist > options.unloadDistance) {\n\t\t\t\tc.remove();\n\t\t\t}\n\t\t}\n\t}\n}\n\n\nfunction render(type) {\n\tvar time = getTime(true);\n\tvar camx = camera.x;\n\tvar camy = camera.y;\n\tvar zoom = camera.zoom;\n\tvar needsRender = 0; /* If an animation didn't finish, render again */\n\n\tif (type & renderer.rendertype.WORLD) {\n\t\tvar uClusters = rendererValues.updatedClusters;\n\t\tfor (var i = 0; i < uClusters.length; i++) {\n\t\t\tvar c = uClusters[i];\n\t\t\tc.render();\n\t\t}\n\t\trendererValues.updatedClusters = [];\n\t}\n\n\tif (type & renderer.rendertype.FX && misc.world !== null) {\n\t\tvar ctx = rendererValues.animContext;\n\t\tvar visible = rendererValues.visibleClusters;\n\t\tvar clusterCanvasSize = protocol.chunkSize * protocol.clusterChunkAmount;\n\t\tvar cwidth = window.innerWidth;\n\t\tvar cheight = window.innerHeight;\n\t\tvar background = rendererValues.worldBackground;\n\t\tvar allChunksLoaded = misc.world.allChunksLoaded();\n\n\t\tif (!allChunksLoaded) {\n\t\t\tctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n\t\t}\n\n\t\tctx.lineWidth = 2.5 / 16 * zoom;\n\n\t\tctx.scale(zoom, zoom);\n\n\t\tfor (var i = 0; i < visible.length; i++) {\n\t\t\tvar cluster = visible[i];\n\t\t\tvar gx = -(camx - cluster.x * clusterCanvasSize);\n\t\t\tvar gy = -(camy - cluster.y * clusterCanvasSize);\n\t\t\tvar clipx = gx < 0 ? -gx : 0;\n\t\t\tvar clipy = gy < 0 ? -gy : 0;\n\t\t\tvar x = gx < 0 ? 0 : gx;\n\t\t\tvar y = gy < 0 ? 0 : gy;\n\t\t\tvar clipw = clusterCanvasSize - clipx;\n\t\t\tvar cliph = clusterCanvasSize - clipy;\n\t\t\tclipw = clipw + x < cwidth / zoom ? clipw : cwidth / zoom - x;\n\t\t\tcliph = cliph + y < cheight / zoom ? cliph : cheight / zoom - y;\n\t\t\tclipw = (clipw + 1) | 0; /* Math.ceil */\n\t\t\tcliph = (cliph + 1) | 0;\n\t\t\tif (clipw > 0 && cliph > 0) {\n\t\t\t\tctx.drawImage(cluster.canvas, clipx, clipy, clipw, cliph, x, y, clipw, cliph);\n\t\t\t}\n\t\t}\n\n\t\tctx.scale(1 / zoom, 1 / zoom); /* probably faster than ctx.save(), ctx.restore() */\n\n\t\tif (background != null) {\n\t\t\tvar newscale = zoom / options.defaultZoom;\n\t\t\tvar oldscale = options.defaultZoom / zoom;\n\t\t\tvar gx = -(camx * zoom) % (background.width * newscale);\n\t\t\tvar gy = -(camy * zoom) % (background.height * newscale);\n\t\t\tctx.translate(gx, gy);\n\n\t\t\tctx.fillStyle = background;\n\t\t\tctx.globalCompositeOperation = \"destination-over\";\n\n\t\t\tctx.scale(newscale, newscale);\n\t\t\tctx.fillRect(-gx / newscale, -gy / newscale, ctx.canvas.width * oldscale, ctx.canvas.height * oldscale);\n\t\t\tctx.scale(oldscale, oldscale);\n\n\t\t\tctx.translate(-gx, -gy);\n\t\t}\n\n\t\tvar gx = -(camx * zoom) % (16 * zoom);\n\t\tvar gy = -(camy * zoom) % (16 * zoom);\n\t\tctx.translate(gx, gy);\n\n\t\tif (rendererValues.gridShown && rendererValues.gridPattern) {\n\t\t\tctx.fillStyle = rendererValues.gridPattern;\n\t\t\tif (!allChunksLoaded) {\n\t\t\t\tctx.globalCompositeOperation = \"source-atop\";\n\t\t\t}\n\t\t\tctx.fillRect(-gx, -gy, ctx.canvas.width, ctx.canvas.height);\n\t\t}\n\n\t\tif (rendererValues.unloadedPattern != null && (!allChunksLoaded || background != null)) {\n\t\t\tctx.fillStyle = rendererValues.unloadedPattern;\n\t\t\tctx.globalCompositeOperation = \"destination-over\";\n\t\t\tctx.fillRect(-gx, -gy, ctx.canvas.width, ctx.canvas.height);\n\t\t}\n\n\t\tctx.translate(-gx, -gy);\n\n\t\tctx.globalCompositeOperation = \"source-over\";\n\n\t\tfor (var i = 0; i < activeFx.length; i++) {\n\t\t\tswitch (activeFx[i].render(ctx, time)) {\n\t\t\tcase 0: /* Anim not finished */\n\t\t\t\tneedsRender |= renderer.rendertype.FX;\n\t\t\t\tbreak;\n\t\t\tcase 2: /* Obj deleted from array, prevent flickering */\n\t\t\t\t--i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tctx.globalAlpha = 1;\n\t\tvar players = misc.world.players;\n\t\tvar fontsize = 10 / 16 * zoom | 0;\n\t\tif (rendererValues.currentFontSize != fontsize) {\n\t\t\tctx.font = fontsize + \"px sans-serif\";\n\t\t\trendererValues.currentFontSize = fontsize;\n\t\t}\n\t\tfor (var p in players) {\n\t\t\tvar player = players[p];\n\t\t\tif (!renderPlayer(player, fontsize)) {\n\t\t\t\tneedsRender |= renderer.rendertype.FX;\n\t\t\t}\n\t\t}\n\t}\n\n\n\trequestRender(needsRender);\n}\n\nfunction renderPlayer(targetPlayer, fontsize) {\n\tvar camx = camera.x * 16;\n\tvar camy = camera.y * 16;\n\tvar zoom = camera.zoom;\n\tvar ctx  = rendererValues.animContext;\n\tvar cnvs = ctx.canvas;\n\tvar tool = targetPlayer.tool;\n\tif (!tool) {\n\t\t/* Render the default tool if the selected one isn't defined */\n\t\ttool = tools['cursor'];\n\t}\n\tvar toolwidth = tool.cursor.width / 16 * zoom;\n\tvar toolheight = tool.cursor.height / 16 * zoom;\n\n\tvar x = targetPlayer.x;\n\tvar y = targetPlayer.y;\n\tvar cx = ((x - camx) - tool.offset[0]) * (zoom / 16) | 0;\n\tvar cy = ((y - camy) - tool.offset[1]) * (zoom / 16) | 0;\n\n\tif(cx < -toolwidth || cy < -toolheight\n\t|| cx > cnvs.width || cy > cnvs.height) {\n\t\treturn true;\n\t}\n\n\n\tif (fontsize > 3) {\n\t\tvar idstr = targetPlayer.id;\n\t\tvar textw = ctx.measureText(idstr).width + (zoom / 2);\n\n\t\tctx.globalAlpha = 1;\n\t\tctx.fillStyle = targetPlayer.clr;\n\t\tctx.fillRect(cx, cy + toolheight, textw, zoom);\n\t\tctx.globalAlpha = 0.2;\n\t\tctx.lineWidth = 3;\n\t\tctx.strokeStyle = \"#000000\";\n\t\tctx.strokeRect(cx, cy + toolheight, textw, zoom);\n\t\tctx.globalAlpha = 1;\n\t\tdrawText(ctx, idstr, cx + zoom / 4, cy + fontsize + toolheight + zoom / 8);\n\t}\n\n\tctx.drawImage(tool.cursor, cx, cy, toolwidth, toolheight);\n\n\treturn x === targetPlayer.endX && y === targetPlayer.endY;\n}\n\nfunction requestRender(type) {\n\trendererValues.updateRequired |= type;\n}\n\nfunction setGridVisibility(enabled) {\n\trendererValues.gridShown = enabled;\n\trequestRender(renderer.rendertype.FX);\n}\n\nfunction renderGrid(zoom) {\n\tvar tmpcanvas = document.createElement(\"canvas\");\n\tvar ctx = tmpcanvas.getContext(\"2d\");\n\tvar size = tmpcanvas.width = tmpcanvas.height = Math.round(16 * zoom);\n\tctx.setLineDash([1]);\n\tctx.globalAlpha = 0.2;\n\tif (zoom >= 4) {\n\t\tvar fadeMult = Math.min(1, zoom - 4);\n\t\tif (fadeMult < 1) {\n\t\t\tctx.globalAlpha = 0.2 * fadeMult;\n\t\t}\n\t\tctx.beginPath();\n\t\tfor (var i = 16; --i;) {\n\t\t\tctx.moveTo(i * zoom + .5, 0);\n\t\t\tctx.lineTo(i * zoom + .5, size);\n\t\t\tctx.moveTo(0, i * zoom + .5);\n\t\t\tctx.lineTo(size, i * zoom + .5);\n\t\t}\n\t\tctx.stroke();\n\t\tctx.globalAlpha = Math.max(0.2, 1 * fadeMult);\n\t}\n\tctx.beginPath();\n\tctx.moveTo(0, 0);\n\tctx.lineTo(0, size);\n\tctx.lineTo(size, size);\n\tctx.stroke();\n\treturn ctx.createPattern(tmpcanvas, \"repeat\");\n}\n\nfunction setGridZoom(zoom) {\n\tif (zoom >= rendererValues.minGridZoom) {\n\t\trendererValues.gridPattern = renderGrid(zoom);\n\t} else {\n\t\trendererValues.gridPattern = null;\n\t}\n}\n\nfunction updateVisible() {\n\tvar clusters = rendererValues.clusters;\n\tvar visiblecl = rendererValues.visibleClusters;\n\tfor (var c in clusters) {\n\t\tc = clusters[c];\n\t\tvar size = protocol.chunkSize * protocol.clusterChunkAmount;\n\t\tvar visible = isVisible(c.x * size, c.y * size, size, size);\n\t\tif (!visible && c.shown) {\n\t\t\tc.shown = false;\n\t\t\tvisiblecl.splice(visiblecl.indexOf(c), 1);\n\t\t} else if (visible && !c.shown) {\n\t\t\tc.shown = true;\n\t\t\tvisiblecl.push(c);\n\t\t\trequestRender(renderer.rendertype.WORLD);\n\t\t}\n\t}\n};\n\nfunction onResize() {\n\telements.animCanvas.width = window.innerWidth;\n\telements.animCanvas.height = window.innerHeight;\n\tvar ctx = rendererValues.animContext;\n\tctx.imageSmoothingEnabled = false;\n\tctx.webkitImageSmoothingEnabled = false;\n\tctx.mozImageSmoothingEnabled = false;\n\tctx.msImageSmoothingEnabled = false;\n\tctx.oImageSmoothingEnabled = false;\n\trendererValues.currentFontSize = -1;\n\tonCameraMove();\n}\n\nfunction alignCamera() {\n\tvar zoom = cameraValues.zoom;\n\tvar alignedX = Math.round(cameraValues.x * zoom) / zoom;\n\tvar alignedY = Math.round(cameraValues.y * zoom) / zoom;\n\tcameraValues.x = alignedX;\n\tcameraValues.y = alignedY;\n}\n\nfunction requestMissingChunks() { /* TODO: move this to World */\n\tvar x = camera.x / protocol.chunkSize - 2 | 0;\n\tvar mx = camera.x / protocol.chunkSize + window.innerWidth / camera.zoom / protocol.chunkSize | 0;\n\tvar cy = camera.y / protocol.chunkSize - 2 | 0;\n\tvar my = camera.y / protocol.chunkSize + window.innerHeight / camera.zoom / protocol.chunkSize | 0;\n\twhile (++x <= mx) {\n\t\tvar y = cy;\n\t\twhile (++y <= my) {\n\t\t\tmisc.world.loadChunk(x, y);\n\t\t}\n\t}\n}\n\nfunction onCameraMove() {\n\teventSys.emit(e.camera.moved, camera);\n\talignCamera();\n\tupdateVisible();\n\tif (misc.world !== null) {\n\t\trequestMissingChunks();\n\t}\n\trequestRender(renderer.rendertype.FX);\n}\n\nfunction getCenterPixel() {\n\tvar x = Math.round(cameraValues.x + window.innerWidth / camera.zoom / 2);\n\tvar y = Math.round(cameraValues.y + window.innerHeight / camera.zoom / 2);\n\treturn [x, y];\n}\n\nfunction centerCameraTo(x, y) {\n\tcameraValues.x = -(window.innerWidth / camera.zoom / 2) + x;\n\tcameraValues.y = -(window.innerHeight / camera.zoom / 2) + y;\n\tonCameraMove();\n}\n\nfunction moveCameraBy(x, y) {\n\tcameraValues.x += x;\n\tcameraValues.y += y;\n\tonCameraMove();\n}\n\nfunction moveCameraTo(x, y) {\n\tcameraValues.x = x;\n\tcameraValues.y = y;\n\tonCameraMove();\n}\n\neventSys.on(e.net.world.teleported, (x, y) => {\n\tcenterCameraTo(x, y);\n});\n\neventSys.on(e.camera.zoom, z => {\n\tsetGridZoom(z);\n\t/*cameraValues.lerpZoom.val = z;*/\n\trequestRender(renderer.rendertype.FX);\n});\n\neventSys.on(e.renderer.addChunk, chunk => {\n\tvar clusterX = Math.floor(chunk.x / protocol.clusterChunkAmount);\n\tvar clusterY = Math.floor(chunk.y / protocol.clusterChunkAmount);\n\tvar key = `${clusterX},${clusterY}`;\n\tvar clusters = rendererValues.clusters;\n\tvar cluster = clusters[key];\n\tif (!cluster) {\n\t\tcluster = clusters[key] = new ChunkCluster(clusterX, clusterY);\n\t\tupdateVisible();\n\t}\n\tcluster.addChunk(chunk);\n\tif (!cluster.toUpdate) {\n\t\tcluster.toUpdate = true;\n\t\trendererValues.updatedClusters.push(cluster);\n\t}\n\tvar size = protocol.chunkSize;\n\tif (cluster.toUpdate || isVisible(chunk.x * size, chunk.y * size, size, size)) {\n\t\trequestRender(renderer.rendertype.WORLD | renderer.rendertype.FX);\n\t}\n});\n\neventSys.on(e.renderer.rmChunk, chunk => {\n\tvar clusterX = Math.floor(chunk.x / protocol.clusterChunkAmount);\n\tvar clusterY = Math.floor(chunk.y / protocol.clusterChunkAmount);\n\tvar key = `${clusterX},${clusterY}`;\n\tvar clusters = rendererValues.clusters;\n\tvar cluster = clusters[key];\n\tif (cluster) {\n\t\tcluster.delChunk(chunk);\n\t\tif (!cluster.removed && !cluster.toUpdate) {\n\t\t\tcluster.toUpdate = true;\n\t\t\trendererValues.updatedClusters.push(cluster);\n\t\t}\n\t}\n});\n\neventSys.on(e.renderer.updateChunk, chunk => {\n\tvar clusterX = Math.floor(chunk.x / protocol.clusterChunkAmount);\n\tvar clusterY = Math.floor(chunk.y / protocol.clusterChunkAmount);\n\tvar key = `${clusterX},${clusterY}`;\n\tvar cluster = rendererValues.clusters[key];\n\tif (cluster && !cluster.toUpdate) {\n\t\tcluster.toUpdate = true;\n\t\trendererValues.updatedClusters.push(cluster);\n\t}\n\tvar size = protocol.chunkSize;\n\tif (isVisible(chunk.x * size, chunk.y * size, size, size)) {\n\t\trequestRender(renderer.rendertype.WORLD | renderer.rendertype.FX);\n\t}\n});\n\neventSys.on(e.misc.worldInitialized, () => {\n\trequestMissingChunks();\n});\n\neventSys.once(e.init, () => {\n\trendererValues.animContext = elements.animCanvas.getContext(\"2d\", { alpha: false });\n\twindow.addEventListener(\"resize\", onResize);\n\tonResize();\n\tcamera.zoom = options.defaultZoom;\n\tcenterCameraTo(0, 0);\n\n\tconst mkPatternFromUrl = (url, cb) => {\n\t\tvar patImg = new Image();\n\t\tpatImg.onload = () => {\n\t\t\tvar pat = rendererValues.animContext.createPattern(patImg, \"repeat\");\n\t\t\tpat.width = patImg.width;\n\t\t\tpat.height = patImg.height;\n\t\t\tcb(pat);\n\t\t};\n\t\tpatImg.src = url;\n\t};\n\n\t/* Create the pattern images */\n\tmkPatternFromUrl(options.unloadedPatternUrl, pat => {\n\t\trendererValues.unloadedPattern = pat;\n\t});\n\n\tif (options.backgroundUrl != null) {\n\t\tmkPatternFromUrl(options.backgroundUrl, pat => {\n\t\t\trendererValues.worldBackground = pat;\n\t\t});\n\t}\n\n\tfunction frameLoop() {\n\t\tlet type;\n\t\tif ((type = rendererValues.updateRequired) !== 0) {\n\t\t\trendererValues.updateRequired = 0;\n\t\t\trender(type);\n\t\t}\n\t\twindow.requestAnimationFrame(frameLoop);\n\t}\n\teventSys.once(e.misc.toolsInitialized, frameLoop);\n});\n","'use strict';\nimport { EVENTS as e } from './conf.js';\nimport { eventSys } from './global.js';\nimport { mkHTML, loadScript, setCookie } from './util/misc.js';\nimport { windowSys, GUIWindow, UtilDialog } from './windowsys.js';\nimport { misc } from './main.js';\n\nconst SITEKEY = \"6Lds3s4UAAAAABt8aF9F32jNkVK2Rr21xLi0_AzC\";\n\nfunction loadCaptcha(onload) {\n\tif (!window.grecaptcha) {\n\t\tif (window.callback) {\n\t\t\t/* Hacky solution for race condition */\n\t\t\twindow.callback = function() {\n\t\t\t\tonload();\n\t\t\t\tthis();\n\t\t\t}.bind(window.callback);\n\t\t} else {\n        \twindow.callback = function() {\n\t            delete window.callback;\n            \tonload();\n        \t};\n        \teventSys.emit(e.misc.loadingCaptcha);\n\t\t\tloadScript(\"https://www.google.com/recaptcha/api.js?onload=callback&render=explicit\");\n\t\t}\n\t} else {\n\t\tonload();\n\t}\n}\n\nfunction requestVerification() {\n\twindowSys.addWindow(new GUIWindow(\"Verification needed\", {\n\t\t\tcentered: true\n\t}, wdow => {\n\t\tvar id = grecaptcha.render(wdow.addObj(mkHTML(\"div\", {\n\t\t\tid: \"captchawdow\"\n\t\t})), {\n\t\t\ttheme: \"light\",\n\t\t\tsitekey: SITEKEY,\n\t\t\tcallback: token => {\n\t\t\t\teventSys.emit(e.misc.captchaToken, token);\n\t\t\t\twdow.close();\n\t\t\t}\n\t\t});\n\t\twdow.frame.style.cssText = \"\";\n\t\twdow.container.style.cssText = \"overflow: hidden; background-color: #F9F9F9\";\n\t}));\n}\n\nexport function loadAndRequestCaptcha() {\n\tif ('owopcaptcha' in localStorage) {\n\t\tsetTimeout(() => {\n\t\t\teventSys.emit(e.misc.captchaToken, 'LETMEINPLZ' + localStorage.owopcaptcha);\n\t\t}, 0);\n\t} else {\n\t\tloadCaptcha(requestVerification);\n\t}\n}\n","\"use strict\";\nimport { eventSys, PublicAPI } from './global.js';\nimport { propertyDefaults, storageEnabled } from './util/misc.js';\nimport toolSet from '../img/toolset.png';\nimport unloadedPat from '../img/unloaded.png';\n\n/* Important constants */\n\nexport let protocol = null;\n\n/* The raw event ID numbers should NOT be used, instead import the EVENTS object in your file. */\nlet evtId = 6666666; /* no */\n\nexport const RANK = {\n\tNONE: 0,\n\tUSER: 1,\n\tMODERATOR: 2,\n\tADMIN: 3\n};\n\nPublicAPI.RANK = RANK;\n\nexport const EVENTS = {\n\tloaded: ++evtId,\n\tinit: ++evtId,\n\ttick: ++evtId,\n\tmisc: {\n\t\ttoolsRendered: ++evtId,\n\t\ttoolsInitialized: ++evtId,\n\t\tlogoMakeRoom: ++evtId,\n\t\tworldInitialized: ++evtId,\n\t\twindowAdded: ++evtId,\n\t\tcaptchaToken: ++evtId,\n\t\tloadingCaptcha: ++evtId\n\t},\n\trenderer: {\n\t\taddChunk: ++evtId,\n\t\trmChunk: ++evtId,\n\t\tupdateChunk: ++evtId\n\t},\n\tcamera: {\n\t\tmoved: ++evtId,\n\t\tzoom: ++evtId /* (zoom value), note that this event should not be used to SET zoom level. */\n\t},\n\tnet: {\n\t\tconnecting: ++evtId,\n\t\tconnected: ++evtId,\n\t\tdisconnected: ++evtId,\n\t\tplayerCount: ++evtId,\n\t\tchat: ++evtId,\n\t\tdevChat: ++evtId,\n\t\tworld: {\n\t\t\tleave: ++evtId,\n\t\t\tjoin: ++evtId, /* (worldName string) */\n\t\t\tjoining: ++evtId, /* (worldName string) */\n\t\t\tsetId: ++evtId,\n\t\t\tplayersMoved: ++evtId, /* (Object with all the updated player values) */\n\t\t\tplayersLeft: ++evtId,\n\t\t\ttilesUpdated: ++evtId,\n\t\t\tteleported: ++evtId\n\t\t},\n\t\tchunk: {\n\t\t\tload: ++evtId, /* (Chunk class) */\n\t\t\tunload: ++evtId, /* (x, y) */\n\t\t\tset: ++evtId, /* (x, y, data), backwards compat */\n\t\t\tlock: ++evtId,\n\t\t\tallLoaded: ++evtId\n\t\t},\n\t\tsec: {\n\t\t\trank: ++evtId\n\t\t},\n\t\tmaxCount: ++evtId\n\t}\n};\n\n/*export const PUBLIC_EVENTS = {\n\tloaded: EVENTS.loaded,\n\tinit: EVENTS.init,\n\ttick: EVENTS.tick,\n\ttoolsInitialized: EVENTS.misc.toolsInitialized,\n\tallChunksLoaded: EVENTS.net.chunk.allLoaded\n};*/\n\nPublicAPI.events = EVENTS;\n\nlet userOptions = {};\nif (storageEnabled()) {\n\ttry {\n\t\tuserOptions = JSON.parse(localStorage.getItem('owopOptions') || '{}');\n\t} catch (e) {\n\t\tconsole.error('Error while parsing user options!', e);\n\t}\n}\n\nlet shouldFool = (d => d.getMonth() == 3 && d.getDate() == 1)(new Date());\n\nexport const options = propertyDefaults(userOptions, {\n\tserverAddress: [/*{\n\t\tdefault: !PRODUCTION_BUILD,\n\t\ttitle: 'Localhost',\n\t\tproto: 'old',\n\t\turl: 'wss://dev.ourworldofpixels.com',\n\t\tmaxRetries: 1\n\t},*/{\n\t\tdefault: true,\n\t\ttitle: 'Official server',\n\t\tproto: 'old',\n\t\turl: \"wss://asdddd.glitch.me/\"\n\t}], // The server address that websockets connect to\n\tfallbackFps: 30, // Fps used if requestAnimationFrame is not supported\n\tmaxChatBuffer: 256, // How many chat messages to retain in the chatbox\n\ttickSpeed: 30, // How many times per second to run a tick\n\tminGridZoom: 1, /* Minimum zoom level where the grid shows up */\n\tmovementSpeed: 1, /* Pixels per tick */\n\tdefaultWorld: shouldFool ? 'aprilfools' : 'main',\n\tenableSounds: true,\n\tenableIdView: true,\n\tdefaultZoom: 16,\n\tzoomStrength: 1,\n\tzoomLimitMin: 1,\n\tzoomLimitMax: 32,\n\tunloadDistance: 10,\n\ttoolSetUrl: toolSet,\n\tunloadedPatternUrl: unloadedPat,\n\tnoUi: false,\n\tfool: shouldFool,\n\tbackgroundUrl: null,\n\t/* Bug only affects Windows users with an old Intel graphics card driver */\n\tchunkBugWorkaround: false, // navigator.userAgent.indexOf('Windows NT') !== -1\n\thexCoords: false\n});\n\nif (options.chunkBugWorkaround) {\n\tconsole.debug('Chunk bug workaround enabled!');\n}\n\nPublicAPI.options = options;\n\neventSys.on(EVENTS.net.connecting, server => {\n\tprotocol = server.proto;\n});\n","\"use strict\";\n\nvar shown = false;\nvar contextMenu = document.createElement(\"div\");\ncontextMenu.className = \"context-menu\";\n\nfunction removeMenu(event) {\n\t\tdocument.body.removeChild(contextMenu);\n\t\tdocument.removeEventListener(\"click\", removeMenu);\n\t\tshown = false;\n}\n\nexport function createContextMenu(x, y, buttons) {\n\tif (shown) {\n\t\tremoveMenu();\n\t}\n\n\tcontextMenu.innerHTML = \"\";\n\tfor (var i=0; i<buttons.length; i++) {\n\t\tvar button = document.createElement(\"button\");\n\t\tbutton.textContent = buttons[i][0];\n\t\tbutton.addEventListener(\"click\", buttons[i][1]);\n\t\tcontextMenu.appendChild(button);\n\t}\n\tdocument.body.appendChild(contextMenu);\n\tshown = true;\n\tvar height = contextMenu.offsetHeight;\n\tconsole.log(height);\n\tif (y + height > window.innerHeight - 20) {\n\t\tcontextMenu.style.top = (y - height) + \"px\";\n\t} else {\n\t\tcontextMenu.style.top = y + \"px\";\n\t}\n\tcontextMenu.style.left = x + \"px\";\n\n\tdocument.addEventListener(\"click\", removeMenu);\n}","'use strict';\n\nimport { EventEmitter } from 'events';\n\nexport const PublicAPI = window.OWOP = window.WorldOfPixels = {};\nexport const eventSys = new EventEmitter();","'use strict';\r\nimport { eventSys, PublicAPI } from './global.js';\r\nimport { EVENTS as e, RANK } from './conf.js';\r\nimport { absMod, setTooltip } from './util/misc.js';\r\nimport { elements, mouse, misc, showDevChat, showPlayerList, revealSecrets } from './main.js';\r\nimport { colorUtils as color } from './util/color.js';\r\nimport { renderer } from './canvas_renderer.js';\r\nimport { cursors } from './tool_renderer.js';\r\nimport { tools, updateToolbar, updateToolWindow } from './tools.js';\r\nimport { Fx, PLAYERFX } from './Fx.js';\r\nimport { net } from './networking.js';\r\nimport { Bucket } from './util/Bucket.js';\r\n\r\nexport { updateClientFx };\r\n\r\nlet toolSelected = null;\r\n\r\n// SWEETIE 16 palette\r\n/*const palette = [\r\n\t[0x1A, 0x1C, 0x2C], [0x57, 0x29, 0x56], [0xB1, 0x41, 0x56], [0xEE, 0x7B, 0x58],\r\n\t[0xFF, 0xD0, 0x79], [0xA0, 0xF0, 0x72], [0x38, 0xB8, 0x6E], [0x27, 0x6E, 0x7B],\r\n\t[0x29, 0x36, 0x6F], [0x40, 0x5B, 0xD0], [0x4F, 0xA4, 0xF7], [0x86, 0xEC, 0xF8],\r\n\t[0xF4, 0xF4, 0xF4], [0x93, 0xB6, 0xC1], [0x55, 0x71, 0x85], [0x32, 0x40, 0x56]\r\n];*/\r\n// ENDESGA 16 palette\r\nconst palette = [\r\n\t[0xE4, 0xA6, 0x72], [0xB8, 0x6F, 0x50], [0x74, 0x3F, 0x39], [0x3F, 0x28, 0x32],\r\n\t[0x9E, 0x28, 0x35], [0xE5, 0x3B, 0x44], [0xFB, 0x92, 0x2B], [0xFF, 0xE7, 0x62],\r\n\t[0x63, 0xC6, 0x4D], [0x32, 0x73, 0x45], [0x19, 0x3D, 0x3F], [0x4F, 0x67, 0x81],\r\n\t[0xAF, 0xBF, 0xD2], [0xFF, 0xFF, 0xFF], [0x2C, 0xE8, 0xF4], [0x04, 0x84, 0xD1]\r\n];\r\nlet paletteIndex = 0;\r\n\r\nexport const undoHistory = [];\r\n\r\nconst clientFx = new Fx(PLAYERFX.NONE, {\r\n\tisLocalPlayer: true,\r\n\tplayer: {\r\n\t\tget tileX() { return mouse.tileX; },\r\n\t\tget tileY() { return mouse.tileY; },\r\n\t\tget x() { return mouse.worldX; },\r\n\t\tget y() { return mouse.worldY; },\r\n\t\tget htmlRgb() {\r\n\t\t\treturn player.htmlRgb;\r\n\t\t},\r\n\t\tget tool() {\r\n\t\t\treturn player.tool;\r\n\t\t}\r\n\t}\r\n});\r\n\r\nclientFx.setVisibleFunc(() => {\r\n\treturn mouse.insideViewport && mouse.validTile;\r\n});\r\n\r\n// exported variables are always const it seems\r\nexport const networkRankVerification = [RANK.NONE];\r\nlet rank = RANK.NONE;\r\nlet somethingChanged = false;\r\n\r\nlet cachedHtmlRgb = [null, \"\"];\r\n\r\nexport const player = {\r\n\tget paletteIndex() { return paletteIndex; },\r\n\tset paletteIndex(i) {\r\n\t\tpaletteIndex = absMod(i, palette.length);\r\n\t\tupdatePalette();\r\n\t},\r\n\tget htmlRgb() {\r\n\t\tvar selClr = player.selectedColor;\r\n\t\tif (cachedHtmlRgb[0] === selClr) {\r\n\t\t\treturn cachedHtmlRgb[1];\r\n\t\t} else {\r\n\t\t\tvar str = color.toHTML(color.u24_888(selClr[0], selClr[1], selClr[2]));\r\n\t\t\tcachedHtmlRgb[0] = selClr;\r\n\t\t\tcachedHtmlRgb[1] = str;\r\n\t\t\treturn str;\r\n\t\t}\r\n\t},\r\n\tget selectedColor() { return palette[paletteIndex]; },\r\n\tset selectedColor(c) {\r\n\t\taddPaletteColor(c);\r\n\t},\r\n\tget palette() { return palette; },\r\n\tget rank() { return rank },\r\n\tget tool() { return toolSelected; },\r\n\tset tool(name) {\r\n\t\tselectTool(name);\r\n\t},\r\n\t/* TODO: Clear confusion between netid and tool id */\r\n\tget toolId() { return net.currentServer.proto.tools.id[toolSelected.id]; },\r\n\tget tools() { return tools; },\r\n\tget id() { return net.protocol.id; }\r\n};\r\n\r\nPublicAPI.player = player;\r\n\r\nexport function shouldUpdate() { /* sets colorChanged to false when called */\r\n\treturn somethingChanged ? !(somethingChanged = false) : somethingChanged;\r\n}\r\n\r\nfunction changedColor() {\r\n\tupdateClientFx();\r\n\tupdatePaletteIndex();\r\n\tsomethingChanged = true;\r\n}\r\n\r\nfunction updatePalette() {\r\n\tvar paletteColors = elements.paletteColors;\r\n\tpaletteColors.innerHTML = \"\";\r\n\tvar colorClick = (index) => () => {\r\n\t\tpaletteIndex = index;\r\n\t\tchangedColor();\r\n\t};\r\n\tvar colorDelete = (index) => () => {\r\n\t\tif(palette.length > 1) {\r\n\t\t\tpalette.splice(index, 1);\r\n\t\t\tif(paletteIndex > index || paletteIndex === palette.length) {\r\n\t\t\t\t--paletteIndex;\r\n\t\t\t}\r\n\t\t\tupdatePalette();\r\n\t\t\tchangedColor();\r\n\t\t}\r\n\t};\r\n\r\n\tfor (var i = 0; i < palette.length; i++) {\r\n\t\tvar element = document.createElement(\"div\");\r\n\t\tvar clr = palette[i];\r\n\t\telement.style.backgroundColor = \"rgb(\" + clr[0] + \",\" + clr[1] + \",\" + clr[2] + \")\";\r\n\t\tsetTooltip(element, color.toHTML(color.u24_888(clr[0], clr[1], clr[2])));\r\n\t\telement.onmouseup = function(e) {\r\n\t\t\tswitch(e.button) {\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tthis.sel();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tthis.del();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}.bind({\r\n\t\t\tsel: colorClick(i),\r\n\t\t\tdel: colorDelete(i)\r\n\t\t});\r\n\t\telement.oncontextmenu = () => false;\r\n\t\tpaletteColors.appendChild(element);\r\n\t}\r\n\tchangedColor();\r\n}\r\n\r\nfunction updatePaletteIndex() {\r\n\telements.paletteColors.style.transform = \"translateY(\" + (-paletteIndex * 40) + \"px)\";\r\n}\r\n\r\nfunction addPaletteColor(color) {\r\n\tfor (var i = 0; i < palette.length; i++) {\r\n\t\tif (palette[i][0] === color[0] && palette[i][1] === color[1] && palette[i][2] === color[2]) {\r\n\t\t\tpaletteIndex = i;\r\n\t\t\tchangedColor();\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tpaletteIndex = palette.length;\r\n\tpalette.push(color);\r\n\tupdatePalette();\r\n}\r\n\r\nexport function getDefaultTool() {\r\n\tfor (var toolName in tools) {\r\n\t\tif (tools[toolName].rankRequired <= player.rank) {\r\n\t\t\treturn toolName;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction selectTool(name) {\r\n\tlet tool = tools[name];\r\n\tif(!tool || tool === toolSelected || tool.rankRequired > player.rank) {\r\n\t\treturn false;\r\n\t}\r\n\tif (toolSelected) {\r\n\t\ttoolSelected.call('deselect');\r\n\t}\r\n\ttoolSelected = tool;\r\n\tmouse.cancelMouseDown();\r\n\ttool.call('select');\r\n\tupdateToolWindow(name);\r\n\tmouse.validClick = false;\r\n\tclientFx.setRenderer(tool.fxRenderer);\r\n\tsomethingChanged = true;\r\n\tupdateClientFx();\r\n\treturn true;\r\n}\r\n\r\nfunction updateClientFx() {\r\n\trenderer.render(renderer.rendertype.FX);\r\n}\r\n\r\neventSys.once(e.misc.toolsInitialized, () => {\r\n\tplayer.tool = getDefaultTool();\r\n});\r\n\r\neventSys.on(e.net.sec.rank, newRank => {\r\n\tif (networkRankVerification[0] < newRank) {\r\n\t\treturn;\r\n\t}\r\n\trank = newRank;\r\n\tconsole.log('Got rank:', newRank);\r\n\t/* This is why we can't have nice things */\r\n\tif (net.isConnected()) {\r\n\t\tnet.protocol.ws.send((new Uint8Array([newRank])).buffer);\r\n\t}\r\n\tswitch (newRank) {\r\n\t\tcase RANK.USER:\r\n\t\tcase RANK.NONE:\r\n\t\t\tshowDevChat(false);\r\n\t\t\tshowPlayerList(false);\r\n\t\t\trevealSecrets(false);\r\n\t\t\tbreak;\r\n\r\n\t\tcase RANK.MODERATOR:\r\n\t\tcase RANK.ADMIN:\r\n\t\t\tshowDevChat(true);\r\n\t\t\tshowPlayerList(true);\r\n\t\t\trevealSecrets(true);\r\n\t\t\tbreak;\r\n\t}\r\n\tupdateToolbar();\r\n});\r\n\r\neventSys.once(e.init, () => {\r\n\telements.paletteInput.onclick = function() {\r\n\t\tvar c = player.selectedColor;\r\n\t\tthis.value = color.toHTML(color.u24_888(c[0], c[1], c[2]));;\r\n\t};\r\n\telements.paletteInput.onchange = function() {\r\n\t\tvar value = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(this.value);\r\n\t\taddPaletteColor([parseInt(value[1], 16), parseInt(value[2], 16), parseInt(value[3], 16)]);\r\n\t};\r\n\telements.paletteCreate.onclick = () => elements.paletteInput.click();\r\n\tsetTooltip(elements.paletteCreate, \"Add color\");\r\n\tupdatePalette();\r\n});\r\n","/*\r\n * TODO List: https://trello.com/b/v6F6isSv/worldofpixels\r\n * NOTE: Let's stick with the correct way of storing colors,\r\n * first byte should be red value: 0xAABBGGRR, or [r, g, b]\r\n */\r\n'use strict';\r\nimport { normalizeWheel } from './util/normalizeWheel.js';\r\nimport anchorme from './util/anchorme.js';\r\n\r\nimport { CHUNK_SIZE, EVENTS as e, RANK } from './conf.js';\r\nimport { Bucket } from './util/Bucket.js';\r\nimport { escapeHTML, getTime, getCookie, setCookie, cookiesEnabled, storageEnabled, loadScript, eventOnce } from './util/misc.js';\r\n\r\nimport { eventSys, PublicAPI } from './global.js';\r\nimport { options } from './conf.js';\r\nimport { World } from './World.js';\r\nimport { camera, renderer, moveCameraBy } from './canvas_renderer.js';\r\nimport { net } from './networking.js';\r\nimport { updateClientFx, player } from './local_player.js';\r\nimport { resolveProtocols, definedProtos } from './protocol/all.js';\r\nimport { windowSys, GUIWindow, OWOPDropDown, UtilDialog } from './windowsys.js';\r\n\r\nimport { createContextMenu } from './context.js';\r\n\r\nimport launchSoundUrl from '../audio/launch.mp3';\r\nimport placeSoundUrl from '../audio/place.mp3';\r\nimport clickSoundUrl from '../audio/click.mp3';\r\n\r\nexport { showDevChat, showPlayerList, statusMsg };\r\n\r\nexport const keysDown = {};\r\n\r\nexport const mouse = {\r\n\tx: 0, /* pageX */\r\n\ty: 0, /* pageY */\r\n\tlastX: 0,\r\n\tlastY: 0,\r\n\tget worldX() { return camera.x * 16 + this.x / (camera.zoom / 16); },\r\n\tget worldY() { return camera.y * 16 + this.y / (camera.zoom / 16); },\r\n\tmouseDownWorldX: 0,\r\n\tmouseDownWorldY: 0,\r\n\tget tileX() { return Math.floor(this.worldX / 16); },\r\n\tget tileY() { return Math.floor(this.worldY / 16); },\r\n\tbuttons: 0,\r\n\tvalidTile: false,\r\n\tinsideViewport: false,\r\n\ttouches: [],\r\n\tcancelMouseDown: function () { this.buttons = 0; }\r\n};\r\n\r\nexport const elements = {\r\n\tviewport: null,\r\n\txyDisplay: null,\r\n\tchatInput: null,\r\n\tchat: null,\r\n\tdevChat: null\r\n};\r\n\r\nexport const misc = {\r\n\tlocalStorage: storageEnabled() && window.localStorage,\r\n\t_world: null,\r\n\tlastXYDisplay: [-1, -1],\r\n\tdevRecvReader: msg => {},\r\n\tchatPostFormatRecvModifier: msg => msg,\r\n\tchatRecvModifier: msg => msg,\r\n\tchatSendModifier: msg => msg,\r\n\texceptionTimeout: null,\r\n\tworldPasswords: {},\r\n\ttick: 0,\r\n\turlWorldName: null,\r\n\tconnecting: false,\r\n\ttickInterval: null,\r\n\tlastMessage: null,\r\n\tlastCleanup: 0,\r\n\tset world(value) {\r\n\t\t/* The reason this is done is because the old functions may reference the old world object */\r\n\t\tPublicAPI.world = getNewWorldApi();\r\n\t\treturn this._world = value;\r\n\t},\r\n\tget world() { return this._world; },\r\n\tguiShown: false,\r\n\tcookiesEnabled: cookiesEnabled(),\r\n\tstorageEnabled: storageEnabled(),\r\n\tshowEUCookieNag: !options.noUi && cookiesEnabled() && getCookie(\"nagAccepted\") !== \"true\",\r\n\tusingFirefox: navigator.userAgent.indexOf(\"Firefox\") !== -1\r\n};\r\n\r\nexport const sounds = {\r\n\tplay: function (sound) {\r\n\t\tsound.currentTime = 0;\r\n\t\tif (options.enableSounds) {\r\n\t\t\tsound.play();\r\n\t\t}\r\n\t}\r\n};\r\nsounds.launch = new Audio();\r\nsounds.launch.src = launchSoundUrl;\r\nsounds.place = new Audio();\r\nsounds.place.src = placeSoundUrl;\r\nsounds.click = new Audio();\r\nsounds.click.src = clickSoundUrl;\r\n\r\nexport var playerList = {};\r\nexport var playerListTable = document.createElement(\"table\");\r\nexport var playerListWindow = new GUIWindow('Players', {closeable: true}, wdow => {\r\n\tvar tableHeader = document.createElement(\"tr\");\r\n\ttableHeader.innerHTML = \"<th>Id</th><th>X</th><th>Y</th>\";\r\n\tplayerListTable.appendChild(tableHeader);\r\n\twdow.container.appendChild(playerListTable);\r\n\twdow.container.id = \"player-list\";\r\n}).move(window.innerWidth - 240, 32);\r\n\r\nfunction getNewWorldApi() {\r\n\tvar obj = {\r\n\t\tget name() { return misc.world.name; }\r\n\t};\r\n\tvar defProp = function (prop) {\r\n\t\tObject.defineProperty(obj, prop, {\r\n\t\t\tget: function () { return misc.world && this['_' + prop] || (this['_' + prop] = misc.world[prop].bind(misc.world)); }\r\n\t\t});\r\n\t};\r\n\r\n\tdefProp('getPixel');\r\n\tdefProp('setPixel');\r\n\tdefProp('undo');\r\n\tdefProp('unloadFarChunks');\r\n\treturn obj;\r\n}\r\n\r\nfunction receiveMessage(text) {\r\n\tconsole.log(text);\r\n\ttext = misc.chatRecvModifier(text);\r\n\tif (!text) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar addContext = (elem, nickname, id) => {\r\n\t\telem.addEventListener(\"click\", function(event) {\r\n\t\t\tcreateContextMenu(event.clientX, event.clientY, [\r\n\t\t\t\t[\"Mute \" + nickname, function() {\r\n\t\t\t\t\tPublicAPI.muted.push(id);\r\n\t\t\t\t\treceiveMessage(\"<span style=\\\"color: #ffa71f\\\">Muted \" + id + \"</span>\");\r\n\t\t\t\t}]\r\n\t\t\t]);\r\n\t\t\tevent.stopPropagation();\r\n\t\t});\r\n\t};\r\n\r\n\tvar message = document.createElement(\"li\");\r\n\tvar realText = text;\r\n\tvar isAdmin = false;\r\n\tif (text.startsWith(\"[D]\")) {\r\n\t\tmessage.className = \"discord\";\r\n\t\tvar nick = document.createElement(\"span\");\r\n\t\tnick.className = \"nick\";\r\n\t\tvar nickname = text.split(\": \")[0] + \": \";\r\n\t\tnick.innerHTML = escapeHTML(nickname);\r\n\t\tmessage.appendChild(nick);\r\n\t\ttext = text.slice(nickname.length);\r\n\t} else if (text.startsWith(\"[Server]\") || text.startsWith(\"Server:\") || text.startsWith(\"Nickname set to\") || text.startsWith(\"User: \")) {\r\n\t\tmessage.className = \"server\";\r\n\t} else if (text.startsWith(\"->\")) {\r\n\t\tvar cuttxt = text.slice(3);\r\n\t\tvar id = parseInt(cuttxt);\r\n\t\tcuttxt = cuttxt.slice(id.toString().length);\r\n\t\tif (cuttxt.startsWith(\" tells you: \")) {\r\n\t\t\tif (PublicAPI.muted.includes(id)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar nick = document.createElement(\"span\");\r\n\t\t\tnick.className = \"tell\";\r\n\t\t\tnick.innerHTML = escapeHTML(`-> ${id} tells you: `);\r\n\t\t\taddContext(nick, id, id);\r\n\t\t\tmessage.appendChild(nick);\r\n\t\t\ttext = cuttxt.slice(12);\r\n\t\t} else {\r\n\t\t\tmessage.className = \"tell\";\r\n\t\t}\r\n\t} else if (text.startsWith(\"(M)\")) {\r\n\t\tmessage.className = \"moderator\";\r\n\t} else if (isNaN(text.split(\": \")[0]) && text.split(\": \")[0].charAt(0) != \"[\") {\r\n\t\tmessage.className = \"admin\";\r\n\t\tisAdmin = true;\r\n\t} else {\r\n\t\tvar nick = document.createElement(\"span\");\r\n\t\tnick.className = \"nick\";\r\n\t\tvar nickname = text.split(\": \")[0];\r\n\t\tvar id = nickname.startsWith(\"[\") ? nickname.split(\" \")[0].slice(1, -1) : nickname;\r\n\t\tid = parseInt(id);\r\n\t\tif (PublicAPI.muted.includes(id)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnick.innerHTML = escapeHTML(nickname + \": \");\r\n\t\tnick.addEventListener(\"click\", function(event) {\r\n\t\t\tcreateContextMenu(event.clientX, event.clientY, [\r\n\t\t\t\t[\"Mute \" + nickname, function() {\r\n\t\t\t\t\tPublicAPI.muted.push(id);\r\n\t\t\t\t\treceiveMessage(\"<span style=\\\"color: #ffa71f\\\">Muted \" + id + \"</span>\");\r\n\t\t\t\t}]\r\n\t\t\t]);\r\n\t\t\tevent.stopPropagation();\r\n\t\t});\r\n\t\tmessage.appendChild(nick);\r\n\t\ttext = text.slice(nickname.length + 2);\r\n\t}\r\n\tvar idIndex = text.indexOf(': '); /* This shouldn't be like this, change on proto switch */\r\n\tif (idIndex !== -1) {\r\n\t\tvar ntext = text.substr(0, idIndex);\r\n\t\trealText = ntext.replace(/\\d+/g, '') + text.slice(idIndex + 2);\r\n\t}\r\n\r\n\tif (misc.lastMessage && misc.lastMessage.text === realText) {\r\n\t\tmisc.lastMessage.incCount();\r\n\t} else {\r\n\t\tvar span = document.createElement(\"span\");\r\n\t\tmisc.lastMessage = {\r\n\t\t\tget text() { return realText; },\r\n\t\t\tincCount: () => {\r\n\t\t\t\tvar times = span.recvTimes || 1;\r\n\t\t\t\tspan.innerHTML = `${anchorme(text, {\r\n\t\t\t\t\tattributes: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"target\",\r\n\t\t\t\t\t\t\tvalue: \"blank\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t})} [x${++times}]`;\r\n\t\t\t\tspan.recvTimes = times;\r\n\t\t\t\tmessage.style.animation = 'none'; /* Reset fading anim */\r\n\t\t\t\tmessage.offsetHeight; /* Reflow */\r\n\t\t\t\tmessage.style.animation = null;\r\n\t\t\t}\r\n\t\t};\r\n\t\tif (!isAdmin) {\r\n\t\t\ttext = escapeHTML(text).replace(/\\&\\#x2F;/g, \"/\");\r\n\t\t}\r\n\t\ttext = text.replace(/(?:&lt;|<):(.+?):([0-9]+)(?:&gt;|>)/g, '<img class=\"emote\" title=\"$1\" src=\"https://cdn.discordapp.com/emojis/$2.png?v=1\">');\r\n\t\ttext = misc.chatPostFormatRecvModifier(text);\r\n\t\tspan.innerHTML = anchorme(text, {\r\n\t\t\tattributes: [\r\n\t\t\t\t{\r\n\t\t\t\t\tname: \"target\",\r\n\t\t\t\t\tvalue: \"blank\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t});\r\n\t\tmessage.appendChild(span);\r\n\t\tscrollChatToBottom(() => {\r\n\t\t\telements.chatMessages.appendChild(message);\r\n\t\t\tvar childs = elements.chatMessages.children;\r\n\t\t\tif (childs.length > options.maxChatBuffer) {\r\n\t\t\t\tchilds[0].remove();\r\n\t\t\t}\r\n\t\t}, true);\r\n\t}\r\n}\r\n\r\nfunction receiveDevMessage(text) {\r\n    try {\r\n        misc.devRecvReader(text);\r\n    } catch(e) {}\r\n\tvar message = document.createElement(\"li\");\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.innerHTML = text;\r\n\tmessage.appendChild(span);\r\n\telements.devChatMessages.appendChild(message);\r\n\telements.devChatMessages.scrollTop = elements.devChatMessages.scrollHeight;\r\n}\r\n\r\nfunction scrollChatToBottom(callback, dontScrollIfNotTop = false) {\r\n\tvar shouldScroll = !dontScrollIfNotTop || elements.chatMessages.scrollHeight - elements.chatMessages.scrollTop === elements.chatMessages.clientHeight;\r\n\tif (callback)\r\n\t\tcallback(); // add all elements here\r\n\tif (shouldScroll)\r\n\t\telements.chatMessages.scrollTop = elements.chatMessages.scrollHeight;\r\n}\r\n\r\nfunction clearChat() {\r\n\telements.chatMessages.innerHTML = \"\";\r\n\telements.devChatMessages.innerHTML = \"\";\r\n}\r\n\r\nfunction tick() {\r\n\tvar tickNum = ++misc.tick;\r\n\tvar speed = Math.max(Math.min(options.movementSpeed, 64), 0);\r\n\tvar offX = 0;\r\n\tvar offY = 0;\r\n\tif (keysDown[38]) { // Up\r\n\t\toffY -= speed;\r\n\t}\r\n\tif (keysDown[37]) { // Left\r\n\t\toffX -= speed;\r\n\t}\r\n\tif (keysDown[40]) { // Down\r\n\t\toffY += speed;\r\n\t}\r\n\tif (keysDown[39]) { // Right\r\n\t\toffX += speed;\r\n\t}\r\n\tif (offX !== 0 || offY !== 0) {\r\n\t\tmoveCameraBy(offX, offY);\r\n\t\tupdateMouse(null, 'mousemove', mouse.x, mouse.y);\r\n\t}\r\n\r\n\teventSys.emit(e.tick, tickNum);\r\n\tif (player.tool !== null && misc.world !== null) {\r\n\t\tplayer.tool.call('tick', mouse);\r\n\t}\r\n}\r\n\r\nfunction updateMouse(event, eventName, mouseX, mouseY) {\r\n\tmouse.x = mouseX;\r\n\tmouse.y = mouseY;\r\n\tvar cancelled = 0;\r\n\tif (misc.world !== null) {\r\n\t\tmouse.validTile = misc.world.validMousePos(mouse.tileX, mouse.tileY);\r\n\t\tif (player.tool !== null) {\r\n\t\t\tcancelled = player.tool.call(eventName, [mouse, event]);\r\n\t\t}\r\n\t\tif (updateXYDisplay(mouse.tileX, mouse.tileY)) {\r\n\t\t\tupdateClientFx();\r\n\t\t}\r\n\t}\r\n\treturn cancelled;\r\n}\r\n\r\nfunction openChat() {\r\n\telements.chat.className = \"active selectable\";\r\n\telements.devChat.className = \"active selectable\";\r\n\telements.chatMessages.className = \"active\";\r\n\tscrollChatToBottom();\r\n}\r\n\r\nfunction closeChat() {\r\n\telements.chat.className = \"\";\r\n\telements.devChat.className = \"\";\r\n\telements.chatMessages.className = \"\";\r\n\telements.chatInput.blur();\r\n\tscrollChatToBottom();\r\n}\r\n\r\nfunction showDevChat(bool) {\r\n\telements.devChat.style.display = bool ? \"\" : \"none\";\r\n}\r\n\r\nexport function revealSecrets(bool) {\r\n\tif (bool) {\r\n\t\tPublicAPI.net = net;\r\n\t} else {\r\n\t\tdelete PublicAPI.net;\r\n\t}\r\n}\r\n\r\nfunction showPlayerList(bool) {\r\n\tif (bool) {\r\n\t\twindowSys.addWindow(playerListWindow);\r\n\t} else {\r\n\t\twindowSys.delWindow(playerListWindow);\r\n\t}\r\n}\r\n\r\nfunction updateXYDisplay(x, y) {\r\n\tif (misc.lastXYDisplay[0] !== x || misc.lastXYDisplay[1] !== y) {\r\n\t\tmisc.lastXYDisplay = [x, y];\r\n\t\tif(!options.hexCoords) {\r\n\t\t\telements.xyDisplay.innerHTML = \"X: \" + x + \", Y: \" + y;\r\n\t\t} else {\r\n\t\t\telements.xyDisplay.innerHTML = \"X: 0x\" + x.toString(16) + \", Y: 0x\" + y.toString(16);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction updatePlayerCount() {\r\n\tvar text = ' cursor' + (misc.playerCount !== 1 ? 's online' : ' online');\r\n\tvar countStr = '' + misc.playerCount;\r\n\tif (misc.world && 'maxCount' in misc.world) {\r\n\t\tcountStr += '/' + misc.world.maxCount;\r\n\t}\r\n\r\n\tvar final = countStr + text;\r\n\telements.playerCountDisplay.innerHTML = final;\r\n\r\n\tvar title = 'World of Pixels';\r\n\tif (misc.world) {\r\n\t\ttitle = '(' + countStr + '/' + misc.world.name + ') ' + title;\r\n\t}\r\n\r\n\tdocument.title = title;\r\n}\r\n/*\r\nfunction openServerSelector() {\r\n\twindowsys.addWindow(new GUIWindow(0, 0, 250, 60, \"Select a server\", {\r\n\t\t\tcentered: true\r\n\t\t}, wdow => {\r\n\r\n\t\twdow.addObj(mkHTML(\"button\", {\r\n\t\t\tinnerHTML: \"Original server\",\r\n\t\t\tstyle: \"width: 100%; height: 50%\",\r\n\t\t\tonclick: () => {\r\n\t\t\t\tw.options.serverAddress = \"ws://ourworldofpixels.com:443\";\r\n\t\t\t\tw.net.connect();\r\n\t\t\t\twin.wm.delWindow(win);\r\n\t\t\t\tw.options.oldserver = true;\r\n\t\t\t}\r\n\t\t}));\r\n\t\twdow.addObj(mkHTML(\"button\", {\r\n\t\t\tinnerHTML: \"Beta server\",\r\n\t\t\tstyle: \"width: 100%; height: 50%\",\r\n\t\t\tonclick: () => {\r\n\t\t\t\tw.options.serverAddress = \"ws://vanillaplay.ddns.net:25565\";\r\n\t\t\t\tw.net.connect();\r\n\t\t\t\twin.wm.delWindow(win);\r\n\t\t\t}\r\n\t\t}));\r\n\t\twdow.addObj(mkHTML(\"button\", {\r\n\t\t\tinnerHTML: \"Localhost\",\r\n\t\t\tstyle: \"width: 100%; height: 50%\",\r\n\t\t\tonclick: () => {\r\n\t\t\t\tw.options.serverAddress = \"ws://localhost:25565\";\r\n\t\t\t\tw.net.connect();\r\n\t\t\t\twin.wm.delWindow(win);\r\n\t\t\t}\r\n\t\t}));\r\n\t\twdow.addObj(mkHTML(\"button\", {\r\n\t\t\tinnerHTML: \"Custom server\",\r\n\t\t\tstyle: \"width: 100%; height: 50%\",\r\n\t\t\tonclick: function() {\r\n\t\t\t\tvar i = win.wm.addWindow(\r\n\t\t\t\t\tnew UtilInput(\"Enter server address\", \"Type here...\", \"text\", function(addr) {\r\n\t\t\t\t\t\tw.options.serverAddress = addr;\r\n\t\t\t\t\t\tw.net.connect();\r\n\t\t\t\t\t\twin.close();\r\n\t\t\t\t\t}.bind({w: w, win: win}))\r\n\t\t\t\t);\r\n\t\t\t\twin.onclose = function() {\r\n\t\t\t\t\ti.getWindow().close();\r\n\t\t\t\t}\r\n\t\t\t}.bind({w: this, win: wdow})\r\n\t\t}));\r\n\t}));\r\n}\r\n*/\r\nfunction logoMakeRoom(bool) {\r\n\telements.loadUl.style.transform = bool ? \"translateY(-75%) scale(0.5)\" : \"\";\r\n}\r\n\r\nfunction showWorldUI(bool) {\r\n\tmisc.guiShown = bool;\r\n\telements.xyDisplay.style.transform = bool ? \"initial\" : \"\";\r\n\telements.playerCountDisplay.style.transform = bool ? \"initial\" : \"\";\r\n\telements.palette.style.transform = bool ? \"translateY(-50%)\" : \"\";\r\n\telements.chat.style.transform = bool ? \"initial\" : \"\";\r\n\telements.chatInput.disabled = !bool;\r\n\telements.chatInput.style.display = \"initial\";\r\n\telements.paletteBg.style.visibility = bool ? \"\" : \"hidden\";\r\n\telements.helpButton.style.visibility = bool ? \"\" : \"hidden\";\r\n}\r\n\r\nfunction showLoadScr(bool, showOptions) {\r\n\telements.loadOptions.className = showOptions ? \"framed\" : \"hide\";\r\n\tif (!bool) {\r\n\t\telements.loadScr.style.transform = \"translateY(-110%)\"; /* +10% for shadow */\r\n\t\teventOnce(elements.loadScr, \"transitionend webkitTransitionEnd oTransitionEnd msTransitionEnd\",\r\n\t\t() => {\r\n\t\t\tif (net.isConnected()) {\r\n\t\t\t\telements.loadScr.className = \"hide\";\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\telements.loadScr.className = \"\";\r\n\t\telements.loadScr.style.transform = \"\";\r\n\t}\r\n}\r\n\r\nfunction statusMsg(showSpinner, message) {\r\n\tconst statusShown = elements.status.isConnected;\r\n\tif (message === null) {\r\n\t\telements.status.style.display = \"none\";\r\n\t\treturn;\r\n\t} else {\r\n\t\telements.status.style.display = \"\";\r\n\t}\r\n\telements.statusMsg.innerHTML = message;\r\n\telements.spinner.style.display = showSpinner ? \"\" : \"none\";\r\n}\r\n\r\nfunction inGameDisconnected() {\r\n\tshowWorldUI(false);\r\n\tshowLoadScr(true, true);\r\n\tstatusMsg(false, \"Lost connection with the server.\");\r\n\tmisc.world = null;\r\n\telements.chat.style.transform = \"initial\";\r\n\telements.chatInput.style.display = \"\";\r\n}\r\n\r\nfunction retryingConnect(serverGetter, worldName) {\r\n\tif (misc.connecting && !net.isConnected()) { /* We're already connected/trying to connect */\r\n\t\treturn;\r\n\t}\r\n\tmisc.connecting = true;\r\n\tvar currentServer = serverGetter(false);\r\n\tconst tryConnect = (tryN) => {\r\n\t\tif (tryN >= (currentServer.maxRetries || 3)) {\r\n\t\t\tvar ncs = serverGetter(true);\r\n\t\t\tif (ncs != currentServer) {\r\n\t\t\t\tcurrentServer = ncs;\r\n\t\t\t\ttryN = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\teventSys.once(e.net.connecting, () => {\r\n\t\t\tconsole.debug(`Trying '${currentServer.title}'...`)\r\n\t\t\tstatusMsg(true, `Connecting to '${currentServer.title}'...`);\r\n\t\t\tshowLoadScr(true, false);\r\n\t\t});\r\n\t\tnet.connect(currentServer, worldName);\r\n\t\tconst disconnected = () => {\r\n\t\t\t++tryN;\r\n\t\t\tstatusMsg(true, `Couldn't connect to server, retrying... (${tryN})`);\r\n\t\t\tsetTimeout(tryConnect, Math.min(tryN * 2000, 10000), tryN);\r\n\t\t\teventSys.removeListener(e.net.connected, connected);\r\n\t\t};\r\n\t\tconst connected = () => {\r\n\t\t\tstatusMsg(false, \"Connected!\");\r\n\t\t\teventSys.removeListener(e.net.disconnected, disconnected);\r\n\t\t\teventSys.once(e.net.disconnected, inGameDisconnected);\r\n\t\t\tmisc.connecting = false;\r\n\t\t};\r\n\r\n\t\teventSys.once(e.net.connected, connected);\r\n\t\teventSys.once(e.net.disconnected, disconnected);\r\n\t};\r\n\ttryConnect(0);\r\n}\r\n\r\nfunction saveWorldPasswords() {\r\n\tif (misc.storageEnabled) {\r\n\t\tmisc.localStorage.worldPasswords = JSON.stringify(misc.worldPasswords);\r\n\t}\r\n}\r\n\r\nfunction checkFunctionality(callback) {\r\n\t/* Multi Browser Support */\r\n\twindow.requestAnimationFrame =\r\n\t\twindow.requestAnimationFrame ||\r\n\t\twindow.mozRequestAnimationFrame ||\r\n\t\twindow.webkitRequestAnimationFrame ||\r\n\t\twindow.msRequestAnimationFrame ||\r\n\t\tfunction (f) {\r\n\t\t\tsetTimeout(f, 1000 / options.fallbackFps);\r\n\t\t};\r\n\r\n\tNumber.isInteger = Number.isInteger || (n => Math.floor(n) === n && Math.abs(n) !== Infinity);\r\n\tMath.trunc = Math.trunc || (n => n | 0);\r\n\r\n\tvar toBlob = HTMLCanvasElement.prototype.toBlob = HTMLCanvasElement.prototype.toBlob || HTMLCanvasElement.prototype.msToBlob;\r\n\r\n\tif (!toBlob) { /* Load toBlob polyfill */\r\n\t\tloadScript(require('./polyfill/canvas-toBlob.js'), callback);\r\n\t} else {\r\n\t\tcallback();\r\n\t}\r\n}\r\n\r\nfunction init() {\r\n\tvar viewport = elements.viewport;\r\n\tvar chatinput = elements.chatInput;\r\n\r\n\tif (misc.storageEnabled && misc.localStorage.worldPasswords) {\r\n\t\ttry {\r\n\t\t\tmisc.worldPasswords = JSON.parse(misc.localStorage.worldPasswords);\r\n\t\t} catch (e) { }\r\n\t}\r\n\r\n\tmisc.lastCleanup = 0;\r\n\r\n\tviewport.oncontextmenu = () => false;\r\n\r\n\tviewport.addEventListener(\"mouseenter\", () => {\r\n\t\tmouse.insideViewport = true;\r\n\t\tupdateClientFx();\r\n\t});\r\n\tviewport.addEventListener(\"mouseleave\", () => {\r\n\t\tmouse.insideViewport = false;\r\n\t\tupdateClientFx();\r\n\t});\r\n\r\n\tvar chatHistory = [];\r\n\tvar historyIndex = 0;\r\n\tchatinput.addEventListener(\"keydown\", event => {\r\n\t\tevent.stopPropagation();\r\n\t\tvar keyCode = event.which || event.keyCode;\r\n\t\tif (historyIndex === 0 || keyCode == 13 && !event.shiftKey) {\r\n\t\t\tchatHistory[0] = chatinput.value;\r\n\t\t}\r\n\t\tswitch (keyCode) {\r\n\t\t\tcase 27:\r\n\t\t\t\tcloseChat();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 13:\r\n\t\t\t\tif (!event.shiftKey) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tvar text = chatinput.value;\r\n\t\t\t\t\thistoryIndex = 0;\r\n\t\t\t\t\tchatHistory.unshift(text);\r\n\t\t\t\t\tif (misc.storageEnabled) {\r\n\t\t\t\t\t\tif (text.startsWith(\"/adminlogin \")) {\r\n\t\t\t\t\t\t\tmisc.localStorage.adminlogin = text.slice(12);\r\n\t\t\t\t\t\t} else if (text.startsWith(\"/modlogin \")) {\r\n\t\t\t\t\t\t\tmisc.localStorage.modlogin = text.slice(10);\r\n\t\t\t\t\t\t} else if (text.startsWith(\"/nick\")) {\r\n\t\t\t\t\t\t\tvar nick = text.slice(6);\r\n\t\t\t\t\t\t\tif (nick.length) {\r\n\t\t\t\t\t\t\t\tmisc.localStorage.nick = nick;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdelete misc.localStorage.nick;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (text.startsWith(\"/pass \") && misc.world) {\r\n\t\t\t\t\t\t\tvar pass = text.slice(6);\r\n\t\t\t\t\t\t\tmisc.worldPasswords[net.protocol.worldName] = pass;\r\n\t\t\t\t\t\t\tsaveWorldPasswords();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!event.ctrlKey) {\r\n\t\t\t\t\t\ttext = misc.chatSendModifier(text);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnet.protocol.sendMessage(text);\r\n\t\t\t\t\tchatinput.value = '';\r\n\t\t\t\t\tchatinput.style.height = \"16px\";\r\n\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 38: // Arrow up\r\n\t\t\t\tif (event.shiftKey && historyIndex < chatHistory.length - 1) {\r\n\t\t\t\t\thistoryIndex++;\r\n\t\t\t\t\tchatinput.value = chatHistory[historyIndex];\r\n\t\t\t\t\tchatinput.style.height = 0;\r\n\t\t\t\t\tchatinput.style.height = Math.min(chatinput.scrollHeight - 8, 16 * 4) + \"px\";\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 40: // Arrow Down\r\n\t\t\t\tif (event.shiftKey && historyIndex > 0) {\r\n\t\t\t\t\thistoryIndex--;\r\n\t\t\t\t\tchatinput.value = chatHistory[historyIndex];\r\n\t\t\t\t\tchatinput.style.height = 0;\r\n\t\t\t\t\tchatinput.style.height = Math.min(chatinput.scrollHeight - 8, 16 * 4) + \"px\";\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t});\r\n\tchatinput.addEventListener(\"keyup\", event => {\r\n\t\tevent.stopPropagation();\r\n\t\tvar keyCode = event.which || event.keyCode;\r\n\t\tif (keyCode == 13 && !event.shiftKey) {\r\n\t\t\tcloseChat();\r\n\t\t}\r\n\t})\r\n\tchatinput.addEventListener(\"input\", event => {\r\n\t\tchatinput.style.height = 0;\r\n\t\tchatinput.style.height = Math.min(chatinput.scrollHeight - 8, 16 * 4) + \"px\";\r\n\t});\r\n\tchatinput.addEventListener(\"focus\", event => {\r\n\t\tif (!mouse.buttons) {\r\n\t\t\topenChat();\r\n\t\t} else {\r\n\t\t\tchatinput.blur();\r\n\t\t}\r\n\t});\r\n\r\n\twindow.addEventListener(\"keydown\", event => {\r\n\t\tvar keyCode = event.which || event.keyCode;\r\n\t\tif (document.activeElement.tagName !== \"INPUT\" && misc.world !== null) {\r\n\t\t\tkeysDown[keyCode] = true;\r\n\t\t\tvar tool = player.tool;\r\n\t\t\tif (tool !== null && misc.world !== null && tool.isEventDefined('keydown')) {\r\n\t\t\t\tif (tool.call('keydown', [keysDown, event])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tswitch (keyCode) {\r\n\t\t\t\tcase 80: /* P */\r\n\t\t\t\t\tplayer.tool = \"pipette\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 79: /* O */\r\n\t\t\t\t\tplayer.tool = \"cursor\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 77: /* M */\r\n\t\t\t\tcase 16: /* Shift */\r\n\t\t\t\t\tplayer.tool = \"move\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 90: /* Ctrl + Z */\r\n\t\t\t\t\tif (!event.ctrlKey || !misc.world) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmisc.world.undo(event.shiftKey);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 70: /* F */\r\n\t\t\t\t\tvar parseClr = clr => {\r\n\t\t\t\t\t\tvar tmp = clr.split(',');\r\n\t\t\t\t\t\tvar nrgb = null;\r\n\t\t\t\t\t\tif (tmp.length == 3) {\r\n\t\t\t\t\t\t\tnrgb = tmp;\r\n\t\t\t\t\t\t\tfor (var i = 0; i < tmp.length; i++) {\r\n\t\t\t\t\t\t\t\ttmp[i] = +tmp[i];\r\n\t\t\t\t\t\t\t\tif (!(tmp[i] >= 0 && tmp[i] < 256)) {\r\n\t\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (clr[0] == '#' && clr.length == 7) {\r\n\t\t\t\t\t\t\tvar colr = parseInt(clr.replace('#', '0x'));\r\n\t\t\t\t\t\t\t/* The parsed HTML color doesn't have red as the first byte, so invert it. */\r\n\t\t\t\t\t\t\tnrgb = [colr >> 16 & 0xFF, colr >> 8 & 0xFF, colr & 0xFF];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn nrgb;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar input = prompt(\"Custom color\\nType three values separated by a comma: r,g,b\\n(...or the hex string: #RRGGBB)\\nYou can add multiple colors at a time separating them with a space.\");\r\n\t\t\t\t\tif (!input) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tinput = input.split(' ');\r\n\t\t\t\t\tfor (var j = 0; j < input.length; j++) {\r\n\t\t\t\t\t\tvar rgb = parseClr(input[j]);\r\n\t\t\t\t\t\tif (rgb) {\r\n\t\t\t\t\t\t\tplayer.selectedColor = rgb;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 71: /* G */\r\n\t\t\t\t\trenderer.showGrid(!renderer.gridShown);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 112: /* F1 */\r\n\t\t\t\t\tshowWorldUI(!misc.guiShown);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 107:\r\n\t\t\t\tcase 187:\r\n\t\t\t\t\t++camera.zoom;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 109:\r\n\t\t\t\tcase 189:\r\n\t\t\t\t\t--camera.zoom;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t});\r\n\twindow.addEventListener(\"keyup\", event => {\r\n\t\tvar keyCode = event.which || event.keyCode;\r\n\t\tdelete keysDown[keyCode];\r\n\t\tif (document.activeElement.tagName !== \"INPUT\") {\r\n\t\t\tvar tool = player.tool;\r\n\t\t\tif (tool !== null && misc.world !== null && tool.isEventDefined('keyup')) {\r\n\t\t\t\tif (tool.call('keyup', [keysDown, event])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (keyCode == 13) {\r\n\t\t\t\telements.chatInput.focus();\r\n\t\t\t} else if (keyCode == 16) {\r\n\t\t\t\tplayer.tool = \"cursor\";\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\tviewport.addEventListener(\"mousedown\", event => {\r\n\t\tcloseChat();\r\n\t\tmouse.lastX = mouse.x;\r\n\t\tmouse.lastY = mouse.y;\r\n\t\tmouse.x = event.pageX;\r\n\t\tmouse.y = event.pageY;\r\n\t\tmouse.mouseDownWorldX = mouse.worldX;\r\n\t\tmouse.mouseDownWorldY = mouse.worldY;\r\n\t\tif ('buttons' in event) {\r\n\t\t\tmouse.buttons = event.buttons;\r\n\t\t} else {\r\n\t\t\tvar realBtn = event.button;\r\n\t\t\tif (realBtn === 2) {\r\n\t\t\t\trealBtn = 1;\r\n\t\t\t} else if (realBtn === 1) {\r\n\t\t\t\trealBtn = 2;\r\n\t\t\t}\r\n\t\t\tmouse.buttons |= 1 << realBtn;\r\n\t\t}\r\n\r\n\t\tvar tool = player.tool;\r\n\t\tif (tool !== null && misc.world !== null) {\r\n\t\t\tplayer.tool.call('mousedown', [mouse, event]);\r\n\t\t}\r\n\t});\r\n\r\n\twindow.addEventListener(\"mouseup\", event => {\r\n\t\t/* Old versions of firefox have the buttons property as the\r\n\t\t * buttons released, instead of the currently pressed buttons.\r\n\t\t **/\r\n\t\tif ('buttons' in event && !misc.usingFirefox) {\r\n\t\t\tmouse.buttons = event.buttons;\r\n\t\t} else {\r\n\t\t\tvar realBtn = event.button;\r\n\t\t\tif (realBtn === 2) {\r\n\t\t\t\trealBtn = 1;\r\n\t\t\t} else if (realBtn === 1) {\r\n\t\t\t\trealBtn = 2;\r\n\t\t\t}\r\n\t\t\tmouse.buttons &= ~(1 << realBtn);\r\n\t\t}\r\n\t\tvar tool = player.tool;\r\n\t\tif (tool !== null && misc.world !== null) {\r\n\t\t\tplayer.tool.call('mouseup', [mouse, event]);\r\n\t\t}\r\n\t});\r\n\r\n\twindow.addEventListener(\"mousemove\", event => {\r\n\t\tvar cancelledButtons = updateMouse(event, 'mousemove', event.pageX, event.pageY);\r\n\t\tvar remainingButtons = mouse.buttons & ~cancelledButtons;\r\n\t\tif (remainingButtons & 0b100) { /* If middle click was not used for anything */\r\n\t\t\tmoveCameraBy((mouse.mouseDownWorldX - mouse.worldX) / 16, (mouse.mouseDownWorldY - mouse.worldY) / 16);\r\n\t\t}\r\n\t});\r\n\r\n\tconst mousewheel = event => {\r\n\t\tconst nevt = normalizeWheel(event);\r\n\t\tif (player.tool !== null && misc.world !== null && player.tool.isEventDefined('scroll')) {\r\n\t\t\tif (player.tool.call('scroll', [mouse, nevt, event])) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (event.ctrlKey) {\r\n\t\t\tcamera.zoom += Math.max(-1, Math.min(1, -nevt.pixelY));\r\n\t\t\t//-nevt.spinY * camera.zoom / options.zoomLimitMax; // <- needs to be nicer\r\n\t\t} else {\r\n\t\t\tvar delta = Math.max(-1, Math.min(1, nevt.spinY));\r\n\t\t\tvar pIndex = player.paletteIndex;\r\n\t\t\tif (delta > 0) {\r\n\t\t\t\tpIndex++;\r\n\t\t\t} else if (delta < 0) {\r\n\t\t\t\tpIndex--;\r\n\t\t\t}\r\n\t\t\tplayer.paletteIndex = pIndex;\r\n\t\t}\r\n\t};\r\n\r\n\tvar wheelEventName = ('onwheel' in document) ? 'wheel' : ('onmousewheel' in document) ? 'mousewheel' : 'DOMMouseScroll';\r\n\r\n\tviewport.addEventListener(wheelEventName, mousewheel, { passive: true });\r\n\tviewport.addEventListener(wheelEventName, e => {\r\n\t\te.preventDefault();\r\n\t\treturn false;\r\n\t}, { passive: false });\r\n\r\n\t// Touch support\r\n\tconst touchEventNoUpdate = evtName => event => {\r\n\t\tvar tool = player.tool;\r\n\t\tmouse.buttons = 0;\r\n\t\tif (tool !== null && misc.world !== null) {\r\n\t\t\tplayer.tool.call(evtName, [mouse, event]);\r\n\t\t}\r\n\t};\r\n\tviewport.addEventListener(\"touchstart\", event => {\r\n\t\tvar moved = event.changedTouches[0];\r\n\t\tmouse.buttons = 1;\r\n\t\tif (moved) {\r\n\t\t\tupdateMouse(event, 'touchstart', moved.pageX, moved.pageY);\r\n\t\t\tmouse.mouseDownWorldX = mouse.worldX;\r\n\t\t\tmouse.mouseDownWorldY = mouse.worldY;\r\n\t\t}\r\n\t}, { passive: true });\r\n\tviewport.addEventListener(\"touchmove\", event => {\r\n\t\tvar moved = event.changedTouches[0];\r\n\t\tif (moved) {\r\n\t\t\tupdateMouse(event, 'touchmove', moved.pageX, moved.pageY);\r\n\t\t}\r\n\t}, { passive: true });\r\n\tviewport.addEventListener(\"touchend\", touchEventNoUpdate('touchend'), { passive: true });\r\n\tviewport.addEventListener(\"touchcancel\", touchEventNoUpdate('touchcancel'), { passive: true });\r\n\r\n\telements.soundToggle.addEventListener('change', e => {\r\n\t\toptions.enableSounds = !elements.soundToggle.checked;\r\n\t});\r\n\toptions.enableSounds = !elements.soundToggle.checked;\r\n\t\r\n\telements.hexToggle.addEventListener('change', e => {\r\n\t\toptions.hexCoords = elements.hexToggle.checked;\r\n\t});\r\n\toptions.hexCoords = elements.hexToggle.checked;\r\n\r\n\t// Some cool custom css\r\n\tconsole.log(\"%c\" +\r\n\t\t\" _ _ _         _   _    _____ ___    _____ _         _     \\n\" +\r\n\t\t\"| | | |___ ___| |_| |  |     |  _|  |  _  |_|_ _ ___| |___ \\n\" +\r\n\t\t\"| | | | . |  _| | . |  |  |  |  _|  |   __| |_'_| -_| |_ -|\\n\" +\r\n\t\t\"|_____|___|_| |_|___|  |_____|_|    |__|  |_|_,_|___|_|___|\",\r\n\t\t\"font-size: 15px; font-weight: bold;\"\r\n\t);\r\n\tconsole.log(\"%cWelcome to the developer console!\", \"font-size: 20px; font-weight: bold; color: #F0F;\");\r\n\r\n\t//windowSys.addWindow(new OWOPDropDown());\r\n\tresolveProtocols();\r\n\r\n\t/* Calls other initialization functions */\r\n\teventSys.emit(e.init);\r\n\r\n\tupdateXYDisplay(0, 0);\r\n\tlet netlify = window.location.href.includes(\"netlify.com\")\r\n\tif(netlify) {\r\n\t\twindow.onhashchange = () => {\r\n\t\t\twindow.location.reload(false)\r\n\t\t}\r\n\t}\r\n\r\n\tvar worldName = netlify ? window.location.hash : decodeURIComponent(window.location.pathname);\r\n\tif (worldName[0] === '/' || worldName[0] === '#') {\r\n\t\tworldName = worldName.slice(1);\r\n\t}\r\n\r\n\tmisc.urlWorldName = worldName;\r\n}\r\n\r\nfunction connect() {\r\n\tconst serverGetter = (serverList => {\r\n\t\tvar defaults = [];\r\n\t\tvar availableServers = [];\r\n\t\tfor (var i = 0; i < serverList.length; i++) {\r\n\t\t\tif (serverList[i].default) {\r\n\t\t\t\tdefaults.push(serverList[i]);\r\n\t\t\t}\r\n\t\t\tavailableServers.push(serverList[i]);\r\n\t\t}\r\n\t\tvar index = 0;\r\n\t\treturn (next) => {\r\n\t\t\tif (next) {\r\n\t\t\t\tif (defaults.length) {\r\n\t\t\t\t\tdefaults.shift();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t++index;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (defaults.length) {\r\n\t\t\t\tvar sv = defaults[0];\r\n\t\t\t\tavailableServers.push(sv);\r\n\t\t\t\treturn sv;\r\n\t\t\t}\r\n\t\t\treturn availableServers[index % availableServers.length];\r\n\t\t};\r\n\t})(options.serverAddress);\r\n\r\n\tretryingConnect(serverGetter, misc.urlWorldName);\r\n\r\n\telements.reconnectBtn.onclick = () => retryingConnect(serverGetter, misc.urlWorldName);\r\n\r\n\tmisc.tickInterval = setInterval(tick, 1000 / options.tickSpeed);\r\n\t//delete window.localStorage;\r\n}\r\n\r\neventSys.once(e.loaded, () => statusMsg(true, \"Initializing...\"));\r\neventSys.once(e.misc.loadingCaptcha, () => statusMsg(true, \"Trying to load captcha...\"));\r\neventSys.once(e.misc.logoMakeRoom, () => {\r\n\tstatusMsg(false, null);\r\n\tlogoMakeRoom();\r\n});\r\n\r\neventSys.once(e.loaded, function() {\r\n\tinit();\r\n\tif (misc.showEUCookieNag) {\r\n\t\twindowSys.addWindow(new UtilDialog('Cookie notice',\r\n`This box alerts you that we're going to use cookies!\r\nIf you don't accept their usage, disable cookies and reload the page.`, false, () => {\r\n\t\t\tsetCookie('nagAccepted', 'true');\r\n\t\t\tmisc.showEUCookieNag = false;\r\n\t\t\tlogoMakeRoom(false);\r\n\t\t\tconnect();\r\n\t\t}));\r\n\t} else {\r\n\t\tconnect();\r\n\t}\r\n});\r\n\r\neventSys.on(e.net.maxCount, count => {\r\n\tmisc.world.maxCount = count;\r\n\tupdatePlayerCount();\r\n});\r\n\r\neventSys.on(e.net.playerCount, count => {\r\n\tmisc.playerCount = count;\r\n\tupdatePlayerCount();\r\n});\r\n\r\neventSys.on(e.net.chat, receiveMessage);\r\neventSys.on(e.net.devChat, receiveDevMessage);\r\n\r\neventSys.on(e.net.world.setId, id => {\r\n\tif (!misc.storageEnabled) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tfunction autoNick() {\r\n\t\tif (misc.localStorage.nick) {\r\n\t\t\tnet.protocol.sendMessage(\"/nick \" + misc.localStorage.nick);\r\n\t\t}\r\n\t}\r\n\r\n\t// Automatic login\r\n\tlet desiredRank = misc.localStorage.adminlogin ? RANK.ADMIN : misc.localStorage.modlogin ? RANK.MODERATOR : net.protocol.worldName in misc.worldPasswords ? RANK.USER : RANK.NONE;\r\n\tif (desiredRank > RANK.NONE) {\r\n\t\tvar mightBeMod = false;\r\n\t\tlet onWrong = function () {\r\n\t\t\tconsole.log(\"WRONG\");\r\n\t\t\teventSys.removeListener(e.net.sec.rank, onCorrect);\r\n\t\t\tif (desiredRank == RANK.ADMIN) {\r\n\t\t\t\tdelete misc.localStorage.adminlogin;\r\n\t\t\t} else if (desiredRank == RANK.MODERATOR) {\r\n\t\t\t\tdelete misc.localStorage.modlogin;\r\n\t\t\t} else if (desiredRank == RANK.USER) {\r\n\t\t\t\tdelete misc.worldPasswords[net.protocol.worldName];\r\n\t\t\t\tsaveWorldPasswords();\r\n\t\t\t}\r\n\t\t\tretryingConnect(() => net.currentServer, net.protocol.worldName)\r\n\t\t};\r\n\t\tlet onCorrect = function (newrank) {\r\n\t\t\tif (newrank == desiredRank || (mightBeMod && newrank == RANK.MODERATOR)) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t/* Ugly fix for wrong password on worlds without one */\r\n\t\t\t\t\teventSys.removeListener(e.net.disconnected, onWrong);\r\n\t\t\t\t}, 1000);\r\n\t\t\t\teventSys.removeListener(e.net.sec.rank, onCorrect);\r\n\t\t\t\tautoNick();\r\n\t\t\t}\r\n\t\t};\r\n\t\teventSys.once(e.net.disconnected, onWrong);\r\n\t\teventSys.on(e.net.sec.rank, onCorrect);\r\n\t\tvar msg;\r\n\t\tif (desiredRank == RANK.ADMIN) {\r\n\t\t\tmsg = \"/adminlogin \" + misc.localStorage.adminlogin;\r\n\t\t} else if (desiredRank == RANK.MODERATOR) {\r\n\t\t\tmsg = \"/modlogin \" + misc.localStorage.modlogin;\r\n\t\t} else if (desiredRank == RANK.USER) {\r\n\t\t\tmsg = \"/pass \" + misc.worldPasswords[net.protocol.worldName];\r\n\t\t\tmightBeMod = true;\r\n\t\t}\r\n\t\tnet.protocol.sendMessage(msg);\r\n\t} else {\r\n\t\tautoNick();\r\n\t}\r\n});\r\n\r\neventSys.on(e.misc.windowAdded, window => {\r\n\tif (misc.world === null) {\r\n\t\tstatusMsg(false, null);\r\n\t\tlogoMakeRoom(true);\r\n\t}\r\n});\r\n\r\neventSys.on(e.net.world.joining, name => {\r\n\tlogoMakeRoom(false);\r\n\tconsole.log(`Joining world: ${name}`);\r\n});\r\n\r\neventSys.on(e.net.world.join, world => {\r\n\tshowLoadScr(false, false);\r\n\tshowWorldUI(!options.noUi);\r\n\trenderer.showGrid(!options.noUi);\r\n\tsounds.play(sounds.launch);\r\n\tmisc.world = new World(world);\r\n\teventSys.emit(e.misc.worldInitialized);\r\n});\r\n\r\neventSys.on(e.net.connected, () => {\r\n\tclearChat();\r\n});\r\n\r\neventSys.on(e.camera.moved, camera => {\r\n\tvar time = getTime();\r\n\tif (misc.world !== null && time - misc.lastCleanup > 1000) {\r\n\t\tmisc.lastCleanup = time;\r\n\t\trenderer.unloadFarClusters();\r\n\t}\r\n\tif (updateXYDisplay(mouse.tileX, mouse.tileY)) {\r\n\t\tupdateClientFx();\r\n\t}\r\n});\r\n\r\neventSys.on(e.camera.zoom, camera => {\r\n\tif (updateXYDisplay(mouse.tileX, mouse.tileY)) {\r\n\t\tupdateClientFx();\r\n\t}\r\n});\r\n\r\nwindow.addEventListener(\"error\", e => {\r\n\tshowDevChat(true);\r\n\tvar errmsg = e && e.error ? (e.error.message || e.error.stack) : e.message || \"Unknown error occurred\";\r\n\terrmsg = escapeHTML(errmsg);\r\n\terrmsg = errmsg.split('\\n');\r\n\tfor (var i = 0; i < errmsg.length; i++) {\r\n\t\t/* Should be some kind of dissapearing notification instead */\r\n\t\treceiveDevMessage(errmsg[i]);\r\n\t}\r\n\tif (player.rank !== RANK.ADMIN) { /* TODO */\r\n\t\tif (misc.exceptionTimeout) {\r\n\t\t\tclearTimeout(misc.exceptionTimeout);\r\n\t\t}\r\n\t\tmisc.exceptionTimeout = setTimeout(() => showDevChat(false), 5000);\r\n\t}\r\n});\r\n\r\nwindow.addEventListener(\"load\", () => {\r\n\telements.loadScr = document.getElementById(\"load-scr\");\r\n\telements.loadUl = document.getElementById(\"load-ul\");\r\n\telements.loadOptions = document.getElementById(\"load-options\");\r\n\telements.reconnectBtn = document.getElementById(\"reconnect-btn\");\r\n\telements.spinner = document.getElementById(\"spinner\");\r\n\telements.statusMsg = document.getElementById(\"status-msg\");\r\n\telements.status = document.getElementById(\"status\");\r\n\telements.logo = document.getElementById(\"logo\");\r\n\r\n\telements.xyDisplay = document.getElementById(\"xy-display\");\r\n\telements.devChat = document.getElementById(\"dev-chat\");\r\n\telements.chat = document.getElementById(\"chat\");\r\n\telements.devChatMessages = document.getElementById(\"dev-chat-messages\");\r\n\telements.chatMessages = document.getElementById(\"chat-messages\");\r\n\telements.playerCountDisplay = document.getElementById(\"playercount-display\");\r\n\r\n\telements.palette = document.getElementById(\"palette\");\r\n\telements.paletteColors = document.getElementById(\"palette-colors\");\r\n\telements.paletteCreate = document.getElementById(\"palette-create\");\r\n\telements.paletteInput = document.getElementById(\"palette-input\");\r\n\telements.paletteBg = document.getElementById(\"palette-bg\");\r\n\r\n\telements.animCanvas = document.getElementById(\"animations\");\r\n\r\n\telements.viewport = document.getElementById(\"viewport\");\r\n\telements.windows = document.getElementById(\"windows\");\r\n\r\n\telements.chatInput = document.getElementById(\"chat-input\");\r\n\r\n\telements.soundToggle = document.getElementById(\"no-sound\");\r\n\telements.hexToggle = document.getElementById(\"hex-coords\");\r\n\r\n\telements.helpButton = document.getElementById(\"help-button\");\r\n\r\n\telements.helpButton.addEventListener(\"click\", function () {\r\n\t\tdocument.getElementById(\"help\").className = \"\";\r\n\t});\r\n\r\n\tdocument.getElementById(\"help-close\").addEventListener(\"click\", function () {\r\n\t\tdocument.getElementById(\"help\").className = \"hidden\";\r\n\t});\r\n\r\n\tcheckFunctionality(() => eventSys.emit(e.loaded));\r\n});\r\n\r\n/* Public API definitions */\r\nPublicAPI.emit = eventSys.emit.bind(eventSys);\r\nPublicAPI.on = eventSys.on.bind(eventSys);\r\nPublicAPI.once = eventSys.once.bind(eventSys);\r\nPublicAPI.removeListener = eventSys.removeListener.bind(eventSys);\r\nPublicAPI.elements = elements;\r\nPublicAPI.mouse = mouse;\r\nPublicAPI.world = getNewWorldApi();\r\nPublicAPI.chat = {\r\n\tsend: (msg) => net.protocol && net.protocol.sendMessage(msg),\r\n\tclear: clearChat,\r\n\tlocal: receiveMessage,\r\n\tget onDevMsg() { return misc.devRecvReader; },\r\n\tset onDevMsg(fn) { misc.devRecvReader = fn; },\r\n\tget postFormatRecvModifier() { return misc.chatPostFormatRecvModifier; },\r\n\tset postFormatRecvModifier(fn) { misc.chatPostFormatRecvModifier = fn; },\r\n\tget recvModifier() { return misc.chatRecvModifier; },\r\n\tset recvModifier(fn) { misc.chatRecvModifier = fn; },\r\n\tget sendModifier() { return misc.chatSendModifier; },\r\n\tset sendModifier(fn) { misc.chatSendModifier = fn; }\r\n};\r\nPublicAPI.sounds = sounds;\r\nPublicAPI.poke = () => {\r\n\tif (net.protocol) {\r\n\t\tnet.protocol.lastSentX = Infinity;\r\n\t}\r\n};\r\nPublicAPI.muted = [];\r\nPublicAPI.require = function(name) {\r\n\tif (name === \"events\") {\r\n\t\treturn require(\"events\");\r\n\t}\r\n\treturn require(`./${name}`);\r\n}","'use strict';\r\nimport { EVENTS as e, protocol } from './conf.js';\r\nimport { eventSys, PublicAPI } from './global.js';\r\n\r\nexport const net = {\r\n\tcurrentServer: null,\r\n\tprotocol: null,\r\n\tisConnected: isConnected,\r\n\tconnect: connect\r\n};\r\n\r\n//PublicAPI.net = net;\r\n\r\nfunction isConnected() {\r\n\treturn net.protocol !== null && net.protocol.isConnected();\r\n}\r\n\r\nfunction connect(server, worldName) {\r\n\teventSys.emit(e.net.connecting, server);\r\n\tnet.connection = new WebSocket(server.url);\r\n\tnet.connection.binaryType = \"arraybuffer\";\r\n\tnet.currentServer = server;\r\n\tnet.protocol = new server.proto.class(net.connection, worldName);\r\n}\r\n","module.exports = __webpack_public_path__ + \"polyfill/canvas-toBlob.js\";","'use strict';\nimport { EVENTS as e } from './../conf.js';\nimport { eventSys } from './../global.js';\n\nexport class Protocol {\n    constructor(ws) {\n        this.ws = ws;\n    }\n\n    hookEvents(subClass) {\n        this.ws.addEventListener('message', subClass.messageHandler.bind(subClass));\n        this.ws.addEventListener('open', subClass.openHandler.bind(subClass));\n        this.ws.addEventListener('close', subClass.closeHandler.bind(subClass));\n    }\n\n    isConnected() {\n        return this.ws.readyState === WebSocket.OPEN;\n    }\n\n    openHandler() {\n        eventSys.emit(e.net.connected);\n    }\n\n    closeHandler() {\n        eventSys.emit(e.net.disconnected);\n    }\n\n    messageHandler(message) {\n\n    }\n\n    joinWorld(name) {\n\n    }\n\n    requestChunk(x, y) {\n\n    }\n\n    updatePixel(x, y, rgb) {\n\n    }\n\n    sendUpdates() {\n\n    }\n\n    sendMessage(str) {\n\n    }\n}","'use strict';\nimport { OldProtocol } from './old.js';\nimport { options } from './../conf.js';\n\nexport const definedProtos = {\n\t'old': OldProtocol\n};\n\nexport function resolveProtocols() {\n\tfor (var i = 0; i < options.serverAddress.length; i++) {\n\t\tvar server = options.serverAddress[i];\n\t\tserver.proto = definedProtos[server.proto];\n\t}\n}","'use strict';\nimport { Protocol } from './Protocol.js';\nimport { EVENTS as e, RANK, options } from './../conf.js';\nimport { eventSys } from './../global.js';\nimport { Chunk } from './../World.js';\nimport { Bucket } from './../util/Bucket.js';\nimport { decompress } from './../util/misc.js';\nimport { loadAndRequestCaptcha } from './../captcha.js';\nimport { colorUtils as color } from './../util/color.js';\nimport { player, shouldUpdate, networkRankVerification } from './../local_player.js';\nimport { camera } from './../canvas_renderer.js';\nimport { mouse, elements } from './../main.js';\n\nexport const captchaState = {\n\tCA_WAITING: 0,\n\tCA_VERIFYING: 1,\n\tCA_VERIFIED: 2,\n\tCA_OK: 3,\n\tCA_INVALID: 4\n};\n\nexport const OldProtocol = {\n\tclass: null,\n\tchunkSize: 16,\n\tnetUpdateSpeed: 20,\n\tclusterChunkAmount: 64,\n\tmaxWorldNameLength: 24,\n\tworldBorder: 0xFFFFF,\n\tchatBucket: [4, 6],\n\tplaceBucket: {\n\t\t[RANK.NONE]: [0, 1],\n\t\t[RANK.USER]: [32, 4],\n\t\t[RANK.MODERATOR]: [32, 2],\n\t\t[RANK.ADMIN]: [32, 0]\n\t},\n\tmaxMessageLength: {\n\t\t[RANK.NONE]: 128,\n\t\t[RANK.USER]: 128,\n\t\t[RANK.MODERATOR]: 512,\n\t\t[RANK.ADMIN]: 16384\n\t},\n\ttools: {\n\t\tid: {}, /* Generated automatically */\n\t\t0: 'cursor',\n\t\t1: 'move',\n\t\t2: 'pipette',\n\t\t3: 'eraser',\n\t\t4: 'zoom',\n\t\t5: 'fill',\n\t\t6: 'paste',\n\t\t7: 'export',\n\t\t8: 'line',\n\t\t9: 'protect',\n\t\t10: 'copy'\n\t},\n\tmisc: {\n\t\tworldVerification: 4321,\n\t\tchatVerification: String.fromCharCode(10),\n\t\ttokenVerification: 'CaptchA'\n\t},\n\topCode: {\n\t\tclient: {\n\n\t\t},\n\t\tserver: {\n\t\t\tsetId: 0,\n\t\t\tworldUpdate: 1,\n\t\t\tchunkLoad: 2,\n\t\t\tteleport: 3,\n\t\t\tsetRank: 4,\n\t\t\tcaptcha: 5,\n\t\t\tsetPQuota: 6,\n\t\t\tchunkProtected: 7,\n\t\t\tmaxCount: 8\n\t\t}\n\t}\n};\n\nfor (const id in OldProtocol.tools) {\n\tif (+id >= 0) {\n\t\tOldProtocol.tools.id[OldProtocol.tools[id]] = +id;\n\t}\n}\n\nfunction stoi(string, max) {\n\tvar ints = [];\n\tvar fstring = \"\";\n\tstring = string.toLowerCase();\n\tfor (var i = 0; i < string.length && i < max; i++) {\n\t\tvar charCode = string.charCodeAt(i);\n\t\tif ((charCode < 123 && charCode > 96)\n\t\t|| (charCode < 58 && charCode > 47)\n\t\t|| charCode == 95 || charCode == 46) {\n\t\t\tfstring += String.fromCharCode(charCode);\n\t\t\tints.push(charCode);\n\t\t}\n\t}\n\treturn [ints, fstring];\n}\n\nclass OldProtocolImpl extends Protocol {\n\tconstructor(ws, worldName) {\n\t\tsuper(ws);\n\t\tsuper.hookEvents(this);\n\t\tthis.lastSentX = 0;\n\t\tthis.lastSentY = 0;\n\t\tthis.playercount = 1;\n\t\tthis.worldName = worldName ? worldName : options.defaultWorld;\n\t\tthis.players = {};\n\t\tthis.chunksLoading = {}; /* duplicate */\n\t\tthis.waitingForChunks = 0;\n\t\tthis.id = null;\n\n\t\tvar params = OldProtocol.chatBucket;\n\t\tthis.chatBucket = new Bucket(params[0], params[1]);\n\t\tparams = OldProtocol.placeBucket[player.rank];\n\t\tthis.placeBucket = new Bucket(params[0], params[1]);\n\n\t\tthis.interval = null;\n\t\tthis.clet = null;\n\n\t\tthis.joinFunc = () => {\n\t\t\tthis.placeBucket.allowance = 0;\n\t\t\t//this.chatBucket.allowance = 0;\n\t\t\tthis.interval = setInterval(() => this.sendUpdates(), 1000 / OldProtocol.netUpdateSpeed);\n\t\t};\n\n\t\tconst rankChanged = rank => {\n\t\t\tthis.placeBucket.infinite = rank === RANK.ADMIN;\n\t\t\telements.chatInput.maxLength = OldProtocol.maxMessageLength[rank];\n\t\t};\n\t\tthis.leaveFunc = () => {\n\t\t\teventSys.removeListener(e.net.sec.rank, rankChanged);\n\t\t};\n\t\teventSys.once(e.net.world.join, this.joinFunc);\n\t\teventSys.on(e.net.sec.rank, rankChanged);\n\t}\n\n\tcloseHandler() {\n\t\tsuper.closeHandler();\n\t\tclearInterval(this.interval);\n\t\teventSys.emit(e.net.sec.rank, RANK.NONE);\n\t\teventSys.removeListener(e.net.world.join, this.joinFunc);\n\t\tthis.leaveFunc();\n\t}\n\n\tmessageHandler(message) {\n\t\tmessage = message.data;\n\t\tif (typeof message === \"string\") {\n\t\t\tif (message.indexOf(\"DEV\") == 0) {\n\t\t\t\teventSys.emit(e.net.devChat, message.slice(3));\n\t\t\t} else {\n\t\t\t\teventSys.emit(e.net.chat, message);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tvar dv = new DataView(message);\n\t\tvar oc = OldProtocol.opCode.server;\n\t\tswitch (dv.getUint8(0)) {\n\t\t\tcase oc.setId: // Get id\n\t\t\t\tlet id = dv.getUint32(1, true);\n\t\t\t\tthis.id = id;\n\t\t\t\teventSys.emit(e.net.world.join, this.worldName);\n\t\t\t\teventSys.emit(e.net.world.setId, id);\n\t\t\t\teventSys.emit(e.net.playerCount, this.playercount);\n\t\t\t\teventSys.emit(e.net.chat, \"[Server] Joined world: \\\"\" + this.worldName + \"\\\", your ID is: \" + id + \"!\");\n\t\t\t\tbreak;\n\n\t\t\tcase oc.worldUpdate: // Get all cursors, tile updates, disconnects\n\t\t\t\tvar shouldrender = 0;\n\t\t\t\t// Cursors\n\t\t\t\tvar updated = false;\n\t\t\t\tvar updates = {};\n\t\t\t\tfor (var i = dv.getUint8(1); i--;) {\n\t\t\t\t\tupdated = true;\n\t\t\t\t\tvar pid = dv.getUint32(2 + i * 16, true);\n\t\t\t\t\tif (pid === this.id) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t  \t\t\t\tvar pmx = dv.getInt32(2 + i * 16 + 4, true);\n\t  \t\t\t\tvar pmy = dv.getInt32(2 + i * 16 + 8, true);\n\t  \t\t\t\tvar pr = dv.getUint8(2 + i * 16 + 12);\n\t  \t\t\t\tvar pg = dv.getUint8(2 + i * 16 + 13);\n\t  \t\t\t\tvar pb = dv.getUint8(2 + i * 16 + 14);\n\t  \t\t\t\tvar ptool = dv.getUint8(2 + i * 16 + 15);\n\t\t\t\t\tupdates[pid] = {\n\t\t\t\t\t\tx: pmx,\n\t\t\t\t\t\ty: pmy,\n\t\t\t\t\t\trgb: [pr, pg, pb],\n\t\t\t\t\t\ttool: OldProtocol.tools[ptool]\n\t\t\t\t\t};\n\t  \t\t\t\tif (!this.players[pid]) {\n\t\t\t\t\t\t++this.playercount;\n\t\t\t\t\t\teventSys.emit(e.net.playerCount, this.playercount);\n\t  \t\t\t\t\tthis.players[pid] = true;\n\t  \t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (updated) {\n\t\t\t\t\teventSys.emit(e.net.world.playersMoved, updates);\n\t\t\t\t}\n\t  \t\t\tvar off = 2 + dv.getUint8(1) * 16;\n\t\t\t\t// Tile updates\n\t\t\t\tupdated = false;\n\t\t\t\tupdates = [];\n\t  \t\t\tfor (var i = dv.getUint16(off, true), j = 0; j < i; j++) {\n\t\t\t\t\tupdated = true;\n\t\t\t\t\tvar bid = dv.getUint32(2 + off + j * 15, true);\n\t  \t\t\t\tvar bpx = dv.getInt32(2 + off + j * 15 + 4, true);\n\t  \t\t\t\tvar bpy = dv.getInt32(2 + off + j * 15 + 8, true);\n\t  \t\t\t\tvar br = dv.getUint8(2 + off + j * 15 + 12);\n\t  \t\t\t\tvar bg = dv.getUint8(2 + off + j * 15 + 13);\n\t  \t\t\t\tvar bb = dv.getUint8(2 + off + j * 15 + 14);\n\t\t\t\t\tvar bbgr = bb << 16 | bg << 8 | br;\n\t\t\t\t\tupdates.push({\n\t\t\t\t\t\tx: bpx,\n\t\t\t\t\t\ty: bpy,\n\t\t\t\t\t\trgb: bbgr,\n\t\t\t\t\t\tid: bid\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (updated) {\n\t\t\t\t\teventSys.emit(e.net.world.tilesUpdated, updates);\n\t\t\t\t}\n\t  \t\t\toff += dv.getUint16(off, true) * 15 + 2;\n\t\t\t\t// Disconnects\n\t\t\t\tvar decreased = false;\n\t\t\t\tupdated = false;\n\t\t\t\tupdates = [];\n\t  \t\t\tfor (var k = dv.getUint8(off); k--;) {\n\t\t\t\t\tupdated = true;\n\t\t\t\t\tvar dpid = dv.getUint32(1 + off + k * 4, true);\n\t\t\t\t\tupdates.push(dpid);\n\t\t\t\t\tif (this.players[dpid] && this.playercount > 1) {\n\t\t\t\t\t\tdecreased = true;\n\t\t\t\t\t\t--this.playercount;\n\t\t\t\t\t\tdelete this.players[dpid];\n\t\t\t\t\t}\n\t  \t\t\t}\n\t\t\t\tif (updated) {\n\t\t\t\t\teventSys.emit(e.net.world.playersLeft, updates);\n\t\t\t\t\tif (decreased) {\n\t\t\t\t\t\teventSys.emit(e.net.playerCount, this.playercount);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase oc.chunkLoad: // Get chunk\n\t\t\t\tvar chunkX = dv.getInt32(1, true);\n\t\t\t\tvar chunkY = dv.getInt32(5, true);\n\t\t\t\tvar locked = dv.getUint8(9);\n\t\t\t\tvar u8data = new Uint8Array(message, 10, message.byteLength - 10);\n\t\t\t\t//console.log(u8data);\n\t\t\t\tu8data = decompress(u8data);\n\t\t\t\tvar key = `${chunkX},${chunkY}`;\n\t\t\t\tvar u32data = new Uint32Array(OldProtocol.chunkSize * OldProtocol.chunkSize);\n\t\t\t\tfor (var i = 0, u = 0; i < u8data.length; i += 3) { /* Need to make a copy ;-; */\n\t\t\t\t\tvar color = u8data[i + 2] << 16\n\t\t\t\t\t\t| u8data[i + 1] << 8\n\t\t\t\t\t\t| u8data[i]\n\t\t\t\t\tu32data[u++] = 0xFF000000 | color;\n\t\t\t\t}\n\t\t\t\tif (!this.chunksLoading[key]) {\n\t\t\t\t\teventSys.emit(e.net.chunk.set, chunkX, chunkY, u32data);\n\t\t\t\t} else {\n\t\t\t\t\tdelete this.chunksLoading[key];\n\t\t\t\t\tif (--this.waitingForChunks == 0) {\n\t\t\t\t\t\tclearTimeout(this.clet);\n\t\t\t\t\t\tthis.clet = setTimeout(() => {\n\t\t\t\t\t\t\teventSys.emit(e.net.chunk.allLoaded);\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t\tvar chunk = new Chunk(chunkX, chunkY, u32data, locked);\n\t\t\t\t\teventSys.emit(e.net.chunk.load, chunk);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase oc.teleport: // Teleport\n\t\t\t\tlet x = dv.getInt32(1, true);\n\t\t\t\tlet y = dv.getInt32(5, true);\n\t\t\t\teventSys.emit(e.net.world.teleported, x, y);\n\t\t\t\tbreak;\n\n\t\t\tcase oc.setRank: // new rank\n\t\t\t\tnetworkRankVerification[0] = dv.getUint8(1);\n\t\t\t\teventSys.emit(e.net.sec.rank, dv.getUint8(1));\n\t\t\t\tbreak;\n\n\t\t\tcase oc.captcha: // Captcha\n\t\t\t\tswitch (dv.getUint8(1)) {\n\t\t\t\t\tcase captchaState.CA_WAITING:\n\t\t\t\t\t\tloadAndRequestCaptcha();\n\t\t\t\t\t\teventSys.once(e.misc.captchaToken, token => {\n\t\t\t\t\t\t\tlet message = OldProtocol.misc.tokenVerification + token;\n\t\t\t\t\t\t\tthis.ws.send(message);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase captchaState.CA_OK:\n\t\t\t\t\t   this.worldName = this.joinWorld(this.worldName);\n\t\t\t\t\t   break;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase oc.setPQuota:\n\t\t\t\tlet rate = dv.getUint16(1, true);\n\t\t\t\tlet per = dv.getUint16(3, true);\n\t\t\t\tthis.placeBucket = new Bucket(rate, per);\n\t\t\t\tbreak;\n\n\t\t\tcase oc.chunkProtected:\n\t\t\t\tlet cx = dv.getInt32(1, true);\n\t\t\t\tlet cy = dv.getInt32(5, true);\n\t\t\t\tlet newState = dv.getUint8(9);\n\t\t\t\teventSys.emit(e.net.chunk.lock, cx, cy, newState);\n\t\t\t\tbreak;\n\n\t\t\tcase oc.maxCount:\n\t\t\t\teventSys.emit(e.net.maxCount, dv.getUint16(1, true));\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tjoinWorld(name) {\n\t\tvar nstr = stoi(name, OldProtocol.maxWorldNameLength);\n\t\teventSys.emit(e.net.world.joining, name);\n\t\tvar array = new ArrayBuffer(nstr[0].length + 2);\n\t\tvar dv = new DataView(array);\n\t\tfor (var i = nstr[0].length; i--;) {\n\t\t\tdv.setUint8(i, nstr[0][i]);\n\t\t}\n\t\tdv.setUint16(nstr[0].length, OldProtocol.misc.worldVerification, true);\n\t\tthis.ws.send(array);\n\t\treturn nstr[1];\n\t}\n\n\trequestChunk(x, y) {\n\t\tlet wb = OldProtocol.worldBorder;\n\t\tvar key = `${x},${y}`;\n\t\tif (x > wb || y > wb || x < ~wb || y < ~wb || this.chunksLoading[key]) {\n\t\t\treturn;\n\t\t}\n\t\tthis.chunksLoading[key] = true;\n\t\tthis.waitingForChunks++;\n\t\tvar array = new ArrayBuffer(8);\n\t\tvar dv = new DataView(array);\n\t\tdv.setInt32(0, x, true);\n\t\tdv.setInt32(4, y, true);\n\t\tthis.ws.send(array);\n\t}\n\n\tallChunksLoaded() {\n\t\treturn this.waitingForChunks === 0;\n\t}\n\n\tupdatePixel(x, y, rgb) {\n\t\tvar distx = Math.trunc(x / OldProtocol.chunkSize) - Math.trunc(this.lastSentX / (OldProtocol.chunkSize * 16)); distx *= distx;\n\t\tvar disty = Math.trunc(y / OldProtocol.chunkSize) - Math.trunc(this.lastSentY / (OldProtocol.chunkSize * 16)); disty *= disty;\n\t\tvar dist = Math.sqrt(distx + disty);\n\t\tif (this.isConnected() && (dist < 3 || player.rank == RANK.ADMIN) && this.placeBucket.canSpend(1)) {\n\t\t\tvar array = new ArrayBuffer(11);\n\t\t\tvar dv = new DataView(array);\n\t\t\tdv.setInt32(0,  x, true);\n\t\t\tdv.setInt32(4,  y, true);\n\t\t\tdv.setUint8(8, rgb[0]);\n\t\t\tdv.setUint8(9, rgb[1]);\n\t\t\tdv.setUint8(10, rgb[2]);\n\t\t\tthis.ws.send(array);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tsendUpdates() {\n\t\tvar worldx = mouse.worldX;\n\t\tvar worldy = mouse.worldY;\n\t\tvar lastx = this.lastSentX;\n\t\tvar lasty = this.lastSentY;\n\t\tif (this.isConnected() && shouldUpdate() || (worldx != lastx || worldy != lasty)) {\n\t\t\tvar selrgb = player.selectedColor;\n\t\t\tthis.lastSentX = worldx;\n\t\t\tthis.lastSentY = worldy;\n\t\t\t// Send mouse position\n\t\t\tvar array = new ArrayBuffer(12);\n\t\t\tvar dv = new DataView(array);\n\t\t\tdv.setInt32(0, worldx, true);\n\t\t\tdv.setInt32(4, worldy, true);\n\t\t\tdv.setUint8(8, selrgb[0]);\n\t\t\tdv.setUint8(9, selrgb[1]);\n\t\t\tdv.setUint8(10, selrgb[2]);\n\t\t\tvar tool = player.tool;\n\t\t\tvar toolId = tool !== null ? +OldProtocol.tools.id[tool.id] : 0;\n\t\t\tdv.setUint8(11, toolId);\n\t\t\tthis.ws.send(array);\n\t\t}\n\t}\n\n\tsendMessage(str) {\n\t\tif (str.length && this.id !== null) {\n\t\t\tif (player.rank == RANK.ADMIN || this.chatBucket.canSpend(1)) {\n\t\t\t\tthis.ws.send(str + OldProtocol.misc.chatVerification);\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\teventSys.emit(e.net.chat, \"Slow down! You're talking too fast!\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotectChunk(x, y, newState) {\n\t\tvar array = new ArrayBuffer(10);\n\t\tvar dv = new DataView(array);\n\t\tdv.setInt32(0, x, true);\n\t\tdv.setInt32(4, y, true);\n\t\tdv.setUint8(8, newState);\n\t\tthis.ws.send(array);\n\t\teventSys.emit(e.net.chunk.lock, x, y, newState, true);\n\t}\n\n\tsetChunk(x, y, data) {\n\t\tif (!(player.rank == RANK.ADMIN || (player.rank == RANK.MODERATOR && this.placeBucket.canSpend(1.25)))) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar buf = new Uint8Array(8 + OldProtocol.chunkSize * OldProtocol.chunkSize * 3);\n\t\tvar dv = new DataView(buf.buffer);\n\t\tdv.setInt32(0, x, true);\n\t\tdv.setInt32(4, y, true);\n\t\tfor (var i = 0, b = 8; i < data.length; i++, b += 3) {\n\t\t\tbuf[b] = data[i] & 0xFF;\n\t\t\tbuf[b + 1] = data[i] >> 8 & 0xFF;\n\t\t\tbuf[b + 2] = data[i] >> 16 & 0xFF;\n\t\t}\n\t\tthis.ws.send(buf.buffer);\n\t\treturn true;\n\t}\n\n\tclearChunk(x, y, rgb) {\n\t\tif (player.rank == RANK.ADMIN || (player.rank == RANK.MODERATOR && this.placeBucket.canSpend(1))) {\n\t\t\tvar array = new ArrayBuffer(13);\n\t\t\tvar dv = new DataView(array);\n\t\t\tdv.setInt32(0, x, true);\n\t\t\tdv.setInt32(4, y, true);\n\t\t\tdv.setUint8(8, rgb[0]);\n\t\t\tdv.setUint8(9, rgb[1]);\n\t\t\tdv.setUint8(10, rgb[2]);\n\t\t\tthis.ws.send(array);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}\n\nOldProtocol.class = OldProtocolImpl;\n","'use strict';\n\nconst types = {\n\tu8: (offset, isSetter) => [`.${isSetter ? 'get' : 'set'}Uint8(${offset});`, 1],\n\n};\n\nfunction makeParser(ocList) {\n\n}\n\nfunction makeBuilders(ocList) {\n\n}","'use strict';\n\nconst protobuf = {\n    global: {\n        toClient: {\n            0x00: [ /* Switch network state */\n                {\n                    name: 'stateId',\n                    type: 'u8'\n                }\n            ]\n        },\n        toServer: {}\n    },\n    0x00: { /* Verify */\n        toClient: {\n            0x01: [ /* Protocol version */\n                { name: 'version', type: 'u8' }\n            ],\n            0x02: [ /* Captcha status */\n                { name: 'status', type: 'u8' }\n            ]\n        },\n        toServer: {\n            0x01: [\n                { name: 'version', type: 'u8' }\n            ],\n            0x02: [\n                { name: 'token', type: 'string' }\n            ]\n        }\n    },\n    0x01: { /* Login */\n        toClient: {\n            0x01: [ /* Login info */\n                { name: 'name', type: 'string' }\n            ],\n            0x02: [] /* Login status */\n        },\n        toServer: {\n            0x01: [ /* Guest */\n                { name: 'name', type: 'string' }\n            ],\n            0x02: [], /* Login */\n            0x03: [] /* Register */\n        }\n    },\n    0x02: { /* Lobby */\n        toClient: {\n            0x01: [ /* Player count */\n                { name: 'count', type: 'u32' }\n            ],\n            0x02: [ /* MOTD */\n                { name: 'motd', type: 'string' }\n            ],\n            0x03: [ /* Set world */\n                { name: 'name', type: 'string' }\n            ]\n        },\n        toServer: {\n            0x01: [ /* Join world */\n                { name: 'name', type: 'string' }\n            ],\n            0x02: [] /* Log out */\n        }\n    },\n    0x03: {\n        toClient: {\n            0x01: [ /* Set ID */\n                { name: 'id', type: 'u32' }\n            ],\n            0x02: [ /* Chunk data */\n                { name: 'x', type: 'i32' },\n                { name: 'y', type: 'i32' },\n                { name: 'data', type: 'compressedArray', itemType: 'u16' } /* Size is defined in the compressed data */\n            ],\n            0x03: [ /* Area subscribe status */\n                { name: 'state', type: 'u8' },\n                { name: 'x', type: 'i32' },\n                { name: 'y', type: 'i32' }\n            ],\n            0x04: [ /* Client sync */\n                { name: 'tool', type: 'u8' },\n                { name: 'x', type: 'i32' },\n                { name: 'y', type: 'i32' },\n                { name: 'perms', type: 'u8' }\n            ],\n            0x05: [ /* Action rejected */\n                { name: 'action', type: 'u8' }\n                /* TODO - different data for different actions */\n            ],\n            0x06: [ /* World state */\n                { name: 'players', type: 'array', sizeType: 'u8', itemType: [\n                    { name: 'id', type: 'u32' },\n                    { name: 'x', type: 'i32' },\n                    { name: 'y', type: 'i32' },\n                    { name: 'color', type: 'u16' },\n                    { name: 'tool', type: 'u8' }\n                ]},\n                { name: 'pixels', type: 'array', sizeType: 'u16', itemType: [\n                    { name: 'x', type: 'i32' },\n                    { name: 'y', type: 'i32' },\n                    { name: 'rgb', type: 'u16' }\n                ]},\n                { name: 'playersLeft', type: 'array', sizeType: 'u8', itemType: [\n                    { name: 'id', type: 'u32' }\n                ]},\n                { name: 'totalPlayers', type: 'u32' }\n            ],\n            0x07: [\n\n            ],\n            0x08: [\n\n            ]\n        },\n        toServer: {\n            0x01: [\n                \n            ],\n            0x02: [\n                \n            ],\n            0x03: [\n\n            ],\n            0x04: [\n\n            ],\n            0x05: [\n\n            ],\n            0x06: [\n\n            ],\n            0x07: []\n        }\n    }\n};","'use strict';\nimport { EVENTS as e, options } from './conf.js';\nimport { eventSys, PublicAPI } from './global.js';\n\nexport const cursors = {\n\tset: new Image(),\n\tcursor: {imgpos: [0, 0], hotspot: [0, 0]},\n\tmove: {imgpos: [1, 0], hotspot: [18, 18]},\n\tpipette: {imgpos: [0, 1], hotspot: [0, 28]},\n\terase: {imgpos: [0, 2], hotspot: [4, 26]},\n\tzoom: {imgpos: [1, 2], hotspot: [19, 10]},\n\tfill: {imgpos: [1, 1], hotspot: [3, 29]},\n\tbrush: {imgpos: [0, 3], hotspot: [0, 26]},\n\tselect: {imgpos: [2, 0], hotspot: [0, 0]}, // needs better hotspot\n\tselectprotect: {imgpos: [4, 0], hotspot: [0, 0]},\n\tareadelete: {imgpos: [4, 1], hotspot: [0, 0]},\n\tcopy: {imgpos: [3, 0], hotspot: [0, 0]}, // and this\n\tpaste: {imgpos: [3, 1], hotspot: [0, 0]}, // this too\n\tcut: {imgpos: [3, 2], hotspot: [11, 5]},\n\twand: {imgpos: [3, 3], hotspot: [0, 0]},\n\tshield: {imgpos: [2, 3], hotspot: [18, 18]},\n\tkick: {imgpos: [2, 1], hotspot: [3, 6]},\n\tban: {imgpos: [3, 0], hotspot: [10, 4]},\n\twrite: {imgpos: [1, 3], hotspot: [10, 4]} // fix hotspot\n};\n\nPublicAPI.cursors = cursors;\n\nfunction reduce(canvas) { /* Removes unused space from the image */\n\tvar nw = canvas.width;\n\tvar nh = canvas.height;\n\tvar ctx = canvas.getContext('2d');\n\tvar idat = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\tvar u32dat = new Uint32Array(idat.data.buffer);\n\tvar xoff = 0;\n\tvar yoff = 0;\n\tfor(var y = 0, x, i = 0; y < idat.height; y++) {\n\t\tfor(x = idat.width; x--; i += u32dat[y * idat.width + x]);\n\t\tif(i) { break; }\n\t\tyoff++;\n\t}\n\tfor(var x = 0, y, i = 0; x < idat.width; x++) {\n\t\tfor(y = nh; y--; i += u32dat[y * idat.width + x]);\n\t\tif(i) { break; }\n\t\txoff++;\n\t}\n\tfor(var y = idat.height, x, i = 0; y--;) {\n\t\tfor(x = idat.width; x--; i += u32dat[y * idat.width + x]);\n\t\tif(i) { break; }\n\t\tnh--;\n\t}\n\tfor(var x = idat.width, y, i = 0; x--;) {\n\t\tfor(y = nh; y--; i += u32dat[y * idat.width + x]);\n\t\tif(i) { break; }\n\t\tnw--;\n\t}\n\tcanvas.width = nw;\n\tcanvas.height = nh;\n\tctx.putImageData(idat, -xoff, -yoff);\n}\n\nfunction shadow(canvas, img) {\n\t/* Make a bigger image so the shadow doesn't get cut */\n\tcanvas.width  = 2 + img.width + 6;\n\tcanvas.height = 2 + img.height + 6;\n\tvar ctx = canvas.getContext('2d');\n\tctx.shadowColor = '#000000';\n\tctx.globalAlpha = 0.5; /* The shadow is too dark so we draw it transparent */\n\tctx.shadowBlur  = 4;\n\tctx.shadowOffsetX = 2;\n\tctx.shadowOffsetY = 2;\n\tctx.drawImage(img, 2, 2);\n\tctx.globalAlpha = 1;\n\tctx.shadowColor = 'rgba(0, 0, 0, 0)'; /* disables the shadow */\n\tctx.drawImage(img, 2, 2);\n}\n\n/* makes a hole with the shape of the image */\nfunction popOut(canvas, img) {\n\tvar shadowcolor = 0xFF3B314D;\n\tvar backgroundcolor = 0xFF5C637E;\n\tcanvas.width = img.width;\n\tcanvas.height = img.height;\n\tvar ctx = canvas.getContext('2d');\n\tctx.drawImage(img, 0, 0);\n\tvar idat = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\tvar u32dat = new Uint32Array(idat.data.buffer);\n\tvar clr = function(x, y) {\n\t\treturn (x < 0 || y < 0 || x >= idat.width || y >= idat.height) ? 0\n\t\t\t: u32dat[y * idat.width + x];\n\t};\n\tfor(var i = u32dat.length; i--;) {\n\t\tif(u32dat[i] !== 0) {\n\t\t\tu32dat[i] = backgroundcolor;\n\t\t}\n\t}\n\tfor(var y = idat.height; y--;) {\n\t\tfor(var x = idat.width; x--;) {\n\t\t\tif(clr(x, y) === backgroundcolor && (!clr(x, y - 1) || !clr(x - 1, y)) && !clr(x - 1, y - 1)) {\n\t\t\t\tu32dat[y * idat.width + x] = shadowcolor;\n\t\t\t}\n\t\t}\n\t}\n\tfor(var y = idat.height; y--;) {\n\t\tfor(var x = idat.width; x--;) {\n\t\t\tif(clr(x, y - 1) === shadowcolor\n\t\t\t   && clr(x - 1, y) === shadowcolor) {\n\t\t\t\tu32dat[y * idat.width + x] = shadowcolor;\n\t\t\t}\n\t\t}\n\t}\n\tctx.putImageData(idat, 0, 0);\n}\n\nfunction load(oncomplete) {\n\tcursors.set.onload = function() {\n\t\tvar set = cursors.set;\n\t\tvar slotcanvas = document.createElement('canvas');\n\t\tpopOut(slotcanvas, set);\n\t\tvar j = Object.keys(cursors).length - 1 + 1; /* +1 slotset to blob url */\n\t\tfor(var tool in cursors) {\n\t\t\tif (tool === 'set') { continue; }\n\t\t\ttool = cursors[tool];\n\t\t\tvar original = document.createElement('canvas');\n\t\t\tvar i = tool.img = {\n\t\t\t\tshadowed: document.createElement('canvas'),\n\t\t\t\tshadowblob: null\n\t\t\t};\n\t\t\toriginal.width = original.height = 36;\n\t\t\toriginal.getContext('2d').drawImage(set,\n\t\t\t\ttool.imgpos[0] * 36,\n\t\t\t\ttool.imgpos[1] * 36,\n\t\t\t\t36, 36,\n\t\t\t\t0, 0,\n\t\t\t\t36, 36\n\t\t\t);\n\t\t\treduce(original);\n\t\t\tshadow(i.shadowed, original);\n\t\t\ttool.hotspot[0] += 2;\n\t\t\ttool.hotspot[1] += 2; /* Check shadow() for explanation */\n\n\t\t\t/* Blob-ify images */\n\t\t\ti.shadowed.toBlob(function(blob) {\n\t\t\t\tthis.img.shadowblob = URL.createObjectURL(blob);\n\t\t\t\tif(!--j) oncomplete();\n\t\t\t}.bind(tool));\n\t\t}\n\t\tslotcanvas.toBlob(blob => {\n\t\t\tcursors.slotset = URL.createObjectURL(blob);\n\t\t\tif(!--j) oncomplete();\n\t\t});\n\t};\n\n\tcursors.set.src = options.toolSetUrl;\n}\n\neventSys.once(e.loaded, () => {\n\tload(() => eventSys.emit(e.misc.toolsRendered));\n});\n","'use strict';\nimport { PublicAPI, eventSys } from './global.js';\nimport { EVENTS as e, protocol, options, RANK } from './conf.js';\nimport { absMod, setTooltip, mkHTML, line } from './util/misc.js';\nimport { cursors } from './tool_renderer.js';\nimport { net } from './networking.js';\nimport { player } from './local_player.js';\nimport { camera, moveCameraTo, moveCameraBy, renderer, drawText } from './canvas_renderer.js';\nimport { windowSys, GUIWindow, UtilDialog } from './windowsys.js';\nimport { misc, elements, mouse, sounds, keysDown } from './main.js';\nimport { PLAYERFX } from './Fx.js';\n\nexport const tools = {};\nexport let toolsWindow = null;\nlet windowShown = false;\n\nexport function updateToolWindow(name) {\n\tif (!toolsWindow) {\n\t\treturn;\n\t}\n\tlet tool = tools[name];\n\tvar children = toolsWindow.container.children;\n\tfor (var i = 0; i < children.length; i++) {\n\t\tvar button = children[i];\n\t\tvar isSelected = button.id.split('-')[1] === name;\n\t\tbutton.className = isSelected ? 'selected' : '';\n\t\tbutton.children[0].style.backgroundImage = \"url(\" + (isSelected ? cursors.slotset : cursors.set.src) + \")\";\n\t}\n\telements.viewport.style.cursor = \"url(\" + tool.cursorblob + \") \" + tool.offset[0] + \" \" + tool.offset[1] + \", pointer\";\n}\n\nexport function updateToolbar(win = toolsWindow) {\n\tif (!win) {\n\t\treturn;\n\t}\n\n\tconst container = win.container;\n\tconst toolButtonClick = name => event => {\n\t\tplayer.tool = name;\n\t\tsounds.play(sounds.click);\n\t};\n\n\tcontainer.innerHTML = \"\";\n\n\t// Add tools to the tool-select menu\n\tfor (const name in tools) {\n\t\tvar tool = tools[name];\n\t\tif (player.rank >= tool.rankRequired) {\n\t\t\tvar element = document.createElement(\"button\");\n\t\t\tvar mask = document.createElement(\"div\");\n\t\t\tsetTooltip(element, tool.name + \" tool\");\n\t\t\telement.id = \"tool-\" + name;\n\t\t\telement.addEventListener(\"click\", toolButtonClick(name));\n\t\t\tif (tool === player.tool) {\n\t\t\t\tmask.style.backgroundImage = \"url(\" + cursors.slotset + \")\";\n\t\t\t\telement.className = \"selected\";\n\t\t\t} else {\n\t\t\t\tmask.style.backgroundImage = \"url(\" + cursors.set.src + \")\";\n\t\t\t}\n\t\t\tmask.style.backgroundPosition = tool.setposition;\n\t\t\telement.appendChild(mask);\n\t\t\tcontainer.appendChild(element);\n\t\t}\n\t}\n}\n\nexport function showToolsWindow(bool) {\n\tif (windowShown !== bool) {\n\t\tif (bool && toolsWindow) {\n\t\t\twindowSys.addWindow(toolsWindow);\n\t\t} else if (toolsWindow) {\n\t\t\twindowSys.delWindow(toolsWindow);\n\t\t}\n\t\twindowShown = bool;\n\t}\n}\n\nexport function addTool(tool) {\n\ttool.id = tool.name.toLowerCase();\n\ttools[tool.id] = tool;\n\tupdateToolbar();\n}\n\nclass Tool {\n\tconstructor(name, cursor, fxRenderer, rankNeeded, onInit) {\n\t\tthis.name = name;\n\t\tthis.id = null;\n\t\tthis.fxRenderer = fxRenderer;\n\t\tthis.cursorblob = cursor.img.shadowblob;\n\t\tthis.cursor = cursor.img.shadowed;\n\t\tthis.setposition = (-cursor.imgpos[0] * 36) + \"px \" + (-cursor.imgpos[1] * 36) + \"px\";\n\t\tthis.offset = cursor.hotspot;\n\t\tthis.rankRequired = rankNeeded;\n\t\tthis.extra = {}; /* Extra storage for tools */\n\t\tthis.events = {\n\t\t\tmouseup: null,\n\t\t\tmousedown: null,\n\t\t\tmousemove: null,\n\t\t\ttouchstart: null,\n\t\t\ttouchmove: null,\n\t\t\ttouchend: null,\n\t\t\ttouchcancel: null,\n\t\t\tselect: null,\n\t\t\tdeselect: null,\n\t\t\tkeydown: null,\n\t\t\tkeyup: null,\n\t\t\tscroll: null,\n\t\t\ttick: null\n\t\t};\n\t\tonInit(this);\n\t}\n\n\t/* Doesn't update if tool already selected */\n\tsetFxRenderer(func) {\n\t\tthis.fxRenderer = func;\n\t}\n\n\tisEventDefined(type) {\n\t\treturn type in this.events;\n\t}\n\n\tsetEvent(type, func) {\n\t\tvar events = type.split(' ');\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\tthis.events[events[i]] = func || null;\n\t\t}\n\t}\n\n\tcall(type, data) {\n\t\tvar func = this.events[type];\n\t\tif (func) {\n\t\t\treturn func.apply(this, data);\n\t\t} else if (type.indexOf(\"touch\") === 0) {\n\t\t\treturn this.defaultTouchHandler(type.slice(5), data);\n\t\t}\n\t\treturn false;\n\t}\n\n\tdefaultTouchHandler(type, data) {\n\t\tvar mouse = data[0];\n\t\tvar event = data[1]; /* hmm... */\n\t\tvar handlers = {\n\t\t\tstart: this.events.mousedown,\n\t\t\tmove: this.events.mousemove,\n\t\t\tend: this.events.mouseup,\n\t\t\tcancel: this.events.mouseup\n\t\t};\n\t\tvar handler = handlers[type];\n\t\tif (handler) {\n\t\t\tvar touches = event.changedTouches;\n\t\t\tfor (var i = 0; i < touches.length; i++) {\n\t\t\t\tmouse.x = touches[i].pageX;\n\t\t\t\tmouse.y = touches[i].pageY;\n\t\t\t\thandler.apply(this, data);\n\t\t\t}\n\t\t}\n\t}\n}\n\nPublicAPI.tool = {\n\tclass: Tool,\n\taddToolObject: addTool,\n\tupdateToolbar,\n\tallTools: tools,\n\tshowToolsWindow\n};\n\neventSys.once(e.misc.toolsRendered, () => {\n\t// Cursor tool\n\taddTool(new Tool('Cursor', cursors.cursor, PLAYERFX.RECT_SELECT_ALIGNED(1), RANK.USER,\n\t\ttool => {\n\t\t\tvar lastX,\n\t\t\t\tlastY;\n\t\t\ttool.setEvent('mousedown mousemove', (mouse, event) => {\n\t\t\t\tvar usedButtons = 0b11; /* Left and right mouse buttons are always used... */\n\t\t\t\t/* White color if right clicking */\n\t\t\t\tvar color = mouse.buttons === 2 ? [255, 255, 255] : player.selectedColor;\n\t\t\t\tswitch (mouse.buttons) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tif (!lastX || !lastY) {\n\t\t\t\t\t\t\tlastX = mouse.tileX;\n\t\t\t\t\t\t\tlastY = mouse.tileY;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tline(lastX, lastY, mouse.tileX, mouse.tileY, 1, (x, y) => {\n\t\t\t\t\t\t\tvar pixel = misc.world.getPixel(x, y);\n\t\t\t\t\t\t\tif (pixel !== null && !(color[0] === pixel[0] && color[1] === pixel[1] && color[2] === pixel[2])) {\n\t\t\t\t\t\t\t\tmisc.world.setPixel(x, y, color);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tlastX = mouse.tileX;\n\t\t\t\t\t\tlastY = mouse.tileY;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\tif (event.ctrlKey) {\n\t\t\t\t\t\t\tusedButtons |= 0b100;\n\t\t\t\t\t\t\tvar color = misc.world.getPixel(mouse.tileX, mouse.tileY);\n\t\t\t\t\t\t\tif (color) {\n\t\t\t\t\t\t\t\tplayer.selectedColor = color;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn usedButtons;\n\t\t\t});\n\t\t\ttool.setEvent('mouseup', mouse => {\n\t\t\t\tlastX = null;\n\t\t\t\tlastY = null;\n\t\t\t});\n\t\t}\n\t));\n\n\t// Move tool\n\taddTool(new Tool('Move', cursors.move, PLAYERFX.NONE, RANK.NONE,\n\t\ttool => {\n\t\t\tfunction move(x, y, startX, startY) {\n\t\t\t\tmoveCameraBy((startX - x) / 16, (startY - y) / 16);\n\t\t\t}\n\t\t\ttool.setEvent('mousemove', (mouse, event) => {\n\t\t\t\tif (mouse.buttons !== 0) {\n\t\t\t\t\tmove(mouse.worldX, mouse.worldY, mouse.mouseDownWorldX, mouse.mouseDownWorldY);\n\t\t\t\t\treturn mouse.buttons;\n\t\t\t\t}\n\t\t\t});\n\t\t\ttool.setEvent('scroll', (mouse, event, rawEvent) => {\n\t\t\t\tif (!rawEvent.ctrlKey) {\n\t\t\t\t\tvar dx = Math.max(-500, Math.min(event.spinX * 16, 500));\n\t\t\t\t\tvar dy = Math.max(-500, Math.min(event.spinY * 16, 500));\n\t\t\t\t\tvar pxAmount = camera.zoom//Math.max(camera.zoom, 2);\n\t\t\t\t\tmoveCameraBy(dx / pxAmount, dy / pxAmount);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t));\n\n\t// Pipette tool\n\taddTool(new Tool('Pipette', cursors.pipette, PLAYERFX.NONE, RANK.NONE,\n\t\ttool => {\n\t\t\ttool.setEvent('mousedown mousemove', (mouse, event) => {\n\t\t\t\tif (mouse.buttons !== 0 && !(mouse.buttons & 0b100)) {\n\t\t\t\t\tvar color = misc.world.getPixel(mouse.tileX, mouse.tileY);\n\t\t\t\t\tif (color) {\n\t\t\t\t\t\tplayer.selectedColor = color;\n\t\t\t\t\t}\n\t\t\t\t\treturn mouse.buttons;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t));\n\n\t// Erase/Fill tool\n\taddTool(new Tool('Eraser', cursors.erase, PLAYERFX.RECT_SELECT_ALIGNED(16), RANK.MODERATOR,\n\t\ttool => {\n\t\t\tfunction fillChunk(chunkX, chunkY, c) {\n\t\t\t\tconst color = c[2] << 16 | c[1] << 8 | c[0];\n\t\t\t\tvar chunk = misc.world.getChunkAt(chunkX, chunkY);\n\t\t\t\tif (chunk) {\n\t\t\t\t\tvar empty = true;\n\t\t\t\t\tfirstLoop: for (var y = 0; y < protocol.chunkSize; y++) {\n\t\t\t\t\t\tfor (var x = 0; x < protocol.chunkSize; x++) {\n\t\t\t\t\t\t\tif ((chunk.get(x, y) & 0xFFFFFF) != color) {\n\t\t\t\t\t\t\t\tempty = false;\n\t\t\t\t\t\t\t\tbreak firstLoop;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!empty) {\n\t\t\t\t\t\tif (net.protocol.clearChunk(chunkX, chunkY, c)) {\n\t\t\t\t\t\t\tchunk.set(color);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttool.setEvent('mousedown mousemove', (mouse, event) => {\n\t\t\t\tif (mouse.buttons & 0b1) {\n\t\t\t\t\tfillChunk(Math.floor(mouse.tileX / protocol.chunkSize), Math.floor(mouse.tileY / protocol.chunkSize), player.selectedColor);\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if (mouse.buttons & 0b10) {\n\t\t\t\t\tfillChunk(Math.floor(mouse.tileX / protocol.chunkSize), Math.floor(mouse.tileY / protocol.chunkSize), [255, 255, 255]);\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t));\n\n\t// Zoom tool\n\taddTool(new Tool('Zoom', cursors.zoom, PLAYERFX.NONE, RANK.NONE,\n\t\ttool => {\n\t\t\tfunction zoom(mouse, type) {\n\t\t\t\tvar lzoom = camera.zoom;\n\t\t\t\tvar nzoom = camera.zoom;\n\t\t\t\tvar offX = 0;\n\t\t\t\tvar offY = 0;\n\t\t\t\tvar w = window.innerWidth;\n\t\t\t\tvar h = window.innerHeight;\n\t\t\t\tif (type === 1) {\n\t\t\t\t\t// Zoom in\n\t\t\t\t\tnzoom *= 1 + options.zoomStrength;\n\t\t\t\t\toffX = (mouse.x - w / 2) / nzoom;\n\t\t\t\t\toffY = (mouse.y - h / 2) / nzoom;\n\t\t\t\t} else if (type === 2) {\n\t\t\t\t\t// Zoom out\n\t\t\t\t\tnzoom /= 1 + options.zoomStrength;\n\t\t\t\t\toffX = (mouse.x - w / 2) * (3 / lzoom - 2 / nzoom);\n\t\t\t\t\toffY = (mouse.y - h / 2) * (3 / lzoom - 2 / nzoom);\n\t\t\t\t} else if (type === 3) {\n\t\t\t\t\t// Reset zoom (right + left click)\n\t\t\t\t\tnzoom = options.defaultZoom;\n\t\t\t\t}\n\t\t\t\tnzoom = Math.round(nzoom);\n\t\t\t\tcamera.zoom = nzoom;\n\t\t\t\tif (camera.zoom !== lzoom) {\n\t\t\t\t\tmoveCameraBy(offX, offY);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttool.setEvent(\"mousedown\", (mouse, event) => {\n\t\t\t\tzoom(mouse, mouse.buttons);\n\t\t\t});\n\t\t\ttool.setEvent(\"touchstart\", (mouse, event) => {\n\t\t\t\ttool.extra.maxTouches = Math.max(tool.extra.maxTouches || 0, event.touches.length);\n\t\t\t});\n\t\t\ttool.setEvent(\"touchend\", (mouse, event) => {\n\t\t\t\tif (event.touches.length === 0) {\n\t\t\t\t\tif (tool.extra.maxTouches > 1) {\n\t\t\t\t\t\tzoom(mouse, tool.extra.maxTouches);\n\t\t\t\t\t}\n\t\t\t\t\ttool.extra.maxTouches = 0;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t));\n\n\t// Area to PNG tool\n\taddTool(new Tool('Export', cursors.select, PLAYERFX.NONE, RANK.NONE,\n\t\ttool => {\n\t\t\ttool.setFxRenderer((fx, ctx, time) => {\n\t\t\t\tif (!fx.extra.isLocalPlayer) return 1;\n\t\t\t\tvar x = fx.extra.player.x;\n\t\t\t\tvar y = fx.extra.player.y;\n\t\t\t\tvar fxx = (Math.floor(x / 16) - camera.x) * camera.zoom;\n\t\t\t\tvar fxy = (Math.floor(y / 16) - camera.y) * camera.zoom;\n\t\t\t\tvar oldlinew = ctx.lineWidth;\n\t\t\t\tctx.lineWidth = 1;\n\t\t\t\tif (tool.extra.end) {\n\t\t\t\t\tvar s = tool.extra.start;\n\t\t\t\t\tvar e = tool.extra.end;\n\t\t\t\t\tvar x = (s[0] - camera.x) * camera.zoom + 0.5;\n\t\t\t\t\tvar y = (s[1] - camera.y) * camera.zoom + 0.5;\n\t\t\t\t\tvar w = e[0] - s[0];\n\t\t\t\t\tvar h = e[1] - s[1];\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.rect(x, y, w * camera.zoom, h * camera.zoom);\n\t\t\t\t\tctx.globalAlpha = 1;\n\t\t\t\t\tctx.strokeStyle = \"#FFFFFF\";\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tctx.setLineDash([3, 4]);\n\t\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tctx.globalAlpha = 0.25 + Math.sin(time / 500) / 4;\n\t\t\t\t\tctx.fillStyle = renderer.patterns.unloaded;\n\t\t\t\t\tctx.fill();\n\t\t\t\t\tctx.setLineDash([]);\n\t\t\t\t\tvar oldfont = ctx.font;\n\t\t\t\t\tctx.font = \"16px sans-serif\";\n\t\t\t\t\tvar txt = `${!tool.extra.clicking ? \"Right click to screenshot \" : \"\"}(${Math.abs(w)}x${Math.abs(h)})`;\n\t\t\t\t\tvar txtx = window.innerWidth >> 1;\n\t\t\t\t\tvar txty = window.innerHeight >> 1;\n\t\t\t\t\ttxtx = Math.max(x, Math.min(txtx, x + w * camera.zoom));\n\t\t\t\t\ttxty = Math.max(y, Math.min(txty, y + h * camera.zoom));\n\n\t\t\t\t\tdrawText(ctx, txt, txtx, txty, true);\n\t\t\t\t\tctx.font = oldfont;\n\t\t\t\t\tctx.lineWidth = oldlinew;\n\t\t\t\t\treturn 0;\n\t\t\t\t} else {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(0, fxy + 0.5);\n\t\t\t\t\tctx.lineTo(window.innerWidth, fxy + 0.5);\n\t\t\t\t\tctx.moveTo(fxx + 0.5, 0);\n\t\t\t\t\tctx.lineTo(fxx + 0.5, window.innerHeight);\n\n\t\t\t\t\t//ctx.lineWidth = 1;\n\t\t\t\t\tctx.globalAlpha = 1;\n\t\t\t\t\tctx.strokeStyle = \"#FFFFFF\";\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tctx.setLineDash([3]);\n\t\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\t\tctx.stroke();\n\n\t\t\t\t\tctx.setLineDash([]);\n\t\t\t\t\tctx.lineWidth = oldlinew;\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction dlarea(x, y, w, h, onblob){\n\t\t\t\tvar c = document.createElement('canvas');\n\t\t\t\tc.width = w;\n\t\t\t\tc.height = h;\n\t\t\t\tvar ctx = c.getContext('2d');\n\t\t\t\tvar d = ctx.createImageData(w, h);\n\t\t\t\tfor(var i = y; i < y + h; i++){\n\t\t\t\t  for(var j = x; j < x + w; j++){\n\t\t\t\t\tvar pix = misc.world.getPixel(j, i);\n\t\t\t\t\tif (!pix) continue;\n\t\t\t\t\td.data[4*((i - y)*w + (j - x))] = pix[0];\n\t\t\t\t\td.data[4*((i - y)*w + (j - x)) + 1] = pix[1];\n\t\t\t\t\td.data[4*((i - y)*w + (j - x)) + 2] = pix[2];\n\t\t\t\t\td.data[4*((i - y)*w + (j - x)) + 3] = 255;\n\t\t\t\t  }\n\t\t\t\t}\n\t\t\t\tctx.putImageData(d, 0, 0);\n\t\t\t\tc.toBlob(onblob);\n\t\t\t  }\n\n\t\t\ttool.extra.start = null;\n\t\t\ttool.extra.end = null;\n\t\t\ttool.extra.clicking = false;\n\n\t\t\ttool.setEvent('mousedown', (mouse, event) => {\n\t\t\t\tvar s = tool.extra.start;\n\t\t\t\tvar e = tool.extra.end;\n\t\t\t\tconst isInside = () => mouse.tileX >= s[0] && mouse.tileX < e[0] && mouse.tileY >= s[1] && mouse.tileY < e[1];\n\t\t\t\tif (mouse.buttons === 1 && !tool.extra.end) {\n\t\t\t\t\ttool.extra.start = [mouse.tileX, mouse.tileY];\n\t\t\t\t\ttool.extra.clicking = true;\n\t\t\t\t\ttool.setEvent('mousemove', (mouse, event) => {\n\t\t\t\t\t\tif (tool.extra.start && mouse.buttons === 1) {\n\t\t\t\t\t\t\ttool.extra.end = [mouse.tileX, mouse.tileY];\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst finish = () => {\n\t\t\t\t\t\ttool.setEvent('mousemove mouseup deselect', null);\n\t\t\t\t\t\ttool.extra.clicking = false;\n\t\t\t\t\t\tvar s = tool.extra.start;\n\t\t\t\t\t\tvar e = tool.extra.end;\n\t\t\t\t\t\tif (e) {\n\t\t\t\t\t\t\tif (s[0] === e[0] || s[1] === e[1]) {\n\t\t\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (s[0] > e[0]) {\n\t\t\t\t\t\t\t\tvar tmp = e[0];\n\t\t\t\t\t\t\t\te[0] = s[0];\n\t\t\t\t\t\t\t\ts[0] = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (s[1] > e[1]) {\n\t\t\t\t\t\t\t\tvar tmp = e[1];\n\t\t\t\t\t\t\t\te[1] = s[1];\n\t\t\t\t\t\t\t\ts[1] = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trenderer.render(renderer.rendertype.FX);\n\t\t\t\t\t};\n\t\t\t\t\ttool.setEvent('deselect', finish);\n\t\t\t\t\ttool.setEvent('mouseup', (mouse, event) => {\n\t\t\t\t\t\tif (!(mouse.buttons & 1)) {\n\t\t\t\t\t\t\tfinish();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else if (mouse.buttons === 1 && tool.extra.end) {\n\t\t\t\t\tif (isInside()) {\n\t\t\t\t\t\tvar offx = mouse.tileX;\n\t\t\t\t\t\tvar offy = mouse.tileY;\n\t\t\t\t\t\ttool.setEvent('mousemove', (mouse, event) => {\n\t\t\t\t\t\t\tvar dx = mouse.tileX - offx;\n\t\t\t\t\t\t\tvar dy = mouse.tileY - offy;\n\t\t\t\t\t\t\ttool.extra.start = [s[0] + dx, s[1] + dy];\n\t\t\t\t\t\t\ttool.extra.end = [e[0] + dx, e[1] + dy];\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst end = () => {\n\t\t\t\t\t\t\ttool.setEvent('mouseup deselect mousemove', null);\n\t\t\t\t\t\t};\n\t\t\t\t\t\ttool.setEvent('deselect', end);\n\t\t\t\t\t\ttool.setEvent('mouseup', (mouse, event) => {\n\t\t\t\t\t\t\tif (!(mouse.buttons & 1)) {\n\t\t\t\t\t\t\t\tend();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t}\n\t\t\t\t} else if (mouse.buttons === 2 && tool.extra.end && isInside()) {\n\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\tvar cvs = dlarea(s[0], s[1], e[0] - s[0], e[1] - s[1], b => {\n\t\t\t\t\t\tvar url = URL.createObjectURL(b);\n\t\t\t\t\t\tvar img = new Image();\n\t\t\t\t\t\timg.onload = () => {\n\t\t\t\t\t\t\twindowSys.addWindow(new GUIWindow(\"Resulting image\", {\n\t\t\t\t\t\t\t\tcenterOnce: true,\n\t\t\t\t\t\t\t\tcloseable: true\n\t\t\t\t\t\t\t}, function(win) {\n\t\t\t\t\t\t\t\tvar props = ['width', 'height'];\n\t\t\t\t\t\t\t\tif (img.width > img.height) {\n\t\t\t\t\t\t\t\t\tprops.reverse();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar r = img[props[0]] / img[props[1]];\n\t\t\t\t\t\t\t\tvar shownSize = img[props[1]] >= 128 ? 256 : 128;\n\t\t\t\t\t\t\t\timg[props[0]] = r * shownSize;\n\t\t\t\t\t\t\t\timg[props[1]] = shownSize;\n\t\t\t\t\t\t\t\twin.container.classList.add('centeredChilds')\n\t\t\t\t\t\t\t\tvar image = win.addObj(img);\n\t\t\t\t\t\t\t\tsetTooltip(img, \"Right click to copy/save!\");\n\t\t\t\t\t\t\t\t/*var okButton = win.addObj(mkHTML(\"button\", {\n\t\t\t\t\t\t\t\t\tinnerHTML: \"OK\",\n\t\t\t\t\t\t\t\t\tstyle: \"display: block; width: 80px; height: 30px; margin: auto;\",\n\t\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\t\timg.remove();\n\t\t\t\t\t\t\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t\t\t\t\t\t\t\twin.getWindow().close();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}));*/\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t};\n\t\t\t\t\t\timg.src = url;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t));\n\n\t// Fill tool\n\taddTool(new Tool('Fill', cursors.fill, PLAYERFX.NONE, RANK.USER, tool => {\n\t\ttool.extra.tickAmount = 9;\n\t\tvar queue = [];\n\t\tvar fillingColor = null;\n\t\tvar defaultFx = PLAYERFX.RECT_SELECT_ALIGNED(1);\n\t\ttool.setFxRenderer((fx, ctx, time) => {\n\t\t\tctx.globalAlpha = 0.8;\n\t\t\tctx.strokeStyle = fx.extra.player.htmlRgb;\n\t\t\tvar z = camera.zoom;\n\t\t\tif (!fillingColor || !fx.extra.isLocalPlayer) {\n\t\t\t\tdefaultFx(fx, ctx, time);\n\t\t\t} else {\n\t\t\t\tctx.beginPath();\n\t\t\t\tfor (var i = 0; i < queue.length; i++) {\n\t\t\t\t\tctx.rect((queue[i][0] - camera.x) * z, (queue[i][1] - camera.y) * z, z, z);\n\t\t\t\t}\n\t\t\t\tctx.stroke();\n\t\t\t}\n\t\t});\n\t\tfunction tick() {\n\t\t\tconst eq = (a, b) => a && b && a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n\t\t\tconst check = (x, y) => {\n\t\t\t\tif (eq(misc.world.getPixel(x, y), fillingColor)) {\n\t\t\t\t\tqueue.unshift([x, y]);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tif (!queue.length || !fillingColor) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar selClr = player.selectedColor;\n\t\t\tvar painted = 0;\n\t\t\tvar tickAmount = tool.extra.tickAmount;\n\t\t\tif (keysDown[17]) { /* Ctrl */\n\t\t\t\ttickAmount *= 3;\n\t\t\t}\n\n\t\t\tfor (var painted = 0; painted < tickAmount && queue.length; painted++) {\n\t\t\t\tvar current = queue.pop();\n\t\t\t\tvar x = current[0];\n\t\t\t\tvar y = current[1];\n\t\t\t\tvar thisClr = misc.world.getPixel(x, y);\n\t\t\t\tif (eq(thisClr, fillingColor) && !eq(thisClr, selClr)) {\n\t\t\t\t\tif (!misc.world.setPixel(x, y, selClr)) {\n\t\t\t\t\t\tqueue.push(current);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\t// diamond check first\n\t\t\t\t\tvar top = check(x, y - 1);\n\t\t\t\t\tvar bottom = check(x, y + 1);\n\t\t\t\t\tvar left = check(x - 1, y);\n\t\t\t\t\tvar right = check(x + 1, y);\n\n\t\t\t\t\t// if corners are not closed by parts of the diamond, then they can be accessed\n\t\t\t\t\tif (top && left) {\n\t\t\t\t\t\tcheck(x - 1, y - 1);\n\t\t\t\t\t}\n\t\t\t\t\tif (top && right) {\n\t\t\t\t\t\tcheck(x + 1, y - 1);\n\t\t\t\t\t}\n\t\t\t\t\tif (bottom && left) {\n\t\t\t\t\t\tcheck(x - 1, y + 1);\n\t\t\t\t\t}\n\t\t\t\t\tif (bottom && right) {\n\t\t\t\t\t\tcheck(x + 1, y + 1);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Shape diamond, infra not like\n\t\t\t\t\t/*check(x    , y - 1);\n\t\t\t\t\tcheck(x - 1, y    );\n\t\t\t\t\tcheck(x + 1, y    );\n\t\t\t\t\tcheck(x    , y + 1);*/\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ttool.setEvent('mousedown', mouse => {\n\t\t\tif (!(mouse.buttons & 0b100)) {\n\t\t\t\tfillingColor = misc.world.getPixel(mouse.tileX, mouse.tileY);\n\t\t\t\tif (fillingColor) {\n\t\t\t\t\tqueue.push([mouse.tileX, mouse.tileY]);\n\t\t\t\t\ttool.setEvent('tick', tick);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\ttool.setEvent('mouseup deselect', mouse => {\n\t\t\tif (!mouse || !(mouse.buttons & 0b1)) {\n\t\t\t\tfillingColor = null;\n\t\t\t\tqueue = [];\n\t\t\t\ttool.setEvent('tick', null);\n\t\t\t}\n\t\t});\n\t}));\n\n\taddTool(new Tool('Line', cursors.wand, PLAYERFX.NONE, RANK.USER, tool => {\n\t\tvar start = null;\n\t\tvar end = null;\n\t\tvar queue = [];\n\t\tfunction line(x1, y1, x2, y2, plot) {\n\t\t\tvar dx =  Math.abs(x2 - x1), sx = x1 < x2 ? 1 : -1;\n\t\t\tvar dy = -Math.abs(y2 - y1), sy = y1 < y2 ? 1 : -1;\n\t\t\tvar err = dx + dy,\n\t\t\t\te2;\n\n\t\t\twhile(true) {\n\t\t\t\tplot(x1, y1);\n\t\t\t\tif (x1 == x2 && y1 == y2) break;\n\t\t\t\te2 = 2 * err;\n\t\t\t\tif (e2 >= dy) { err += dy; x1 += sx; }\n\t\t\t\tif (e2 <= dx) { err += dx; y1 += sy; }\n\t\t\t}\n\t\t}\n\t\tvar defaultFx = PLAYERFX.RECT_SELECT_ALIGNED(1);\n\t\ttool.setFxRenderer((fx, ctx, time) => {\n\t\t\tctx.globalAlpha = 0.8;\n\t\t\tctx.strokeStyle = fx.extra.player.htmlRgb;\n\t\t\tvar z = camera.zoom;\n\t\t\tif (!start || !end || !fx.extra.isLocalPlayer) {\n\t\t\t\tdefaultFx(fx, ctx, time);\n\t\t\t} else {\n\t\t\t\tctx.beginPath();\n\t\t\t\tline(start[0], start[1], end[0], end[1], (x, y) => {\n\t\t\t\t\tctx.rect((x - camera.x) * camera.zoom, (y - camera.y) * camera.zoom, camera.zoom, camera.zoom);\n\t\t\t\t});\n\t\t\t\tctx.stroke();\n\t\t\t}\n\t\t});\n\t\tfunction tick() {\n\t\t\tfor (var painted = 0; painted < 3 && queue.length; painted++) {\n\t\t\t\tvar current = queue.pop();\n\t\t\t\tvar c = misc.world.getPixel(current[0], current[1]);\n\t\t\t\tvar pc = player.selectedColor;\n\t\t\t\tif ((c[0] != pc[0] || c[1] != pc[1] || c[2] != pc[2]) && !misc.world.setPixel(current[0], current[1], player.selectedColor)) {\n\t\t\t\t\tqueue.push(current);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!queue.length) {\n\t\t\t\tstart = null;\n\t\t\t\tend = null;\n\t\t\t\ttool.setEvent('tick', null);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\ttool.setEvent('mousedown', mouse => {\n\t\t\tif (!(mouse.buttons & 0b100)) {\n\t\t\t\tqueue = [];\n\t\t\t\ttool.setEvent('tick', null);\n\t\t\t\tstart = [mouse.tileX, mouse.tileY];\n\t\t\t\tend = [mouse.tileX, mouse.tileY];\n\t\t\t}\n\t\t});\n\t\ttool.setEvent('mousemove', mouse => {\n\t\t\tif (!queue.length) {\n\t\t\t\tend = [mouse.tileX, mouse.tileY];\n\t\t\t}\n\t\t});\n\t\ttool.setEvent('mouseup', mouse => {\n\t\t\tif (!(mouse.buttons & 0b11) && !queue.length) {\n\t\t\t\tend = [mouse.tileX, mouse.tileY];\n\t\t\t\tif (!start) {\n\t\t\t\t\tend = null;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (player.rank == RANK.ADMIN) {\n\t\t\t\t\tline(start[0], start[1], end[0], end[1], (x, y) => {\n\t\t\t\t\t\tmisc.world.setPixel(x, y, player.selectedColor);\n\t\t\t\t\t});\n\t\t\t\t\tstart = null;\n\t\t\t\t\tend = null;\n\t\t\t\t} else {\n\t\t\t\t\tline(start[0], start[1], end[0], end[1], (x, y) => {\n\t\t\t\t\t\tqueue.push([x, y]);\n\t\t\t\t\t});\n\t\t\t\t\ttool.setEvent('tick', tick);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\ttool.setEvent('deselect', mouse => {\n\t\t\tqueue = [];\n\t\t\tstart = null;\n\t\t\tend = null;\n\t\t\ttool.setEvent('tick', null);\n\t\t});\n\t}));\n\n\taddTool(new Tool('Protect', cursors.shield, PLAYERFX.RECT_SELECT_ALIGNED(16, \"#000000\"), RANK.MODERATOR, tool => {\n\t\ttool.setFxRenderer((fx, ctx, time) => {\n\t\t\tvar x = fx.extra.player.x;\n\t\t\tvar y = fx.extra.player.y;\n\t\t\tvar fxx = (Math.floor(x / 256) * 16 - camera.x) * camera.zoom;\n\t\t\tvar fxy = (Math.floor(y / 256) * 16 - camera.y) * camera.zoom;\n\t\t\tctx.globalAlpha = 0.5;\n\t\t\tvar chunkX = Math.floor(fx.extra.player.tileX / protocol.chunkSize);\n\t\t\tvar chunkY = Math.floor(fx.extra.player.tileY / protocol.chunkSize);\n\t\t\tvar chunk = misc.world.getChunkAt(chunkX, chunkY);\n\t\t\tif (chunk) {\n\t\t\t\tctx.fillStyle = chunk.locked ? \"#00FF00\" : \"#FF0000\";\n\t\t\t\tctx.fillRect(fxx, fxy, camera.zoom * 16, camera.zoom * 16);\n\t\t\t}\n\t\t\treturn 1; /* Rendering finished (won't change on next frame) */\n\t\t});\n\t\ttool.setEvent('mousedown mousemove', mouse => {\n\t\t\tvar chunkX = Math.floor(mouse.tileX / protocol.chunkSize);\n\t\t\tvar chunkY = Math.floor(mouse.tileY / protocol.chunkSize);\n\t\t\tvar chunk = misc.world.getChunkAt(chunkX, chunkY);\n\t\t\tswitch (mouse.buttons) {\n\t\t\t\tcase 0b1:\n\t\t\t\t\tif (!chunk.locked) {\n\t\t\t\t\t\tnet.protocol.protectChunk(chunkX, chunkY, 1);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0b10:\n\t\t\t\t\tif (chunk.locked) {\n\t\t\t\t\t\tnet.protocol.protectChunk(chunkX, chunkY, 0);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}));\n\n\taddTool(new Tool('Area Protect', cursors.selectprotect, PLAYERFX.NONE, RANK.MODERATOR,\n\t\ttool => {\n\t\t\ttool.setFxRenderer((fx, ctx, time) => {\n\t\t\t\tif (!fx.extra.isLocalPlayer) return 1;\n\t\t\t\tvar x = fx.extra.player.x;\n\t\t\t\tvar y = fx.extra.player.y;\n\t\t\t\tvar fxx = (Math.round(x / 256) * protocol.chunkSize - camera.x) * camera.zoom;\n\t\t\t\tvar fxy = (Math.round(y / 256) * protocol.chunkSize - camera.y) * camera.zoom;\n\t\t\t\tvar oldlinew = ctx.lineWidth;\n\t\t\t\tctx.lineWidth = 1;\n\t\t\t\tif (tool.extra.end) {\n\t\t\t\t\tvar s = tool.extra.start;\n\t\t\t\t\tvar e = tool.extra.end;\n\t\t\t\t\tvar x = (s[0] * protocol.chunkSize - camera.x) * camera.zoom + 0.5;\n\t\t\t\t\tvar y = (s[1] * protocol.chunkSize - camera.y) * camera.zoom + 0.5;\n\t\t\t\t\tvar rw = (e[0] - s[0]);\n\t\t\t\t\tvar rh = (e[1] - s[1]);\n\t\t\t\t\tvar w = rw * camera.zoom * protocol.chunkSize;\n\t\t\t\t\tvar h = rh * camera.zoom * protocol.chunkSize;\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.rect(x, y, w, h);\n\t\t\t\t\tctx.globalAlpha = 1;\n\t\t\t\t\tctx.strokeStyle = \"#FFFFFF\";\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tctx.setLineDash([3, 4]);\n\t\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tif (tool.extra.isSure) {\n\t\t\t\t\t\tctx.globalAlpha = 0.6;\n\t\t\t\t\t\tctx.fillStyle = \"#00EE00\";\n\t\t\t\t\t\tctx.fill();\n\t\t\t\t\t}\n\t\t\t\t\tctx.globalAlpha = 0.25 + Math.sin(time / 500) / 4;\n\t\t\t\t\tctx.fillStyle = renderer.patterns.unloaded;\n\t\t\t\t\tctx.fill();\n\t\t\t\t\tctx.setLineDash([]);\n\t\t\t\t\tvar oldfont = ctx.font;\n\t\t\t\t\tctx.font = \"16px sans-serif\";\n\t\t\t\t\tvar txt = `${tool.extra.isSure ? \"Click again to confirm. \" : (!tool.extra.clicking ? \"Left/Right click to add/remove protection, respectively. \" : \"\")}(${Math.abs(rw)}x${Math.abs(rh)})`;\n\t\t\t\t\tvar txtx = window.innerWidth >> 1;\n\t\t\t\t\tvar txty = window.innerHeight >> 1;\n\t\t\t\t\ttxtx = Math.max(x, Math.min(txtx, x + w));\n\t\t\t\t\ttxty = Math.max(y, Math.min(txty, y + h));\n\n\t\t\t\t\tdrawText(ctx, txt, txtx, txty, true);\n\t\t\t\t\tctx.font = oldfont;\n\t\t\t\t\tctx.lineWidth = oldlinew;\n\t\t\t\t\treturn 0;\n\t\t\t\t} else {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(0, fxy + 0.5);\n\t\t\t\t\tctx.lineTo(window.innerWidth, fxy + 0.5);\n\t\t\t\t\tctx.moveTo(fxx + 0.5, 0);\n\t\t\t\t\tctx.lineTo(fxx + 0.5, window.innerHeight);\n\n\t\t\t\t\t//ctx.lineWidth = 1;\n\t\t\t\t\tctx.globalAlpha = 1;\n\t\t\t\t\tctx.strokeStyle = \"#FFFFFF\";\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tctx.setLineDash([3]);\n\t\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\t\tctx.stroke();\n\n\t\t\t\t\tctx.setLineDash([]);\n\t\t\t\t\tctx.lineWidth = oldlinew;\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\ttool.extra.start = null;\n\t\t\ttool.extra.end = null;\n\t\t\ttool.extra.clicking = false;\n\t\t\ttool.extra.isSure = false;\n\n\t\t\tvar timeout = null;\n\n\t\t\tconst sure = () => {\n\t\t\t\tif (tool.extra.isSure) {\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\ttimeout = null;\n\t\t\t\t\ttool.extra.isSure = false;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\ttool.extra.isSure = true;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\ttool.extra.isSure = false;\n\t\t\t\t\ttimeout = null;\n\t\t\t\t}, 1000);\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\ttool.setEvent('mousedown', (mouse, event) => {\n\t\t\t\tvar get = {\n\t\t\t\t\trx() { return mouse.tileX / protocol.chunkSize; },\n\t\t\t\t\try() { return mouse.tileY / protocol.chunkSize },\n\t\t\t\t\tx() { return Math.round(mouse.tileX / protocol.chunkSize); },\n\t\t\t\t\ty() { return Math.round(mouse.tileY / protocol.chunkSize); }\n\t\t\t\t};\n\t\t\t\tvar s = tool.extra.start;\n\t\t\t\tvar e = tool.extra.end;\n\t\t\t\tconst isInside = () => get.rx() >= s[0] && get.rx() < e[0] && get.ry() >= s[1] && get.ry() < e[1];\n\t\t\t\tconst isChunkSolid = chunk => {\n\t\t\t\t\tvar lastClr = chunk.get(0, 0);\n\t\t\t\t\treturn chunk.forEach((x, y, clr) => clr === lastClr);\n\t\t\t\t};\n\n\t\t\t\tif (mouse.buttons === 1 && !tool.extra.end) {\n\t\t\t\t\ttool.extra.start = [get.x(), get.y()];\n\t\t\t\t\ttool.extra.clicking = true;\n\t\t\t\t\ttool.setEvent('mousemove', (mouse, event) => {\n\t\t\t\t\t\tif (tool.extra.start && mouse.buttons === 1) {\n\t\t\t\t\t\t\ttool.extra.end = [get.x(), get.y()];\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst finish = () => {\n\t\t\t\t\t\ttool.setEvent('mousemove mouseup deselect', null);\n\t\t\t\t\t\ttool.extra.clicking = false;\n\t\t\t\t\t\tvar s = tool.extra.start;\n\t\t\t\t\t\tvar e = tool.extra.end;\n\t\t\t\t\t\tif (e) {\n\t\t\t\t\t\t\tif (s[0] === e[0] || s[1] === e[1]) {\n\t\t\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (s[0] > e[0]) {\n\t\t\t\t\t\t\t\tvar tmp = e[0];\n\t\t\t\t\t\t\t\te[0] = s[0];\n\t\t\t\t\t\t\t\ts[0] = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (s[1] > e[1]) {\n\t\t\t\t\t\t\t\tvar tmp = e[1];\n\t\t\t\t\t\t\t\te[1] = s[1];\n\t\t\t\t\t\t\t\ts[1] = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trenderer.render(renderer.rendertype.FX);\n\t\t\t\t\t};\n\t\t\t\t\ttool.setEvent('deselect', finish);\n\t\t\t\t\ttool.setEvent('mouseup', (mouse, event) => {\n\t\t\t\t\t\tif (!(mouse.buttons & 1)) {\n\t\t\t\t\t\t\tfinish();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else if (mouse.buttons === 1 && tool.extra.end) {\n\t\t\t\t\tif (isInside() && sure()) {\n\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t\tvar [x, y, w, h] = [s[0], s[1], e[0] - s[0], e[1] - s[1]];\n\t\t\t\t\t\tfor (var i = x; i < x + w; i++) {\n\t\t\t\t\t\t\tfor (var j = y; j < y + h; j++) {\n\t\t\t\t\t\t\t\tvar chunk = misc.world.getChunkAt(i, j);\n\t\t\t\t\t\t\t\tif (chunk && !chunk.locked) {\n\t\t\t\t\t\t\t\t\tif (keysDown[17] && isChunkSolid(chunk)) {\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tnet.protocol.protectChunk(i, j, 1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (!isInside()) {\n\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t}\n\t\t\t\t} else if (mouse.buttons === 2 && tool.extra.end && isInside() && sure()) {\n\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\tvar [x, y, w, h] = [s[0], s[1], e[0] - s[0], e[1] - s[1]];\n\t\t\t\t\tfor (var i = x; i < x + w; i++) {\n\t\t\t\t\t\tfor (var j = y; j < y + h; j++) {\n\t\t\t\t\t\t\tvar chunk = misc.world.getChunkAt(i, j);\n\t\t\t\t\t\t\tif (chunk && chunk.locked) {\n\t\t\t\t\t\t\t\tif (keysDown[17] && !isChunkSolid(chunk)) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnet.protocol.protectChunk(i, j, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t));\n\n\taddTool(new Tool('Area Delete', cursors.areadelete, PLAYERFX.NONE, RANK.ADMIN,\n\t\ttool => {\n\t\t\ttool.setFxRenderer((fx, ctx, time) => {\n\t\t\t\tif (!fx.extra.isLocalPlayer) return 1;\n\t\t\t\tvar x = fx.extra.player.x;\n\t\t\t\tvar y = fx.extra.player.y;\n\t\t\t\tvar fxx = (Math.round(x / 256) * protocol.chunkSize - camera.x) * camera.zoom;\n\t\t\t\tvar fxy = (Math.round(y / 256) * protocol.chunkSize - camera.y) * camera.zoom;\n\t\t\t\tvar oldlinew = ctx.lineWidth;\n\t\t\t\tctx.lineWidth = 1;\n\t\t\t\tif (tool.extra.end) {\n\t\t\t\t\tvar s = tool.extra.start;\n\t\t\t\t\tvar e = tool.extra.end;\n\t\t\t\t\tvar x = (s[0] * protocol.chunkSize - camera.x) * camera.zoom + 0.5;\n\t\t\t\t\tvar y = (s[1] * protocol.chunkSize - camera.y) * camera.zoom + 0.5;\n\t\t\t\t\tvar rw = (e[0] - s[0]);\n\t\t\t\t\tvar rh = (e[1] - s[1]);\n\t\t\t\t\tvar w = rw * camera.zoom * protocol.chunkSize;\n\t\t\t\t\tvar h = rh * camera.zoom * protocol.chunkSize;\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.rect(x, y, w, h);\n\t\t\t\t\tctx.globalAlpha = 1;\n\t\t\t\t\tctx.strokeStyle = \"#FFFFFF\";\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tctx.setLineDash([3, 4]);\n\t\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tif (tool.extra.isSure) {\n\t\t\t\t\t\tctx.globalAlpha = 0.6;\n\t\t\t\t\t\tctx.fillStyle = \"#00EE00\";\n\t\t\t\t\t\tctx.fill();\n\t\t\t\t\t}\n\t\t\t\t\tctx.globalAlpha = 0.25 + Math.sin(time / 500) / 4;\n\t\t\t\t\tctx.fillStyle = renderer.patterns.unloaded;\n\t\t\t\t\tctx.fill();\n\t\t\t\t\tctx.setLineDash([]);\n\t\t\t\t\tvar oldfont = ctx.font;\n\t\t\t\t\tctx.font = \"16px sans-serif\";\n\t\t\t\t\tvar txt = `${tool.extra.isSure ? \"Click again to confirm. \" : (!tool.extra.clicking ? \"Double click to delete. \" : \"\")}(${Math.abs(rw)}x${Math.abs(rh)})`;\n\t\t\t\t\tvar txtx = window.innerWidth >> 1;\n\t\t\t\t\tvar txty = window.innerHeight >> 1;\n\t\t\t\t\ttxtx = Math.max(x, Math.min(txtx, x + w));\n\t\t\t\t\ttxty = Math.max(y, Math.min(txty, y + h));\n\n\t\t\t\t\tdrawText(ctx, txt, txtx, txty, true);\n\t\t\t\t\tctx.font = oldfont;\n\t\t\t\t\tctx.lineWidth = oldlinew;\n\t\t\t\t\treturn 0;\n\t\t\t\t} else {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(0, fxy + 0.5);\n\t\t\t\t\tctx.lineTo(window.innerWidth, fxy + 0.5);\n\t\t\t\t\tctx.moveTo(fxx + 0.5, 0);\n\t\t\t\t\tctx.lineTo(fxx + 0.5, window.innerHeight);\n\n\t\t\t\t\t//ctx.lineWidth = 1;\n\t\t\t\t\tctx.globalAlpha = 1;\n\t\t\t\t\tctx.strokeStyle = \"#FFFFFF\";\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tctx.setLineDash([3]);\n\t\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\t\tctx.stroke();\n\n\t\t\t\t\tctx.setLineDash([]);\n\t\t\t\t\tctx.lineWidth = oldlinew;\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\ttool.extra.start = null;\n\t\t\ttool.extra.end = null;\n\t\t\ttool.extra.clicking = false;\n\t\t\ttool.extra.isSure = false;\n\n\t\t\tvar timeout = null;\n\n\t\t\tconst sure = () => {\n\t\t\t\tif (tool.extra.isSure) {\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\ttimeout = null;\n\t\t\t\t\ttool.extra.isSure = false;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\ttool.extra.isSure = true;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\ttool.extra.isSure = false;\n\t\t\t\t\ttimeout = null;\n\t\t\t\t}, 1000);\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\ttool.setEvent('mousedown', (mouse, event) => {\n\t\t\t\tvar get = {\n\t\t\t\t\trx() { return mouse.tileX / protocol.chunkSize; },\n\t\t\t\t\try() { return mouse.tileY / protocol.chunkSize },\n\t\t\t\t\tx() { return Math.round(mouse.tileX / protocol.chunkSize); },\n\t\t\t\t\ty() { return Math.round(mouse.tileY / protocol.chunkSize); }\n\t\t\t\t};\n\t\t\t\tvar s = tool.extra.start;\n\t\t\t\tvar e = tool.extra.end;\n\t\t\t\tconst isInside = () => get.rx() >= s[0] && get.rx() < e[0] && get.ry() >= s[1] && get.ry() < e[1];\n\t\t\t\tif (mouse.buttons === 1 && !tool.extra.end) {\n\t\t\t\t\ttool.extra.start = [get.x(), get.y()];\n\t\t\t\t\ttool.extra.clicking = true;\n\t\t\t\t\ttool.setEvent('mousemove', (mouse, event) => {\n\t\t\t\t\t\tif (tool.extra.start && mouse.buttons === 1) {\n\t\t\t\t\t\t\ttool.extra.end = [get.x(), get.y()];\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst finish = () => {\n\t\t\t\t\t\ttool.setEvent('mousemove mouseup deselect', null);\n\t\t\t\t\t\ttool.extra.clicking = false;\n\t\t\t\t\t\tvar s = tool.extra.start;\n\t\t\t\t\t\tvar e = tool.extra.end;\n\t\t\t\t\t\tif (e) {\n\t\t\t\t\t\t\tif (s[0] === e[0] || s[1] === e[1]) {\n\t\t\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (s[0] > e[0]) {\n\t\t\t\t\t\t\t\tvar tmp = e[0];\n\t\t\t\t\t\t\t\te[0] = s[0];\n\t\t\t\t\t\t\t\ts[0] = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (s[1] > e[1]) {\n\t\t\t\t\t\t\t\tvar tmp = e[1];\n\t\t\t\t\t\t\t\te[1] = s[1];\n\t\t\t\t\t\t\t\ts[1] = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trenderer.render(renderer.rendertype.FX);\n\t\t\t\t\t};\n\t\t\t\t\ttool.setEvent('deselect', finish);\n\t\t\t\t\ttool.setEvent('mouseup', (mouse, event) => {\n\t\t\t\t\t\tif (!(mouse.buttons & 1)) {\n\t\t\t\t\t\t\tfinish();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else if (mouse.buttons === 1 && tool.extra.end) {\n\t\t\t\t\tif (isInside() && sure()) {\n\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t\tvar [x, y, w, h] = [s[0], s[1], e[0] - s[0], e[1] - s[1]];\n\t\t\t\t\t\tfor (var i = x; i < x + w; i++) {\n\t\t\t\t\t\t\tfor (var j = y; j < y + h; j++) {\n\t\t\t\t\t\t\t\tvar chunk = misc.world.getChunkAt(i, j);\n\t\t\t\t\t\t\t\tif (chunk && !chunk.locked) {\n\t\t\t\t\t\t\t\t\tnet.protocol.clearChunk(i, j, player.selectedColor);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (!isInside()) {\n\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t}\n\t\t\t\t} else if (mouse.buttons === 2 && tool.extra.end) {\n\t\t\t\t\tif (isInside() && sure()) {\n\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t\tvar [x, y, w, h] = [s[0], s[1], e[0] - s[0], e[1] - s[1]];\n\t\t\t\t\t\tfor (var i = x; i < x + w; i++) {\n\t\t\t\t\t\t\tfor (var j = y; j < y + h; j++) {\n\t\t\t\t\t\t\t\tvar chunk = misc.world.getChunkAt(i, j);\n\t\t\t\t\t\t\t\tif (chunk && !chunk.locked) {\n\t\t\t\t\t\t\t\t\tnet.protocol.clearChunk(i, j, [255, 255, 255]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (!isInside()) {\n\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t));\n\n\taddTool(new Tool('Paste', cursors.paste, PLAYERFX.NONE, RANK.ADMIN, tool => {\n\t\ttool.extra.sendQueue = [];\n\n\t\ttool.setFxRenderer((fx, ctx, time) => {\n\t\t\tvar z = camera.zoom;\n\t\t\tvar x = fx.extra.player.x;\n\t\t\tvar y = fx.extra.player.y;\n\t\t\tvar fxx = Math.floor(x / 16) - camera.x;\n\t\t\tvar fxy = Math.floor(y / 16) - camera.y;\n\n\t\t\tvar q = tool.extra.sendQueue;\n\t\t\tif (q.length) {\n\t\t\t\tvar cs = protocol.chunkSize;\n\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\tctx.globalAlpha = 0.8;\n\t\t\t\tctx.beginPath();\n\t\t\t\tfor (var i = 0; i < q.length; i++) {\n\t\t\t\t\tctx.rect((q[i].x * cs - camera.x) * z, (q[i].y * cs - camera.y) * z, z * cs, z * cs);\n\t\t\t\t}\n\t\t\t\tctx.stroke();\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif (tool.extra.canvas && fx.extra.isLocalPlayer) {\n\t\t\t\tctx.globalAlpha = 0.5 + Math.sin(time / 500) / 4;\n\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\tctx.scale(z, z);\n\t\t\t\tctx.drawImage(tool.extra.canvas, fxx, fxy);\n\t\t\t\tctx.scale(1 / z, 1 / z);\n\t\t\t\tctx.globalAlpha = 0.8;\n\t\t\t\tctx.strokeRect(fxx * z, fxy * z, tool.extra.canvas.width * z, tool.extra.canvas.height * z);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\n\t\tconst paint = (tileX, tileY) => {\n\t\t\tvar tmpBuffer = new Uint32Array(protocol.chunkSize * protocol.chunkSize);\n\t\t\tvar ctx = tool.extra.canvas.getContext(\"2d\");\n\t\t\tvar dat = ctx.getImageData(0, 0, tool.extra.canvas.width, tool.extra.canvas.height);\n\t\t\tvar u32dat = new Uint32Array(dat.data.buffer);\n\t\t\tvar totalChunksW = Math.ceil((absMod(tileX, protocol.chunkSize) + dat.width) / protocol.chunkSize);\n\t\t\tvar totalChunksH = Math.ceil((absMod(tileY, protocol.chunkSize) + dat.height) / protocol.chunkSize);\n\t\t\tconst getModifiedPixel = (x, y) => {\n\t\t\t\tvar imgY = y - tileY;\n\t\t\t\tvar imgX = x - tileX;\n\t\t\t\tif (imgY < 0 || imgX < 0 || imgY >= dat.height || imgX >= dat.width) {\n\t\t\t\t\tvar currentPixel = misc.world.getPixel(x, y);\n\t\t\t\t\treturn currentPixel ? (currentPixel[2] << 16 | currentPixel[1] << 8 | currentPixel[0])\n\t\t\t\t\t\t: null;\n\t\t\t\t}\n\t\t\t\tvar img = u32dat[imgY * dat.width + imgX];\n\t\t\t\tvar oldPixel = misc.world.getPixel(x, y);\n\t\t\t\tvar alpha = img >> 24 & 0xFF;\n\t\t\t\tif (!oldPixel) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tvar r = (1 - alpha / 255) * oldPixel[0] + (alpha / 255) * (img       & 0xFF);\n\t\t\t\tvar g = (1 - alpha / 255) * oldPixel[1] + (alpha / 255) * (img >> 8  & 0xFF);\n\t\t\t\tvar b = (1 - alpha / 255) * oldPixel[2] + (alpha / 255) * (img >> 16 & 0xFF);\n\t\t\t\tvar rgb = b << 16 | g << 8 | r;\n\t\t\t\treturn (r == oldPixel[0] && g == oldPixel[1] && b == oldPixel[2]) ? rgb : 0xFF000000 | rgb;\n\t\t\t};\n\n\t\t\tconst getModifiedChunk = (chunkX, chunkY) => {\n\t\t\t\tvar modified = 0;\n\t\t\t\tvar offX = chunkX * protocol.chunkSize;\n\t\t\t\tvar offY = chunkY * protocol.chunkSize;\n\t\t\t\tfor (var y = 0; y < protocol.chunkSize; y++) {\n\t\t\t\t\tfor (var x = 0; x < protocol.chunkSize; x++) {\n\t\t\t\t\t\tvar color = getModifiedPixel(x + offX, y + offY);\n\t\t\t\t\t\tif (color !== null) {\n\t\t\t\t\t\t\tif (color & 0xFF000000) {\n\t\t\t\t\t\t\t\t++modified;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpBuffer[y * protocol.chunkSize + x] = color & 0xFFFFFF;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t/* Chunk not loaded... */\n\t\t\t\t\t\t\tthrow new Error(`Couldn't paste -- chunk (${chunkX}, ${chunkY}) is unloaded`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn modified ? tmpBuffer : null;\n\t\t\t};\n\t\t\tif (!net.protocol.setChunk) {\n\t\t\t\tthrow new Error(\"Protocol doesn't support pasting\");\n\t\t\t}\n\n\t\t\tfor (var y = Math.floor(tileY / protocol.chunkSize), t = totalChunksH; --t >= 0; y++) {\n\t\t\t\tfor (var x = Math.floor(tileX / protocol.chunkSize), tw = totalChunksW; --tw >= 0; x++) {\n\t\t\t\t\tvar newChunk = getModifiedChunk(x, y);\n\t\t\t\t\tif (newChunk) {\n\t\t\t\t\t\tif (!net.protocol.setChunk(x, y, newChunk)) {\n\t\t\t\t\t\t\tvar nbuf = new Uint32Array(newChunk.length);\n\t\t\t\t\t\t\tnbuf.set(newChunk);\n\t\t\t\t\t\t\ttool.extra.sendQueue.push({\n\t\t\t\t\t\t\t\tx: x,\n\t\t\t\t\t\t\t\ty: y,\n\t\t\t\t\t\t\t\tbuf: nbuf\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ttool.setEvent('tick', () => {\n\t\t\tvar q = tool.extra.sendQueue;\n\t\t\tif (q.length) {\n\t\t\t\tif (net.protocol.setChunk(q[0].x, q[0].y, q[0].buf)) {\n\t\t\t\t\tq.shift();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\ttool.setEvent('mousedown', mouse => {\n\t\t\tif (mouse.buttons & 0b1) {\n\t\t\t\tif (tool.extra.canvas) {\n\t\t\t\t\tif (tool.extra.sendQueue.length) {\n\t\t\t\t\t\tthrow new Error(\"Wait until pasting finishes, or cancel with right click!\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tpaint(mouse.tileX, mouse.tileY);\n\t\t\t\t}\n\t\t\t} else if (mouse.buttons & 0b10) {\n\t\t\t\ttool.extra.sendQueue = [];\n\t\t\t}\n\t\t});\n\n\t\tvar input = document.createElement(\"input\");\n\t\tinput.type = \"file\";\n\t\tinput.accept = \"image/*\";\n\t\ttool.setEvent('select', () => {\n\t\t\tinput.onchange = event => {\n\t\t\t\tif (input.files && input.files[0]) {\n\t\t\t\t\tvar reader = new FileReader();\n\t\t\t\t\treader.onload = e => {\n\t\t\t\t\t\tvar image = new Image();\n\t\t\t\t\t\timage.onload = () => {\n\t\t\t\t\t\t\ttool.extra.canvas = document.createElement(\"canvas\");\n\t\t\t\t\t\t\ttool.extra.canvas.width = image.width;\n\t\t\t\t\t\t\ttool.extra.canvas.height = image.height;\n\t\t\t\t\t\t\tvar ctx = tool.extra.canvas.getContext(\"2d\");\n\t\t\t\t\t\t\tctx.drawImage(image, 0, 0);\n\t\t\t\t\t\t\tconsole.log('Loaded image');\n\t\t\t\t\t\t};\n\t\t\t\t\t\timage.src = e.target.result;\n\t\t\t\t\t};\n\t\t\t\t\treader.readAsDataURL(input.files[0]);\n\t\t\t\t}\n\t\t\t};\n\t\t\tinput.click();\n\t\t});\n\t}));\n\n\taddTool(new Tool('Copy', cursors.copy, PLAYERFX.NONE, RANK.ADMIN, function (tool) {\n\t\tfunction drawText(ctx, str, x, y, centered) {\n\t\t\tctx.strokeStyle = \"#000000\", ctx.fillStyle = \"#FFFFFF\", ctx.lineWidth = 2.5, ctx.globalAlpha = 0.5;\n\t\t\tif (centered) {\n\t\t\t\tx -= ctx.measureText(str).width >> 1;\n\t\t\t}\n\t\t\tctx.strokeText(str, x, y);\n\t\t\tctx.globalAlpha = 1;\n\t\t\tctx.fillText(str, x, y);\n\t\t}\n\n\t\ttool.setFxRenderer(function (fx, ctx, time) {\n\t\t\tif (!fx.extra.isLocalPlayer) return 1;\n\t\t\tvar x = fx.extra.player.x;\n\t\t\tvar y = fx.extra.player.y;\n\t\t\tvar fxx = (Math.floor(x / 16) - camera.x) * camera.zoom;\n\t\t\tvar fxy = (Math.floor(y / 16) - camera.y) * camera.zoom;\n\t\t\tvar oldlinew = ctx.lineWidth;\n\t\t\tctx.lineWidth = 1;\n\t\t\tif (tool.extra.end) {\n\t\t\t\tvar s = tool.extra.start;\n\t\t\t\tvar e = tool.extra.end;\n\t\t\t\tvar x = (s[0] - camera.x) * camera.zoom + 0.5;\n\t\t\t\tvar y = (s[1] - camera.y) * camera.zoom + 0.5;\n\t\t\t\tvar w = e[0] - s[0];\n\t\t\t\tvar h = e[1] - s[1];\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.rect(x, y, w * camera.zoom, h * camera.zoom);\n\t\t\t\tctx.globalAlpha = 1;\n\t\t\t\tctx.strokeStyle = \"#FFFFFF\";\n\t\t\t\tctx.stroke();\n\t\t\t\tctx.setLineDash([3, 4]);\n\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\tctx.stroke();\n\t\t\t\tctx.globalAlpha = 0.25 + Math.sin(time / 500) / 4;\n\t\t\t\tctx.fillStyle = renderer.patterns.unloaded;\n\t\t\t\tctx.fill();\n\t\t\t\tctx.setLineDash([]);\n\t\t\t\tvar oldfont = ctx.font;\n\t\t\t\tctx.font = \"16px sans-serif\";\n\t\t\t\tvar txt = (!tool.extra.clicking ? \"Right click to copy \" : \"\") + '(' + Math.abs(w) + 'x' + Math.abs(h) + ')';\n\t\t\t\tvar txtx = window.innerWidth >> 1;\n\t\t\t\tvar txty = window.innerHeight >> 1;\n\t\t\t\ttxtx = Math.max(x, Math.min(txtx, x + w * camera.zoom));\n\t\t\t\ttxty = Math.max(y, Math.min(txty, y + h * camera.zoom));\n\n\t\t\t\tdrawText(ctx, txt, txtx, txty, true);\n\t\t\t\tctx.font = oldfont;\n\t\t\t\tctx.lineWidth = oldlinew;\n\t\t\t\treturn 0;\n\t\t\t} else {\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.moveTo(0, fxy + 0.5);\n\t\t\t\tctx.lineTo(window.innerWidth, fxy + 0.5);\n\t\t\t\tctx.moveTo(fxx + 0.5, 0);\n\t\t\t\tctx.lineTo(fxx + 0.5, window.innerHeight);\n\n\t\t\t\t//ctx.lineWidth = 1;\n\t\t\t\tctx.globalAlpha = 1;\n\t\t\t\tctx.strokeStyle = \"#FFFFFF\";\n\t\t\t\tctx.stroke();\n\t\t\t\tctx.setLineDash([3]);\n\t\t\t\tctx.strokeStyle = \"#000000\";\n\t\t\t\tctx.stroke();\n\n\t\t\t\tctx.setLineDash([]);\n\t\t\t\tctx.lineWidth = oldlinew;\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t});\n\n\t\ttool.extra.start = null;\n\t\ttool.extra.end = null;\n\t\ttool.extra.clicking = false;\n\n\t\ttool.setEvent('mousedown', function (mouse, event) {\n\t\t\tvar s = tool.extra.start;\n\t\t\tvar e = tool.extra.end;\n\t\t\tvar isInside = function isInside() {\n\t\t\t\treturn mouse.tileX >= s[0] && mouse.tileX < e[0] && mouse.tileY >= s[1] && mouse.tileY < e[1];\n\t\t\t};\n\t\t\tif (mouse.buttons === 1 && !tool.extra.end) {\n\t\t\t\ttool.extra.start = [mouse.tileX, mouse.tileY];\n\t\t\t\ttool.extra.clicking = true;\n\t\t\t\ttool.setEvent('mousemove', function (mouse, event) {\n\t\t\t\t\tif (tool.extra.start && mouse.buttons === 1) {\n\t\t\t\t\t\ttool.extra.end = [mouse.tileX, mouse.tileY];\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvar finish = function finish() {\n\t\t\t\t\ttool.setEvent('mousemove mouseup deselect', null);\n\t\t\t\t\ttool.extra.clicking = false;\n\t\t\t\t\tvar s = tool.extra.start;\n\t\t\t\t\tvar e = tool.extra.end;\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\tif (s[0] === e[0] || s[1] === e[1]) {\n\t\t\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (s[0] > e[0]) {\n\t\t\t\t\t\t\tvar tmp = e[0];\n\t\t\t\t\t\t\te[0] = s[0];\n\t\t\t\t\t\t\ts[0] = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (s[1] > e[1]) {\n\t\t\t\t\t\t\tvar tmp = e[1];\n\t\t\t\t\t\t\te[1] = s[1];\n\t\t\t\t\t\t\ts[1] = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trenderer.render(renderer.rendertype.FX);\n\t\t\t\t};\n\t\t\t\ttool.setEvent('deselect', finish);\n\t\t\t\ttool.setEvent('mouseup', function (mouse, event) {\n\t\t\t\t\tif (!(mouse.buttons & 1)) {\n\t\t\t\t\t\tfinish();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (mouse.buttons === 1 && tool.extra.end) {\n\t\t\t\tif (isInside()) {\n\t\t\t\t\tvar offx = mouse.tileX;\n\t\t\t\t\tvar offy = mouse.tileY;\n\t\t\t\t\ttool.setEvent('mousemove', function (mouse, event) {\n\t\t\t\t\t\tvar dx = mouse.tileX - offx;\n\t\t\t\t\t\tvar dy = mouse.tileY - offy;\n\t\t\t\t\t\ttool.extra.start = [s[0] + dx, s[1] + dy];\n\t\t\t\t\t\ttool.extra.end = [e[0] + dx, e[1] + dy];\n\t\t\t\t\t});\n\t\t\t\t\tvar end = function end() {\n\t\t\t\t\t   tool.setEvent('mouseup deselect mousemove', null);\n\t\t\t\t\t};\n\t\t\t\t\ttool.setEvent('deselect', end);\n\t\t\t\t\ttool.setEvent('mouseup', function (mouse, event) {\n\t\t\t\t\t\tif (!(mouse.buttons & 1)) {\n\t\t\t\t\t\t\tend();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\ttool.extra.start = null;\n\t\t\t\t\ttool.extra.end = null;\n\t\t\t\t}\n\t\t   } else if (mouse.buttons === 2 && tool.extra.end && isInside()) {\n\t\t\t\ttool.extra.start = null;\n\t\t\t\ttool.extra.end = null;\n\t\t\t\tvar x = s[0];\n\t\t\t\tvar y = s[1];\n\t\t\t\tvar w = e[0] - s[0];\n\t\t\t\tvar h = e[1] - s[1];\n\t\t\t\tvar c = document.createElement('canvas');\n\t\t\t\tc.width = w;\n\t\t\t\tc.height = h;\n\t\t\t\tvar ctx = c.getContext('2d');\n\t\t\t\tvar d = ctx.createImageData(w, h);\n\t\t\t\tfor (var i = y; i < y + h; i++) {\n\t\t\t\t\tfor (var j = x; j < x + w; j++) {\n\t\t\t\t\t\tvar pix = misc.world.getPixel(j, i);\n\t\t\t\t\t\tif (!pix) continue;\n\t\t\t\t\t\td.data[4 * ((i - y) * w + (j - x))] = pix[0];\n\t\t\t\t\t\td.data[4 * ((i - y) * w + (j - x)) + 1] = pix[1];\n\t\t\t\t\t\td.data[4 * ((i - y) * w + (j - x)) + 2] = pix[2];\n\t\t\t\t\t\td.data[4 * ((i - y) * w + (j - x)) + 3] = 255;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tctx.putImageData(d, 0, 0);\n\t\t\t\tvar paste = tools.paste;\n\t\t\t\tpaste.extra.canvas = c;\n\t\t\t\tvar oldSelect = paste.events.select;\n\t\t\t\tpaste.events.select = function() {\n\t\t\t\t\tpaste.events.select = oldSelect;\n\t\t\t\t};\n\t\t\t\tplayer.tool = \"paste\";\n\t\t\t}\n\t\t});\n\t}));\n\n\teventSys.emit(e.misc.toolsInitialized);\n});\n\neventSys.once(e.init, () => {\n\ttoolsWindow = new GUIWindow('Tools', {}, wdow => {\n\t\twdow.container.id = \"toole-container\";\n\t\twdow.container.style.cssText = \"max-width: 40px\";\n\t}).move(5, 32);\n});\n\neventSys.once(e.misc.toolsInitialized, () => {\n\tupdateToolbar();\n\tif (windowShown) {\n\t\twindowSys.addWindow(toolsWindow);\n\t}\n});\n\neventSys.on(e.net.disconnected, () => {\n\tshowToolsWindow(false);\n});\n\neventSys.on(e.misc.worldInitialized, () => {\n\tshowToolsWindow(true);\n});\n","'use strict';\n\nexport class Bucket {\n\tconstructor(rate, time) {\n\t\tthis.lastCheck = Date.now();\n\t\tthis.allowance = rate;\n\t\tthis.rate = rate;\n\t\tthis.time = time;\n\t\tthis.infinite = false;\n\t}\n\t\n\tcanSpend(count) {\n\t\tif (this.infinite) {\n\t\t\treturn true;\n\t\t}\n\t\t\n\t\tthis.allowance += (Date.now() - this.lastCheck) / 1000 * (this.rate / this.time);\n\t\tthis.lastCheck = Date.now();\n\t\tif (this.allowance > this.rate) {\n\t\t\tthis.allowance = this.rate;\n\t\t}\n\t\tif (this.allowance < count) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.allowance -= count;\n\t\treturn true;\n\t}\n}\n","'use strict';\nimport { getTime } from './misc.js';\n\n/* Time function, time will be updated by the renderer */\nconst time = getTime /*() => getTime(true)*/;\n\nexport class Lerp {\n    constructor(start, end, ms) {\n        this.start = start;\n        this.end = end;\n        this.ms = ms;\n        this.time = time();\n    }\n\n    get val() {\n        let amt = Math.min((time() - this.time) / this.ms, 1);\n        return (1 - amt) * this.start + amt * this.end;\n    }\n\n    set val(v) {\n        this.start = this.val;\n        this.end = v;\n        this.time = time(true);\n    }\n}\n","!function(e,a){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=a():\"function\"==typeof define&&define.amd?define(a):e.anchorme=a()}(this,function(){\"use strict\";function e(e,a){return a={exports:{}},e(a,a.exports),a.exports}var a=e(function(e,a){function n(e){return e||(e={attributes:[],ips:!0,emails:!0,urls:!0,files:!0,truncate:1/0,defaultProtocol:\"http://\",list:!1}),\"object\"!=typeof e.attributes&&(e.attributes=[]),\"boolean\"!=typeof e.ips&&(e.ips=!0),\"boolean\"!=typeof e.emails&&(e.emails=!0),\"boolean\"!=typeof e.urls&&(e.urls=!0),\"boolean\"!=typeof e.files&&(e.files=!0),\"boolean\"!=typeof e.list&&(e.list=!1),\"string\"!=typeof e.defaultProtocol&&\"function\"!=typeof e.defaultProtocol&&(e.defaultProtocol=\"http://\"),\"number\"==typeof e.truncate||\"object\"==typeof e.truncate&&null!==e.truncate||(e.truncate=1/0),e}function t(e){return!isNaN(Number(e))&&!(Number(e)>65535)}Object.defineProperty(a,\"__esModule\",{value:!0}),a.defaultOptions=n,a.isPort=t}),n=e(function(e,a){Object.defineProperty(a,\"__esModule\",{value:!0}),a.tlds=[\"com\",\"org\",\"net\",\"uk\",\"gov\",\"edu\",\"io\",\"cc\",\"co\",\"aaa\",\"aarp\",\"abarth\",\"abb\",\"abbott\",\"abbvie\",\"abc\",\"able\",\"abogado\",\"abudhabi\",\"ac\",\"academy\",\"accenture\",\"accountant\",\"accountants\",\"aco\",\"active\",\"actor\",\"ad\",\"adac\",\"ads\",\"adult\",\"ae\",\"aeg\",\"aero\",\"aetna\",\"af\",\"afamilycompany\",\"afl\",\"africa\",\"ag\",\"agakhan\",\"agency\",\"ai\",\"aig\",\"aigo\",\"airbus\",\"airforce\",\"airtel\",\"akdn\",\"al\",\"alfaromeo\",\"alibaba\",\"alipay\",\"allfinanz\",\"allstate\",\"ally\",\"alsace\",\"alstom\",\"am\",\"americanexpress\",\"americanfamily\",\"amex\",\"amfam\",\"amica\",\"amsterdam\",\"analytics\",\"android\",\"anquan\",\"anz\",\"ao\",\"aol\",\"apartments\",\"app\",\"apple\",\"aq\",\"aquarelle\",\"ar\",\"aramco\",\"archi\",\"army\",\"arpa\",\"art\",\"arte\",\"as\",\"asda\",\"asia\",\"associates\",\"at\",\"athleta\",\"attorney\",\"au\",\"auction\",\"audi\",\"audible\",\"audio\",\"auspost\",\"author\",\"auto\",\"autos\",\"avianca\",\"aw\",\"aws\",\"ax\",\"axa\",\"az\",\"azure\",\"ba\",\"baby\",\"baidu\",\"banamex\",\"bananarepublic\",\"band\",\"bank\",\"bar\",\"barcelona\",\"barclaycard\",\"barclays\",\"barefoot\",\"bargains\",\"baseball\",\"basketball\",\"bauhaus\",\"bayern\",\"bb\",\"bbc\",\"bbt\",\"bbva\",\"bcg\",\"bcn\",\"bd\",\"be\",\"beats\",\"beauty\",\"beer\",\"bentley\",\"berlin\",\"best\",\"bestbuy\",\"bet\",\"bf\",\"bg\",\"bh\",\"bharti\",\"bi\",\"bible\",\"bid\",\"bike\",\"bing\",\"bingo\",\"bio\",\"biz\",\"bj\",\"black\",\"blackfriday\",\"blanco\",\"blockbuster\",\"blog\",\"bloomberg\",\"blue\",\"bm\",\"bms\",\"bmw\",\"bn\",\"bnl\",\"bnpparibas\",\"bo\",\"boats\",\"boehringer\",\"bofa\",\"bom\",\"bond\",\"boo\",\"book\",\"booking\",\"boots\",\"bosch\",\"bostik\",\"boston\",\"bot\",\"boutique\",\"box\",\"br\",\"bradesco\",\"bridgestone\",\"broadway\",\"broker\",\"brother\",\"brussels\",\"bs\",\"bt\",\"budapest\",\"bugatti\",\"build\",\"builders\",\"business\",\"buy\",\"buzz\",\"bv\",\"bw\",\"by\",\"bz\",\"bzh\",\"ca\",\"cab\",\"cafe\",\"cal\",\"call\",\"calvinklein\",\"cam\",\"camera\",\"camp\",\"cancerresearch\",\"canon\",\"capetown\",\"capital\",\"capitalone\",\"car\",\"caravan\",\"cards\",\"care\",\"career\",\"careers\",\"cars\",\"cartier\",\"casa\",\"case\",\"caseih\",\"cash\",\"casino\",\"cat\",\"catering\",\"catholic\",\"cba\",\"cbn\",\"cbre\",\"cbs\",\"cd\",\"ceb\",\"center\",\"ceo\",\"cern\",\"cf\",\"cfa\",\"cfd\",\"cg\",\"ch\",\"chanel\",\"channel\",\"chase\",\"chat\",\"cheap\",\"chintai\",\"chloe\",\"christmas\",\"chrome\",\"chrysler\",\"church\",\"ci\",\"cipriani\",\"circle\",\"cisco\",\"citadel\",\"citi\",\"citic\",\"city\",\"cityeats\",\"ck\",\"cl\",\"claims\",\"cleaning\",\"click\",\"clinic\",\"clinique\",\"clothing\",\"cloud\",\"club\",\"clubmed\",\"cm\",\"cn\",\"coach\",\"codes\",\"coffee\",\"college\",\"cologne\",\"comcast\",\"commbank\",\"community\",\"company\",\"compare\",\"computer\",\"comsec\",\"condos\",\"construction\",\"consulting\",\"contact\",\"contractors\",\"cooking\",\"cookingchannel\",\"cool\",\"coop\",\"corsica\",\"country\",\"coupon\",\"coupons\",\"courses\",\"cr\",\"credit\",\"creditcard\",\"creditunion\",\"cricket\",\"crown\",\"crs\",\"cruise\",\"cruises\",\"csc\",\"cu\",\"cuisinella\",\"cv\",\"cw\",\"cx\",\"cy\",\"cymru\",\"cyou\",\"cz\",\"dabur\",\"dad\",\"dance\",\"data\",\"date\",\"dating\",\"datsun\",\"day\",\"dclk\",\"dds\",\"de\",\"deal\",\"dealer\",\"deals\",\"degree\",\"delivery\",\"dell\",\"deloitte\",\"delta\",\"democrat\",\"dental\",\"dentist\",\"desi\",\"design\",\"dev\",\"dhl\",\"diamonds\",\"diet\",\"digital\",\"direct\",\"directory\",\"discount\",\"discover\",\"dish\",\"diy\",\"dj\",\"dk\",\"dm\",\"dnp\",\"do\",\"docs\",\"doctor\",\"dodge\",\"dog\",\"doha\",\"domains\",\"dot\",\"download\",\"drive\",\"dtv\",\"dubai\",\"duck\",\"dunlop\",\"duns\",\"dupont\",\"durban\",\"dvag\",\"dvr\",\"dz\",\"earth\",\"eat\",\"ec\",\"eco\",\"edeka\",\"education\",\"ee\",\"eg\",\"email\",\"emerck\",\"energy\",\"engineer\",\"engineering\",\"enterprises\",\"epost\",\"epson\",\"equipment\",\"er\",\"ericsson\",\"erni\",\"es\",\"esq\",\"estate\",\"esurance\",\"et\",\"eu\",\"eurovision\",\"eus\",\"events\",\"everbank\",\"exchange\",\"expert\",\"exposed\",\"express\",\"extraspace\",\"fage\",\"fail\",\"fairwinds\",\"faith\",\"family\",\"fan\",\"fans\",\"farm\",\"farmers\",\"fashion\",\"fast\",\"fedex\",\"feedback\",\"ferrari\",\"ferrero\",\"fi\",\"fiat\",\"fidelity\",\"fido\",\"film\",\"final\",\"finance\",\"financial\",\"fire\",\"firestone\",\"firmdale\",\"fish\",\"fishing\",\"fit\",\"fitness\",\"fj\",\"fk\",\"flickr\",\"flights\",\"flir\",\"florist\",\"flowers\",\"fly\",\"fm\",\"fo\",\"foo\",\"food\",\"foodnetwork\",\"football\",\"ford\",\"forex\",\"forsale\",\"forum\",\"foundation\",\"fox\",\"fr\",\"free\",\"fresenius\",\"frl\",\"frogans\",\"frontdoor\",\"frontier\",\"ftr\",\"fujitsu\",\"fujixerox\",\"fun\",\"fund\",\"furniture\",\"futbol\",\"fyi\",\"ga\",\"gal\",\"gallery\",\"gallo\",\"gallup\",\"game\",\"games\",\"gap\",\"garden\",\"gb\",\"gbiz\",\"gd\",\"gdn\",\"ge\",\"gea\",\"gent\",\"genting\",\"george\",\"gf\",\"gg\",\"ggee\",\"gh\",\"gi\",\"gift\",\"gifts\",\"gives\",\"giving\",\"gl\",\"glade\",\"glass\",\"gle\",\"global\",\"globo\",\"gm\",\"gmail\",\"gmbh\",\"gmo\",\"gmx\",\"gn\",\"godaddy\",\"gold\",\"goldpoint\",\"golf\",\"goo\",\"goodhands\",\"goodyear\",\"goog\",\"google\",\"gop\",\"got\",\"gp\",\"gq\",\"gr\",\"grainger\",\"graphics\",\"gratis\",\"green\",\"gripe\",\"group\",\"gs\",\"gt\",\"gu\",\"guardian\",\"gucci\",\"guge\",\"guide\",\"guitars\",\"guru\",\"gw\",\"gy\",\"hair\",\"hamburg\",\"hangout\",\"haus\",\"hbo\",\"hdfc\",\"hdfcbank\",\"health\",\"healthcare\",\"help\",\"helsinki\",\"here\",\"hermes\",\"hgtv\",\"hiphop\",\"hisamitsu\",\"hitachi\",\"hiv\",\"hk\",\"hkt\",\"hm\",\"hn\",\"hockey\",\"holdings\",\"holiday\",\"homedepot\",\"homegoods\",\"homes\",\"homesense\",\"honda\",\"honeywell\",\"horse\",\"hospital\",\"host\",\"hosting\",\"hot\",\"hoteles\",\"hotmail\",\"house\",\"how\",\"hr\",\"hsbc\",\"ht\",\"htc\",\"hu\",\"hughes\",\"hyatt\",\"hyundai\",\"ibm\",\"icbc\",\"ice\",\"icu\",\"id\",\"ie\",\"ieee\",\"ifm\",\"ikano\",\"il\",\"im\",\"imamat\",\"imdb\",\"immo\",\"immobilien\",\"in\",\"industries\",\"infiniti\",\"info\",\"ing\",\"ink\",\"institute\",\"insurance\",\"insure\",\"int\",\"intel\",\"international\",\"intuit\",\"investments\",\"ipiranga\",\"iq\",\"ir\",\"irish\",\"is\",\"iselect\",\"ismaili\",\"ist\",\"istanbul\",\"it\",\"itau\",\"itv\",\"iveco\",\"iwc\",\"jaguar\",\"java\",\"jcb\",\"jcp\",\"je\",\"jeep\",\"jetzt\",\"jewelry\",\"jio\",\"jlc\",\"jll\",\"jm\",\"jmp\",\"jnj\",\"jo\",\"jobs\",\"joburg\",\"jot\",\"joy\",\"jp\",\"jpmorgan\",\"jprs\",\"juegos\",\"juniper\",\"kaufen\",\"kddi\",\"ke\",\"kerryhotels\",\"kerrylogistics\",\"kerryproperties\",\"kfh\",\"kg\",\"kh\",\"ki\",\"kia\",\"kim\",\"kinder\",\"kindle\",\"kitchen\",\"kiwi\",\"km\",\"kn\",\"koeln\",\"komatsu\",\"kosher\",\"kp\",\"kpmg\",\"kpn\",\"kr\",\"krd\",\"kred\",\"kuokgroup\",\"kw\",\"ky\",\"kyoto\",\"kz\",\"la\",\"lacaixa\",\"ladbrokes\",\"lamborghini\",\"lamer\",\"lancaster\",\"lancia\",\"lancome\",\"land\",\"landrover\",\"lanxess\",\"lasalle\",\"lat\",\"latino\",\"latrobe\",\"law\",\"lawyer\",\"lb\",\"lc\",\"lds\",\"lease\",\"leclerc\",\"lefrak\",\"legal\",\"lego\",\"lexus\",\"lgbt\",\"li\",\"liaison\",\"lidl\",\"life\",\"lifeinsurance\",\"lifestyle\",\"lighting\",\"like\",\"lilly\",\"limited\",\"limo\",\"lincoln\",\"linde\",\"link\",\"lipsy\",\"live\",\"living\",\"lixil\",\"lk\",\"loan\",\"loans\",\"locker\",\"locus\",\"loft\",\"lol\",\"london\",\"lotte\",\"lotto\",\"love\",\"lpl\",\"lplfinancial\",\"lr\",\"ls\",\"lt\",\"ltd\",\"ltda\",\"lu\",\"lundbeck\",\"lupin\",\"luxe\",\"luxury\",\"lv\",\"ly\",\"ma\",\"macys\",\"madrid\",\"maif\",\"maison\",\"makeup\",\"man\",\"management\",\"mango\",\"market\",\"marketing\",\"markets\",\"marriott\",\"marshalls\",\"maserati\",\"mattel\",\"mba\",\"mc\",\"mcd\",\"mcdonalds\",\"mckinsey\",\"md\",\"me\",\"med\",\"media\",\"meet\",\"melbourne\",\"meme\",\"memorial\",\"men\",\"menu\",\"meo\",\"metlife\",\"mg\",\"mh\",\"miami\",\"microsoft\",\"mil\",\"mini\",\"mint\",\"mit\",\"mitsubishi\",\"mk\",\"ml\",\"mlb\",\"mls\",\"mm\",\"mma\",\"mn\",\"mo\",\"mobi\",\"mobile\",\"mobily\",\"moda\",\"moe\",\"moi\",\"mom\",\"monash\",\"money\",\"monster\",\"montblanc\",\"mopar\",\"mormon\",\"mortgage\",\"moscow\",\"moto\",\"motorcycles\",\"mov\",\"movie\",\"movistar\",\"mp\",\"mq\",\"mr\",\"ms\",\"msd\",\"mt\",\"mtn\",\"mtpc\",\"mtr\",\"mu\",\"museum\",\"mutual\",\"mv\",\"mw\",\"mx\",\"my\",\"mz\",\"na\",\"nab\",\"nadex\",\"nagoya\",\"name\",\"nationwide\",\"natura\",\"navy\",\"nba\",\"nc\",\"ne\",\"nec\",\"netbank\",\"netflix\",\"network\",\"neustar\",\"new\",\"newholland\",\"news\",\"next\",\"nextdirect\",\"nexus\",\"nf\",\"nfl\",\"ng\",\"ngo\",\"nhk\",\"ni\",\"nico\",\"nike\",\"nikon\",\"ninja\",\"nissan\",\"nissay\",\"nl\",\"no\",\"nokia\",\"northwesternmutual\",\"norton\",\"now\",\"nowruz\",\"nowtv\",\"np\",\"nr\",\"nra\",\"nrw\",\"ntt\",\"nu\",\"nyc\",\"nz\",\"obi\",\"observer\",\"off\",\"office\",\"okinawa\",\"olayan\",\"olayangroup\",\"oldnavy\",\"ollo\",\"om\",\"omega\",\"one\",\"ong\",\"onl\",\"online\",\"onyourside\",\"ooo\",\"open\",\"oracle\",\"orange\",\"organic\",\"orientexpress\",\"origins\",\"osaka\",\"otsuka\",\"ott\",\"ovh\",\"pa\",\"page\",\"pamperedchef\",\"panasonic\",\"panerai\",\"paris\",\"pars\",\"partners\",\"parts\",\"party\",\"passagens\",\"pay\",\"pccw\",\"pe\",\"pet\",\"pf\",\"pfizer\",\"pg\",\"ph\",\"pharmacy\",\"philips\",\"phone\",\"photo\",\"photography\",\"photos\",\"physio\",\"piaget\",\"pics\",\"pictet\",\"pictures\",\"pid\",\"pin\",\"ping\",\"pink\",\"pioneer\",\"pizza\",\"pk\",\"pl\",\"place\",\"play\",\"playstation\",\"plumbing\",\"plus\",\"pm\",\"pn\",\"pnc\",\"pohl\",\"poker\",\"politie\",\"porn\",\"post\",\"pr\",\"pramerica\",\"praxi\",\"press\",\"prime\",\"pro\",\"prod\",\"productions\",\"prof\",\"progressive\",\"promo\",\"properties\",\"property\",\"protection\",\"pru\",\"prudential\",\"ps\",\"pt\",\"pub\",\"pw\",\"pwc\",\"py\",\"qa\",\"qpon\",\"quebec\",\"quest\",\"qvc\",\"racing\",\"radio\",\"raid\",\"re\",\"read\",\"realestate\",\"realtor\",\"realty\",\"recipes\",\"red\",\"redstone\",\"redumbrella\",\"rehab\",\"reise\",\"reisen\",\"reit\",\"reliance\",\"ren\",\"rent\",\"rentals\",\"repair\",\"report\",\"republican\",\"rest\",\"restaurant\",\"review\",\"reviews\",\"rexroth\",\"rich\",\"richardli\",\"ricoh\",\"rightathome\",\"ril\",\"rio\",\"rip\",\"rmit\",\"ro\",\"rocher\",\"rocks\",\"rodeo\",\"rogers\",\"room\",\"rs\",\"rsvp\",\"ru\",\"ruhr\",\"run\",\"rw\",\"rwe\",\"ryukyu\",\"sa\",\"saarland\",\"safe\",\"safety\",\"sakura\",\"sale\",\"salon\",\"samsclub\",\"samsung\",\"sandvik\",\"sandvikcoromant\",\"sanofi\",\"sap\",\"sapo\",\"sarl\",\"sas\",\"save\",\"saxo\",\"sb\",\"sbi\",\"sbs\",\"sc\",\"sca\",\"scb\",\"schaeffler\",\"schmidt\",\"scholarships\",\"school\",\"schule\",\"schwarz\",\"science\",\"scjohnson\",\"scor\",\"scot\",\"sd\",\"se\",\"seat\",\"secure\",\"security\",\"seek\",\"select\",\"sener\",\"services\",\"ses\",\"seven\",\"sew\",\"sex\",\"sexy\",\"sfr\",\"sg\",\"sh\",\"shangrila\",\"sharp\",\"shaw\",\"shell\",\"shia\",\"shiksha\",\"shoes\",\"shop\",\"shopping\",\"shouji\",\"show\",\"showtime\",\"shriram\",\"si\",\"silk\",\"sina\",\"singles\",\"site\",\"sj\",\"sk\",\"ski\",\"skin\",\"sky\",\"skype\",\"sl\",\"sling\",\"sm\",\"smart\",\"smile\",\"sn\",\"sncf\",\"so\",\"soccer\",\"social\",\"softbank\",\"software\",\"sohu\",\"solar\",\"solutions\",\"song\",\"sony\",\"soy\",\"space\",\"spiegel\",\"spot\",\"spreadbetting\",\"sr\",\"srl\",\"srt\",\"st\",\"stada\",\"staples\",\"star\",\"starhub\",\"statebank\",\"statefarm\",\"statoil\",\"stc\",\"stcgroup\",\"stockholm\",\"storage\",\"store\",\"stream\",\"studio\",\"study\",\"style\",\"su\",\"sucks\",\"supplies\",\"supply\",\"support\",\"surf\",\"surgery\",\"suzuki\",\"sv\",\"swatch\",\"swiftcover\",\"swiss\",\"sx\",\"sy\",\"sydney\",\"symantec\",\"systems\",\"sz\",\"tab\",\"taipei\",\"talk\",\"taobao\",\"target\",\"tatamotors\",\"tatar\",\"tattoo\",\"tax\",\"taxi\",\"tc\",\"tci\",\"td\",\"tdk\",\"team\",\"tech\",\"technology\",\"tel\",\"telecity\",\"telefonica\",\"temasek\",\"tennis\",\"teva\",\"tf\",\"tg\",\"th\",\"thd\",\"theater\",\"theatre\",\"tiaa\",\"tickets\",\"tienda\",\"tiffany\",\"tips\",\"tires\",\"tirol\",\"tj\",\"tjmaxx\",\"tjx\",\"tk\",\"tkmaxx\",\"tl\",\"tm\",\"tmall\",\"tn\",\"to\",\"today\",\"tokyo\",\"tools\",\"top\",\"toray\",\"toshiba\",\"total\",\"tours\",\"town\",\"toyota\",\"toys\",\"tr\",\"trade\",\"trading\",\"training\",\"travel\",\"travelchannel\",\"travelers\",\"travelersinsurance\",\"trust\",\"trv\",\"tt\",\"tube\",\"tui\",\"tunes\",\"tushu\",\"tv\",\"tvs\",\"tw\",\"tz\",\"ua\",\"ubank\",\"ubs\",\"uconnect\",\"ug\",\"unicom\",\"university\",\"uno\",\"uol\",\"ups\",\"us\",\"uy\",\"uz\",\"va\",\"vacations\",\"vana\",\"vanguard\",\"vc\",\"ve\",\"vegas\",\"ventures\",\"verisign\",\"versicherung\",\"vet\",\"vg\",\"vi\",\"viajes\",\"video\",\"vig\",\"viking\",\"villas\",\"vin\",\"vip\",\"virgin\",\"visa\",\"vision\",\"vista\",\"vistaprint\",\"viva\",\"vivo\",\"vlaanderen\",\"vn\",\"vodka\",\"volkswagen\",\"volvo\",\"vote\",\"voting\",\"voto\",\"voyage\",\"vu\",\"vuelos\",\"wales\",\"walmart\",\"walter\",\"wang\",\"wanggou\",\"warman\",\"watch\",\"watches\",\"weather\",\"weatherchannel\",\"webcam\",\"weber\",\"website\",\"wed\",\"wedding\",\"weibo\",\"weir\",\"wf\",\"whoswho\",\"wien\",\"wiki\",\"williamhill\",\"win\",\"windows\",\"wine\",\"winners\",\"wme\",\"wolterskluwer\",\"woodside\",\"work\",\"works\",\"world\",\"wow\",\"ws\",\"wtc\",\"wtf\",\"xbox\",\"xerox\",\"xfinity\",\"xihuan\",\"xin\",\"xn--11b4c3d\",\"xn--1ck2e1b\",\"xn--1qqw23a\",\"xn--30rr7y\",\"xn--3bst00m\",\"xn--3ds443g\",\"xn--3e0b707e\",\"xn--3oq18vl8pn36a\",\"xn--3pxu8k\",\"xn--42c2d9a\",\"xn--45brj9c\",\"xn--45q11c\",\"xn--4gbrim\",\"xn--54b7fta0cc\",\"xn--55qw42g\",\"xn--55qx5d\",\"xn--5su34j936bgsg\",\"xn--5tzm5g\",\"xn--6frz82g\",\"xn--6qq986b3xl\",\"xn--80adxhks\",\"xn--80ao21a\",\"xn--80aqecdr1a\",\"xn--80asehdb\",\"xn--80aswg\",\"xn--8y0a063a\",\"xn--90a3ac\",\"xn--90ae\",\"xn--90ais\",\"xn--9dbq2a\",\"xn--9et52u\",\"xn--9krt00a\",\"xn--b4w605ferd\",\"xn--bck1b9a5dre4c\",\"xn--c1avg\",\"xn--c2br7g\",\"xn--cck2b3b\",\"xn--cg4bki\",\"xn--clchc0ea0b2g2a9gcd\",\"xn--czr694b\",\"xn--czrs0t\",\"xn--czru2d\",\"xn--d1acj3b\",\"xn--d1alf\",\"xn--e1a4c\",\"xn--eckvdtc9d\",\"xn--efvy88h\",\"xn--estv75g\",\"xn--fct429k\",\"xn--fhbei\",\"xn--fiq228c5hs\",\"xn--fiq64b\",\"xn--fiqs8s\",\"xn--fiqz9s\",\"xn--fjq720a\",\"xn--flw351e\",\"xn--fpcrj9c3d\",\"xn--fzc2c9e2c\",\"xn--fzys8d69uvgm\",\"xn--g2xx48c\",\"xn--gckr3f0f\",\"xn--gecrj9c\",\"xn--gk3at1e\",\"xn--h2brj9c\",\"xn--hxt814e\",\"xn--i1b6b1a6a2e\",\"xn--imr513n\",\"xn--io0a7i\",\"xn--j1aef\",\"xn--j1amh\",\"xn--j6w193g\",\"xn--jlq61u9w7b\",\"xn--jvr189m\",\"xn--kcrx77d1x4a\",\"xn--kprw13d\",\"xn--kpry57d\",\"xn--kpu716f\",\"xn--kput3i\",\"xn--l1acc\",\"xn--lgbbat1ad8j\",\"xn--mgb9awbf\",\"xn--mgba3a3ejt\",\"xn--mgba3a4f16a\",\"xn--mgba7c0bbn0a\",\"xn--mgbaam7a8h\",\"xn--mgbab2bd\",\"xn--mgbai9azgqp6j\",\"xn--mgbayh7gpa\",\"xn--mgbb9fbpob\",\"xn--mgbbh1a71e\",\"xn--mgbc0a9azcg\",\"xn--mgbca7dzdo\",\"xn--mgberp4a5d4ar\",\"xn--mgbi4ecexp\",\"xn--mgbpl2fh\",\"xn--mgbt3dhd\",\"xn--mgbtx2b\",\"xn--mgbx4cd0ab\",\"xn--mix891f\",\"xn--mk1bu44c\",\"xn--mxtq1m\",\"xn--ngbc5azd\",\"xn--ngbe9e0a\",\"xn--node\",\"xn--nqv7f\",\"xn--nqv7fs00ema\",\"xn--nyqy26a\",\"xn--o3cw4h\",\"xn--ogbpf8fl\",\"xn--p1acf\",\"xn--p1ai\",\"xn--pbt977c\",\"xn--pgbs0dh\",\"xn--pssy2u\",\"xn--q9jyb4c\",\"xn--qcka1pmc\",\"xn--qxam\",\"xn--rhqv96g\",\"xn--rovu88b\",\"xn--s9brj9c\",\"xn--ses554g\",\"xn--t60b56a\",\"xn--tckwe\",\"xn--tiq49xqyj\",\"xn--unup4y\",\"xn--vermgensberater-ctb\",\"xn--vermgensberatung-pwb\",\"xn--vhquv\",\"xn--vuq861b\",\"xn--w4r85el8fhu5dnra\",\"xn--w4rs40l\",\"xn--wgbh1c\",\"xn--wgbl6a\",\"xn--xhq521b\",\"xn--xkc2al3hye2a\",\"xn--xkc2dl3a5ee0h\",\"xn--y9a3aq\",\"xn--yfro4i67o\",\"xn--ygbi2ammx\",\"xn--zfr164b\",\"xperia\",\"xxx\",\"xyz\",\"yachts\",\"yahoo\",\"yamaxun\",\"yandex\",\"ye\",\"yodobashi\",\"yoga\",\"yokohama\",\"you\",\"youtube\",\"yt\",\"yun\",\"za\",\"zappos\",\"zara\",\"zero\",\"zip\",\"zippo\",\"zm\",\"zone\",\"zuerich\",\"zw\"],a.htmlAttrs=[\"src=\",\"data=\",\"href=\",\"cite=\",\"formaction=\",\"icon=\",\"manifest=\",\"poster=\",\"codebase=\",\"background=\",\"profile=\",\"usemap=\"]}),t=e(function(e,a){function t(e){var a=e.match(o);if(null===a)return!1;for(var t=r.length-1;t>=0;t--)if(r[t].test(e))return!1;var i=a[2];return!!i&&-1!==n.tlds.indexOf(i)}Object.defineProperty(a,\"__esModule\",{value:!0});var o=/^[a-z0-9!#$%&'*+\\-\\/=?^_`{|}~.]+@([a-z0-9%\\-]+\\.){1,}([a-z0-9\\-]+)?$/i,r=[/^[!#$%&'*+\\-\\/=?^_`{|}~.]/,/[.]{2,}[a-z0-9!#$%&'*+\\-\\/=?^_`{|}~.]+@/i,/\\.@/];a.default=t}),o=e(function(e,n){function t(e){if(!o.test(e))return!1;var n=e.split(\".\"),t=Number(n[0]);if(isNaN(t)||t>255||t<0)return!1;var r=Number(n[1]);if(isNaN(r)||r>255||r<0)return!1;var i=Number(n[2]);if(isNaN(i)||i>255||i<0)return!1;var s=Number((n[3].match(/^\\d+/)||[])[0]);if(isNaN(s)||s>255||s<0)return!1;var c=(n[3].match(/(^\\d+)(:)(\\d+)/)||[])[3];return!(c&&!a.isPort(c))}Object.defineProperty(n,\"__esModule\",{value:!0});var o=/^(\\d{1,3}\\.){3}\\d{1,3}(:\\d{1,5})?(\\/([a-z0-9\\-._~:\\/\\?#\\[\\]@!$&'\\(\\)\\*\\+,;=%]+)?)?$/i;n.default=t}),r=e(function(e,t){function o(e){var t=e.match(r);return null!==t&&(\"string\"==typeof t[3]&&(-1!==n.tlds.indexOf(t[3].toLowerCase())&&!(t[5]&&!a.isPort(t[5]))))}Object.defineProperty(t,\"__esModule\",{value:!0});var r=/^(https?:\\/\\/|ftps?:\\/\\/)?([a-z0-9%\\-]+\\.){1,}([a-z0-9\\-]+)?(:(\\d{1,5}))?(\\/([a-z0-9\\-._~:\\/\\?#\\[\\]@!$&'\\(\\)\\*\\+,;=%]+)?)?$/i;t.default=o}),i=e(function(e,a){function n(e,a,t){return e.forEach(function(o,r){!(o.indexOf(\".\")>-1)||e[r-1]===a&&e[r+1]===t||e[r+1]!==a&&e[r+1]!==t||(e[r]=e[r]+e[r+1],\"string\"==typeof e[r+2]&&(e[r]=e[r]+e[r+2]),\"string\"==typeof e[r+3]&&(e[r]=e[r]+e[r+3]),\"string\"==typeof e[r+4]&&(e[r]=e[r]+e[r+4]),e.splice(r+1,4),n(e,a,t))}),e}function t(e){return e=n(e,\"(\",\")\"),e=n(e,\"[\",\"]\"),e=n(e,'\"','\"'),e=n(e,\"'\",\"'\")}Object.defineProperty(a,\"__esModule\",{value:!0}),a.fixSeparators=n,a.default=t}),s=e(function(e,a){function n(e){var a=e.replace(/([\\s\\(\\)\\[\\]<>\"'])/g,\"\\0$1\\0\").replace(/([?;:,.!]+)(?=(\\0|$|\\s))/g,\"\\0$1\\0\").split(\"\\0\");return i.default(a)}function t(e){return e.join(\"\")}Object.defineProperty(a,\"__esModule\",{value:!0}),a.separate=n,a.deSeparate=t}),c=e(function(e,a){function n(e){return e=e.toLowerCase(),0===e.indexOf(\"http://\")?\"http://\":0===e.indexOf(\"https://\")?\"https://\":0===e.indexOf(\"ftp://\")?\"ftp://\":0===e.indexOf(\"ftps://\")?\"ftps://\":0===e.indexOf(\"file:///\")?\"file:///\":0===e.indexOf(\"mailto:\")&&\"mailto:\"}Object.defineProperty(a,\"__esModule\",{value:!0}),a.default=n}),l=e(function(e,a){function i(e,a){return e.map(function(i,s){var l=encodeURI(i);if(l.indexOf(\".\")<1&&!c.default(l))return i;var u=null,d=c.default(l)||\"\";return d&&(l=l.substr(d.length)),a.files&&\"file:///\"===d&&l.split(/\\/|\\\\/).length-1&&(u={reason:\"file\",protocol:d,raw:i,encoded:l}),!u&&a.urls&&r.default(l)&&(u={reason:\"url\",protocol:d||(\"function\"==typeof a.defaultProtocol?a.defaultProtocol(i):a.defaultProtocol),raw:i,encoded:l}),!u&&a.emails&&t.default(l)&&(u={reason:\"email\",protocol:\"mailto:\",raw:i,encoded:l}),!u&&a.ips&&o.default(l)&&(u={reason:\"ip\",protocol:d||(\"function\"==typeof a.defaultProtocol?a.defaultProtocol(i):a.defaultProtocol),raw:i,encoded:l}),u&&(\"'\"!==e[s-1]&&'\"'!==e[s-1]||!~n.htmlAttrs.indexOf(e[s-2]))?u:i})}Object.defineProperty(a,\"__esModule\",{value:!0}),a.default=i}),u=e(function(e,a){function n(e,a){var n=o.separate(e),r=l.default(n,a);if(a.exclude)for(var i=0;i<r.length;i++){var c=r[i];\"object\"==typeof c&&a.exclude(c)&&(r[i]=c.raw)}if(a.list){for(var u=[],d=0;d<r.length;d++){var b=r[d];\"string\"!=typeof b&&u.push(b)}return u}return r=r.map(function(e){return\"string\"==typeof e?e:t(e,a)}),s.deSeparate(r)}function t(e,a){var n=e.protocol+e.encoded,t=e.raw;return\"number\"==typeof a.truncate&&t.length>a.truncate&&(t=t.substring(0,a.truncate)+\"...\"),\"object\"==typeof a.truncate&&t.length>a.truncate[0]+a.truncate[1]&&(t=t.substr(0,a.truncate[0])+\"...\"+t.substr(t.length-a.truncate[1])),void 0===a.attributes&&(a.attributes=[]),'<a href=\"'+n+'\" '+a.attributes.map(function(a){if(\"function\"!=typeof a)return\" \"+a.name+'=\"'+a.value+'\" ';var n=(a(e)||{}).name,t=(a(e)||{}).value;return n&&!t?\" name \":n&&t?\" \"+n+'=\"'+t+'\" ':void 0}).join(\"\")+\">\"+t+\"</a>\"}Object.defineProperty(a,\"__esModule\",{value:!0});var o=s;a.default=n}),d=e(function(e,n){Object.defineProperty(n,\"__esModule\",{value:!0});var i=function(e,n){return n=a.defaultOptions(n),u.default(e,n)};i.validate={ip:o.default,url:function(e){var a=c.default(e)||\"\";return e=e.substr(a.length),e=encodeURI(e),r.default(e)},email:t.default},n.default=i});return function(e){return e&&e.__esModule?e.default:e}(d)});\n","'use strict';\n\nexport const colorUtils = {\n\tto888: (R, G, B) => [(R * 527 + 23) >> 6, (G * 259 + 33) >> 6, (B * 527 + 23) >> 6],\n\tto565: (R, G, B) => [(R * 249 + 1014) >> 11, (G * 253 + 505) >> 10, (B * 249 + 1014) >> 11],\n\tu16_565: (R, G, B) => B << 11 | G << 5 | R,\n\tu24_888: (R, G, B) => B << 16 | G << 8 | R,\n\tu32_888: (R, G, B) => colorUtils.u24_888(R, G, B) | 0xFF000000,\n\tu16_565_to_888: color => {\n\t\tconst R = ((color & 0b11111) * 527 + 23) >> 6;\n\t\tconst G = ((color >> 5 & 0b11111) * 527 + 23) >> 6;\n\t\tconst B = ((color >> 11 & 0b11111) * 527 + 23) >> 6;\n\t\treturn B << 16 | G << 8 | R;\n\t},\n\tarrFrom565: color => [color & 0b11111, color >> 5 & 0b111111, color >> 11 & 0b11111],\n\t/* Takes an integer, and gives an html compatible color */\n\ttoHTML: color => {\n\t\tcolor = (color >> 16 & 0xFF | color & 0xFF00 | color << 16 & 0xFF0000).toString(16);\n\t\treturn '#' + ('000000' + color).substring(color.length);\n\t}\n};\n","'use strict';\r\nimport { colorUtils as color } from './color.js';\r\nimport { PublicAPI } from './../global.js';\r\n\r\nPublicAPI.util = {\r\n\tgetTime,\r\n\tcookiesEnabled,\r\n\tstorageEnabled,\r\n\tabsMod,\r\n\tescapeHTML,\r\n\tmkHTML,\r\n\tsetTooltip,\r\n\twaitFrames,\r\n\tline,\r\n\tloadScript\r\n};\r\n\r\nlet time = Date.now();\r\nexport function getTime(update) {\r\n\treturn update ? (time = Date.now()) : time;\r\n}\r\n\r\nexport function setCookie(name, value) {\r\n\tdocument.cookie = `${name}=${value}; expires=Fri, 31 Dec 9999 23:59:59 GMT`;\r\n}\r\n\r\nexport function getCookie(name) {\r\n    var cookie = document.cookie.split(';');\r\n\tfor (var i = 0; i < cookie.length; i++) {\r\n\t\tvar idx = cookie[i].indexOf(name + '=');\r\n\t\tif (idx === 0 || (idx === 1 && cookie[i][0] === ' ')) {\r\n\t\t\tvar off = idx + name.length + 1;\r\n\t\t\treturn cookie[i].substring(off, cookie[i].length);\r\n        }\r\n    }\r\n\treturn null;\r\n}\r\n\r\nexport function cookiesEnabled() {\r\n\treturn navigator.cookieEnabled;\r\n}\r\n\r\nexport function storageEnabled() {\r\n\ttry {\r\n\t\treturn !!window.localStorage;\r\n\t} catch (e) {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport function propertyDefaults(obj, defaults) {\r\n\tif (obj) {\r\n\t\tfor (var prop in obj) {\r\n\t\t\tif (obj.hasOwnProperty(prop)) {\r\n\t\t\t\tdefaults[prop] = obj[prop];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn defaults;\r\n}\r\n\r\n// This fixes modulo to work on negative numbers (-1 % 16 = 15)\r\nexport function absMod(n1, n2) {\r\n\treturn ((n1 % n2) + n2) % n2;\r\n}\r\n\r\nexport function htmlToElement(html) {\r\n\treturn mkHTML(\"template\", {\r\n\t\tinnerHTML: html\r\n\t}).content.firstChild;\r\n}\r\n\r\nexport function escapeHTML(text) {\r\n\treturn text.replace(/&/g, '&amp;')\r\n\t\t.replace(/</g, '&lt;')\r\n\t\t.replace(/>/g, '&gt;')\r\n\t\t.replace(/\\\"/g, '&quot;')\r\n\t\t.replace(/\\'/g, '&#39;')\r\n\t\t.replace(/\\//g, '&#x2F;');\r\n}\r\n\r\n/* Makes an HTML element with the values specified in opts */\r\nexport function mkHTML(tag, opts) {\r\n\tvar elm = document.createElement(tag);\r\n\tfor (var i in opts) {\r\n\t\telm[i] = opts[i];\r\n\t}\r\n\treturn elm;\r\n}\r\n\r\nexport function loadScript(name, callback) {\r\n\tdocument.getElementsByTagName('head')[0].appendChild(mkHTML(\"script\", {\r\n\t\ttype: \"text/javascript\",\r\n\t\tsrc: name,\r\n\t\tonload: callback\r\n\t}));\r\n}\r\n\r\nexport function eventOnce(element, events, func) {\r\n\tvar ev = events.split(' ');\r\n\tvar f = e => {\r\n\t\tfor (var i = 0; i < ev.length; i++) {\r\n\t\t\telement.removeEventListener(ev[i], f);\r\n\t\t}\r\n\t\treturn func();\r\n\t};\r\n\r\n\tfor (var i = 0; i < ev.length; i++) {\r\n\t\telement.addEventListener(ev[i], f);\r\n\t}\r\n}\r\n\r\nexport function setTooltip(element, message) {\r\n\tconst elementSpacing = 10;\r\n\tvar intr = 0;\r\n\tvar tip = null;\r\n\tfunction tooltip() {\r\n\t\tvar epos = element.getBoundingClientRect();\r\n\t\tvar y = epos.top + epos.height / 2;\r\n\t\ttip = mkHTML('span', {\r\n\t\t\tinnerHTML: message,\r\n\t\t\tclassName: 'framed tooltip whitetext'\r\n\t\t});\r\n\t\tdocument.body.appendChild(tip);\r\n\t\tvar tpos = tip.getBoundingClientRect();\r\n\t\ty -= tpos.height / 2;\r\n\t\tvar x = epos.left - tpos.width - elementSpacing;\r\n\t\tif (x < elementSpacing) {\r\n\t\t\tx = epos.right + elementSpacing;\r\n\t\t}\r\n\t\ttip.style.transform = `translate(${Math.round(x)}px,${Math.round(y)}px)`;\r\n\t\tintr = 0;\r\n\t}\r\n\tconst mleave = e => {\r\n\t\tclearTimeout(intr);\r\n\t\tintr = 0;\r\n\t\telement.removeEventListener('mouseleave', mleave);\r\n\t\telement.removeEventListener('click', mleave);\r\n\t\telement.removeEventListener('DOMNodeRemoved', mleave);\r\n\t\tif (tip !== null) {\r\n\t\t\ttip.remove();\r\n\t\t\ttip = null;\r\n\t\t}\r\n\t};\r\n\tconst menter = e => {\r\n\t\tif (tip === null && intr === 0) {\r\n\t\t\tintr = setTimeout(tooltip, 500);\r\n\t\t\telement.addEventListener('click', mleave);\r\n\t\t\telement.addEventListener('mouseleave', mleave);\r\n\t\t\telement.addEventListener('DOMNodeRemoved', mleave);\r\n\t\t}\r\n\t};\r\n\t/*var observer = new MutationObserver(e => { // Why does this not fire at all?\r\n\t\tconsole.log(e, tip, intr);\r\n\t\tif (e[0].removedNodes && (tip !== null || intr !== 0)) {\r\n\t\t\tmleave();\r\n\t\t}\r\n\t});\r\n\tobserver.observe(element, { childList: true, subtree: true });*/\r\n\telement.addEventListener('mouseenter', menter);\r\n}\r\n\r\n/* Waits n frames */\r\nexport function waitFrames(n, cb) {\r\n\twindow.requestAnimationFrame(() => {\r\n\t\treturn n > 0 ? waitFrames(--n, cb) : cb();\r\n\t})\r\n}\r\n\r\nexport function decompress(u8arr) {\r\n\tvar originalLength = u8arr[1] << 8 | u8arr[0];\r\n\tvar u8decompressedarr = new Uint8Array(originalLength);\r\n\tvar numOfRepeats = u8arr[3] << 8 | u8arr[2];\r\n\tvar offset = numOfRepeats * 2 + 4;\r\n\tvar uptr = 0;\r\n\tvar cptr = offset;\r\n\tfor (var i = 0; i < numOfRepeats; i++) {\r\n\t\tvar currentRepeatLoc = (u8arr[4 + i * 2 + 1] << 8 | u8arr[4 + i * 2]) + offset;\r\n\t\twhile (cptr < currentRepeatLoc) {\r\n\t\t\tu8decompressedarr[uptr++] = u8arr[cptr++];\r\n\t\t}\r\n\t\tvar repeatedNum = u8arr[cptr + 1] << 8 | u8arr[cptr];\r\n\t\tvar repeatedColorR = u8arr[cptr + 2];\r\n\t\tvar repeatedColorG = u8arr[cptr + 3];\r\n\t\tvar repeatedColorB = u8arr[cptr + 4];\r\n\t\tcptr += 5;\r\n\t\twhile (repeatedNum--) {\r\n\t\t\tu8decompressedarr[uptr] = repeatedColorR;\r\n\t\t\tu8decompressedarr[uptr + 1] = repeatedColorG;\r\n\t\t\tu8decompressedarr[uptr + 2] = repeatedColorB;\r\n\t\t\tuptr += 3;\r\n\t\t}\r\n\t}\r\n\twhile (cptr < u8arr.length) {\r\n\t\tu8decompressedarr[uptr++] = u8arr[cptr++];\r\n\t}\r\n\treturn u8decompressedarr;\r\n}\r\n\r\n/*function decompressu16(input) {\r\n\tvar originalLength = (((input[1] & 0xFF) << 8 | (input[0] & 0xFF)) + 1) * 2;\r\n\tvar output = new Uint8Array(originalLength);\r\n\tvar numOfRepeats = (input[3] & 0xFF) << 8 | (input[2] & 0xFF);\r\n\tvar offset = numOfRepeats * 2 + 4;\r\n\tvar uptr = 0;\r\n\tvar cptr = offset;\r\n\tfor (var i = 0; i < numOfRepeats; i++) {\r\n\t\tvar currentRepeatLoc = 2 * ((((input[4 + i * 2 + 1] & 0xFF) << 8) | (input[4 + i * 2] & 0xFF)))\r\n\t\t\t\t+ offset;\r\n\t\twhile (cptr < currentRepeatLoc) {\r\n\t\t\toutput[uptr++] = input[cptr++];\r\n\t\t}\r\n\t\tvar repeatedNum = ((input[cptr + 1] & 0xFF) << 8 | (input[cptr] & 0xFF)) + 1;\r\n\t\tvar repeatedColorRGB = (input[cptr + 3] & 0xFF) << 8 | (input[cptr + 2] & 0xFF);\r\n\t\tcptr += 4;\r\n\t\twhile (repeatedNum-- != 0) {\r\n\t\t\toutput[uptr] = (repeatedColorRGB & 0xFF);\r\n\t\t\toutput[uptr + 1] = ((repeatedColorRGB & 0xFF00) >> 8);\r\n\t\t\tuptr += 2;\r\n\t\t}\r\n\t}\r\n\twhile (cptr < input.length) {\r\n\t\toutput[uptr++] = input[cptr++];\r\n\t}\r\n\treturn output;\r\n}*/\r\n\r\nexport function line(x1, y1, x2, y2, size, plot) {\r\n\tvar dx =  Math.abs(x2 - x1), sx = x1 < x2 ? 1 : -1;\r\n\tvar dy = -Math.abs(y2 - y1), sy = y1 < y2 ? 1 : -1;\r\n\tvar err = dx + dy,\r\n\t\te2;\r\n\r\n\twhile(true) {\r\n\t\tplot(x1, y1);\r\n\t\tif (x1 == x2 && y1 == y2) break;\r\n\t\te2 = 2 * err;\r\n\t\tif (e2 >= dy) { err += dy; x1 += sx; }\r\n\t\tif (e2 <= dx) { err += dx; y1 += sy; }\r\n\t}\r\n}\r\n","/**\n * Copyright (c) 2015, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule normalizeWheel\n * @typechecks\n */\n\n /* source: https://github.com/facebookarchive/fixed-data-table/blob/master/src/vendor_upstream/dom/normalizeWheel.js */\n\n'use strict';\n\n// Reasonable defaults\nvar PIXEL_STEP  = 10;\nvar LINE_HEIGHT = 40;\nvar PAGE_HEIGHT = 800;\n\nexport function normalizeWheel(/*object*/ event) /*object*/ {\n  var sX = 0, sY = 0,       // spinX, spinY\n      pX = 0, pY = 0;       // pixelX, pixelY\n\n  // Legacy\n  if ('detail'      in event) { sY = event.detail; }\n  if ('wheelDelta'  in event) { sY = -event.wheelDelta / 120; }\n  if ('wheelDeltaY' in event) { sY = -event.wheelDeltaY / 120; }\n  if ('wheelDeltaX' in event) { sX = -event.wheelDeltaX / 120; }\n\n  // side scrolling on FF with DOMMouseScroll\n  if ( 'axis' in event && event.axis === event.HORIZONTAL_AXIS ) {\n    sX = sY;\n    sY = 0;\n  }\n\n  pX = sX * PIXEL_STEP;\n  pY = sY * PIXEL_STEP;\n\n  if ('deltaY' in event) { pY = event.deltaY; }\n  if ('deltaX' in event) { pX = event.deltaX; }\n\n  if ((pX || pY) && event.deltaMode) {\n    if (event.deltaMode == 1) {          // delta in LINE units\n      pX *= LINE_HEIGHT;\n      pY *= LINE_HEIGHT;\n    } else {                             // delta in PAGE units\n      pX *= PAGE_HEIGHT;\n      pY *= PAGE_HEIGHT;\n    }\n  }\n\n  // Fall-back if spin cannot be determined\n  if (pX && !sX) { sX = (pX < 1) ? -1 : 1; }\n  if (pY && !sY) { sY = (pY < 1) ? -1 : 1; }\n\n  return { spinX  : sX,\n           spinY  : sY,\n           pixelX : pX,\n           pixelY : pY };\n}\n","\"use strict\";\nimport { elements } from './main.js';\nimport { EVENTS as e, options } from './conf.js';\nimport { PublicAPI, eventSys } from './global.js';\nimport { mkHTML, waitFrames } from './util/misc.js';\n\nexport const windowSys = {\n\twindows: {},\n\tclass: {\n\t\tinput: UtilInput,\n\t\tdialog: UtilDialog,\n\t\tdropDown: OWOPDropDown,\n\t\twindow: GUIWindow\n\t},\n\taddWindow: addWindow,\n\tdelWindow: delWindow,\n\tcenterWindow: centerWindow,\n\tcloseAllWindows: closeAllWindows\n};\n\nPublicAPI.windowSys = windowSys;\n\nfunction closeAllWindows() {\n\tfor (var x in windowSys.windows) {\n\t\twindowSys.windows[x].close();\n\t}\n}\n\nexport function UtilInput(title, message, inputType, cb) {\n\tthis.win = new GUIWindow(title, {\n\t\tcenterOnce: true,\n\t\tcloseable: true\n\t}, function(win) {\n\t\tthis.inputField = win.addObj(mkHTML(\"input\", {\n\t\t\tstyle: \"width: 100%; height: 50%;\",\n\t\t\ttype: inputType,\n\t\t\tplaceholder: message,\n\t\t\tonkeyup: function(e) {\n\t\t\t\tif((e.which || e.keyCode) == 13) {\n\t\t\t\t\tthis.okButton.click();\n\t\t\t\t}\n\t\t\t}.bind(this)\n\t\t}));\n\t\tthis.okButton = win.addObj(mkHTML(\"button\", {\n\t\t\tinnerHTML: \"OK\",\n\t\t\tstyle: \"width: 100%; height: 50%;\",\n\t\t\tonclick: function() {\n\t\t\t\tcb(this.inputField.value);\n\t\t\t\tthis.getWindow().close();\n\t\t\t}.bind(this)\n\t\t}));\n\t}.bind(this)).resize(200, 60);\n}\n\nUtilInput.prototype.getWindow = function() {\n\treturn this.win;\n};\n\nexport function UtilDialog(title, message, canClose, cb) {\n\tthis.win = new GUIWindow(title, {\n\t\tcentered: true,\n\t\tcloseable: canClose\n\t}, function(win) {\n\t\tthis.messageBox = win.addObj(mkHTML(\"span\", {\n\t\t\tclassName: \"whitetext\",\n\t\t\tstyle: \"display: block; padding-bottom: 4px;\",\n\t\t\tinnerHTML: message\n\t\t}));\n\t\tthis.okButton = win.addObj(mkHTML(\"button\", {\n\t\t\tinnerHTML: \"OK\",\n\t\t\tstyle: \"display: block; width: 80px; height: 30px; margin: auto;\",\n\t\t\tonclick: function() {\n\t\t\t\tcb();\n\t\t\t\tthis.getWindow().close();\n\t\t\t}.bind(this)\n\t\t}));\n\t}.bind(this));\n}\n\nUtilDialog.prototype.getWindow = function() {\n\treturn this.win;\n};\n\n/* Highly specific purpose, should only be created once */\nexport function OWOPDropDown() {\n\tthis.win = new GUIWindow(null, {\n\t\timmobile: true\n\t},\n\tfunction(win) {\n\t\twin.frame.className = \"owopdropdown\";\n\t\twin.container.style.cssText = \"border: none;\\\n\t\t\tbackground-color: initial;\\\n\t\t\tpointer-events: none;\\\n\t\t\tmargin: 0;\";\n\t\tvar hlpdiv = win.addObj(mkHTML(\"div\", {\n\t\t\tclassName: \"winframe\",\n\t\t\tstyle: \"padding: 0;\\\n\t\t\t\twidth: 68px; height: 64px;\"\n\t\t}));\n\t\tvar hidebtn = win.addObj(mkHTML(\"button\", {\n\t\t\tinnerHTML: 'hi'\n\t\t\t/*className: \"winframe\",\n\t\t\tstyle: \"padding: 0;\\\n\t\t\tbackground-color: #ffd162;\\\n\t\t\tleft: -6px; top: 70px;\\\n\t\t\twidth: 38px; height: 36px;\"*/\n\t\t}));\n\t\t/*var rddtbtn = win.addObj(mkHTML(\"button\", {\n\t\t\tclassName: \"winframe\",\n\t\t\tstyle: \"padding: 0;\\\n\t\t\tright: -6px; top: 70px;\\\n\t\t\twidth: 38px; height: 36px;\"\n\t\t}));*/\n\t\tvar hlpcontainer = mkHTML(\"div\", {\n\t\t\tclassName: \"wincontainer\",\n\t\t\tstyle: \"margin-top: -5px;\"\n\t\t});\n\t\thlpdiv.appendChild(hlpcontainer);\n\t\thlpcontainer.appendChild(mkHTML(\"button\", {\n\t\t\tstyle: \"background-image: url(img/gui.png);\\\n\t\t\t\tbackground-position: -64px 4px;\\\n\t\t\t\tbackground-origin: border-box;\\\n\t\t\t\tbackground-repeat: no-repeat;\\\n\t\t\t\twidth: 100%; height: 100%;\",\n\t\t\tonclick: function() {console.log(\"help\")}.bind(this)\n\t\t}));\n\t}).resize(68, 64);\n}\n\nOWOPDropDown.prototype.getWindow = function() {\n\treturn this.win;\n};\n\n/* wm = WindowManager object\n * initfunc = function where all the windows objects should be added,\n *            first function argument is the guiwindow object itself\n */\nexport function GUIWindow(title, options, initfunc) {\n\toptions = options || {};\n\tthis.wm = WorldOfPixels.windowsys;\n\tthis.opt = options;\n\tthis.title = title;\n\tthis.frame = document.createElement(\"div\");\n\tthis.container = document.createElement(\"div\");\n\tthis.container.className = 'wincontainer';\n\n\tif (title) {\n\t\tthis.titlespan = document.createElement(\"span\");\n\t\tthis.titlespan.innerHTML = title;\n\n\t\tthis.frame.appendChild(this.titlespan);\n\t}\n\n\tthis.frame.appendChild(this.container);\n\n\tif (options.centered) {\n\t\toptions.immobile = true;\n\t\tthis.frame.className = \"centered\";\n\t}\n\n\tObject.defineProperty(this, \"realw\", {\n\t\tget: function() {\n\t\t\treturn this.frame.offsetWidth;\n\t\t}.bind(this)\n\t});\n\tObject.defineProperty(this, \"realh\", {\n\t\tget: function() {\n\t\t\treturn this.frame.offsetHeight;\n\t\t}.bind(this)\n\t});\n\n\tthis.elements = [];\n\n\tthis.creationtime = Date.now();\n\tthis.currentaction = null; /* Func to call every mousemove evt */\n\n\tif (initfunc) {\n\t\tinitfunc(this);\n\t}\n\n\tthis.mdownfunc = function(e) {\n\t\tvar offx = e.clientX - this.x;\n\t\tvar offy = e.clientY - this.y;\n\t\tif (e.target === this.frame && !this.opt.immobile) {\n\t\t\tthis.currentaction = function(x, y) {\n\t\t\t\tx = x <= 0 ? 0 : x > window.innerWidth ? window.innerWidth : x;\n\t\t\t\ty = y <= 0 ? 0 : y > window.innerHeight ? window.innerHeight : y;\n\t\t\t\tthis.move(x - offx, y - offy);\n\t\t\t}\n\t\t}\n\t}.bind(this);\n\n\tif (options.centerOnce) {\n\t\t/* Ugly solution to wait for offset(Height, Width) values to be available */\n\t\tthis.move(window.innerWidth, window.innerHeight); /* Hide the window */\n\t\twaitFrames(2, () => centerWindow(this));\n\t}\n\n\tthis.frame.addEventListener(\"mousedown\", this.mdownfunc);\n\n\tthis.mupfunc = function(e) {\n\t\tthis.currentaction = null;\n\t}.bind(this);\n\n\twindow.addEventListener(\"mouseup\", this.mupfunc);\n\n\tthis.mmovefunc = function(e) {\n\t\tif (this.currentaction) {\n\t\t\tthis.currentaction(e.clientX, e.clientY);\n\t\t}\n\t}.bind(this);\n\n\twindow.addEventListener(\"mousemove\", this.mmovefunc);\n\n\tthis.touchfuncbuilder = function(type) {\n\t\treturn (event) => {\n\t\t\tvar handlers = {\n\t\t\t\tstart: this.mdownfunc,\n\t\t\t\tmove: this.mmovefunc,\n\t\t\t\tend: this.mupfunc,\n\t\t\t\tcancel: this.mupfunc\n\t\t\t};\n\t\t\tvar handler = handlers[type];\n\t\t\tif (handler) {\n\t\t\t\tvar touches = event.changedTouches;\n\t\t\t\tif (touches.length > 0) {\n\t\t\t\t\thandler(touches[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}.bind(this);\n\n\tthis.frame.addEventListener(\"touchstart\", this.touchfuncbuilder(\"start\"));\n\tthis.frame.addEventListener(\"touchmove\", this.touchfuncbuilder(\"move\"));\n\tthis.frame.addEventListener(\"touchend\", this.touchfuncbuilder(\"end\"));\n\tthis.frame.addEventListener(\"touchcancel\", this.touchfuncbuilder(\"cancel\"));\n\n\tif(options.closeable) {\n\t\tthis.frame.appendChild(mkHTML(\"button\", {\n\t\t\tonclick: function() {\n\t\t\t\tthis.close();\n\t\t\t}.bind(this),\n\t\t\tclassName: 'windowCloseButton'\n\t\t}));\n\t}\n}\n\nGUIWindow.prototype.getWindow = function() {\n\treturn this;\n};\n\nGUIWindow.prototype.addObj = function(object) {\n\tthis.elements.push(object);\n\tthis.container.appendChild(object);\n\treturn object;\n};\n\nGUIWindow.prototype.delObj = function(object) {\n\tvar i = this.elements.indexOf(object);\n\tif (i != -1) {\n\t\tthis.elements.splice(i, 1);\n\t\tthis.container.removeChild(object);\n\t}\n};\n\nGUIWindow.prototype.move = function(x, y) {\n\tif (!this.opt.immobile) {\n\t\tthis.frame.style.transform = \"translate(\" + x + \"px,\" + y + \"px)\";\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\treturn this;\n};\n\nGUIWindow.prototype.resize = function(w, h){\n\tthis.w = w;\n\tthis.h = h;\n\tthis.container.style.width = w + \"px\";\n\tthis.container.style.height = h + \"px\";\n\treturn this;\n};\n\nGUIWindow.prototype.close = function() {\n\tdelWindow(this);\n\twindow.removeEventListener(\"mousemove\", this.mmovefunc);\n\twindow.removeEventListener(\"mouseup\", this.mupfunc);\n\tthis.frame.removeEventListener(\"mousedown\", this.mdownfunc);\n\tif (this.onclose) {\n\t\tthis.onclose();\n\t}\n};\n\n/* Window X/Y is specified on window.x, window.y */\nexport function addWindow(window) {\n\tif (options.noUi) {\n\t\treturn window;\n\t}\n\n\tvar realWindow = window.getWindow();\n\tif(!windowSys.windows[realWindow.title]) {\n\t\telements.windows.appendChild(realWindow.frame);\n\t\twindowSys.windows[realWindow.title] = realWindow;\n\t}\n\teventSys.emit(e.misc.windowAdded, window);\n\treturn window;\n}\n\nexport function delWindow(window) {\n\tvar realWindow = window.getWindow();\n\tif(windowSys.windows[realWindow.title]) {\n\t\telements.windows.removeChild(realWindow.frame);\n\t\tdelete windowSys.windows[realWindow.title];\n\t}\n\treturn window;\n}\n\nexport function centerWindow(win) {\n\twin = win.getWindow();\n\twin.move(window.innerWidth / 2 - win.realw / 2 | 0, window.innerHeight / 2 - win.realh / 2 | 0);\n}\n"],"sourceRoot":""}